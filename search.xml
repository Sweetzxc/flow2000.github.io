<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux服务器免密码登录</title>
      <link href="/posts/9e+29/"/>
      <url>/posts/9e+29/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>当拥有一台服务器时，最先保证的是安全，而保证安全的方式有很多，譬如避免开放过多的端口，尽量避免使用默认端口，登录口令尽量复杂，其中登录口令是进入服务器的第一道防线，但有时候复杂的口令即阻挡了外来人也阻挡正常登录（密码太复杂了），所以有没有一种既简单又能有效防止被破解的方法呢？当然有，免密登录就是最简单有效的方法</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>1、在windows系统的cmd命令行上执行生成密钥对命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><p>2、将生成的id_rsa.pub公钥内容复制到远程服务器上的&#x2F;.ssh&#x2F;authorized_keys(不存在则手动创建)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch /.ssh/authorized_keys #文件不存在时手动创建</span><br><span class="line">vim /.ssh/authorized_keys #编辑authorized_keys文件</span><br></pre></td></tr></table></figure><p>3、导入密钥，打开xshell-&gt;工具-&gt;用户密钥管理者-&gt;导入选项，导入刚刚生成的id_rsa密钥文件</p><p>4、登录服务器，选择密钥登录并选择刚刚导入成功的密钥文件，即可完成无密码登录。</p><p>5、（可选）取消密码登录，加强服务器安全性。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config #编辑ssh配置文件</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将PasswordAuthentication处的值改为no</span></span><br><span class="line">service sshd restart #重启ssh服务</span><br></pre></td></tr></table></figure><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>免密登录服务器利用非对称加密原理，简单来说使用两个密钥（公钥和私钥），公钥加密传输数据，私钥解密接收数据；公钥是公开的，私钥是保密的。</p><p>免密登录原理如下（ 图片来自于网络）</p><p><img src="/../img/9e29/20160319193556260.png"></p><p>图解，server A免登录到server B:<br>1、在A上生成公钥私钥。<br>2、将公钥拷贝给server B，要重命名成authorized_keys(从英文名就知道含义了)<br>3、Server A向Server B发送一个连接请求。<br>4、Server B得到Server A的信息后，在authorized_key中查找，如果有相应的用户名和IP，则随机生成一个字符串，并用Server A的公钥加密，发送给Server A。<br>5、Server A得到Server B发来的消息后，使用私钥进行解密，然后将解密后的字符串发送给Server B。Server B进行和生成的对比，如果一致，则允许免登录。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/qq_35793285/article/details/119568841"> 非对称加密工作原理</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux脚本实现一键启动或停止应用程序</title>
      <link href="/posts/aa77/"/>
      <url>/posts/aa77/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>我们在Linux服务器运行jar包时常常会因为命令行太复杂而忘记如何运行和停止，我们可以使用脚本的形式来启动、停止、重新启动应用程序，节省时间减少出错概率</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>通常我们在linux运行一个jar包或者war包的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar xxx.jar</span><br></pre></td></tr></table></figure><p>但是关掉连接工具后就会停止正在运行的应用，需要后台执行，可使用命令<code>nohup</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &gt; out.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>但是这又会出现一个问题，我想重新部署的话必须关掉原来运行的，在linux中可执行以下命令寻找pid：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java</span><br></pre></td></tr></table></figure><p>PS：使用以下命令可以去掉查询进程本身的信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java | grep -v grep</span><br></pre></td></tr></table></figure><p>只保留pid信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure><p>杀死进程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 xxx</span><br></pre></td></tr></table></figure><p>重新运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &gt; out.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>总结来说运行一个应用程序的一般步骤：</p><p><code>运行</code> -&gt; <code>停止</code> -&gt; <code>运行</code></p><p>以上步骤复杂且有人工误操作的风险，所以我们可以制作一个脚本来一键运行或停止它：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash  </span></span><br><span class="line"><span class="comment"># 使用方法：修改jar包名称，完整的jar路径，运行日志名称即可</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#jar包名称</span></span><br><span class="line">APP_NAME=fivechess-1.0.jar</span><br><span class="line"><span class="comment">#完整的jar路径</span></span><br><span class="line">APP_PATH=target/<span class="variable">$APP_NAME</span></span><br><span class="line"><span class="comment">#运行日志</span></span><br><span class="line">LOG_FILE=fivechess.log</span><br><span class="line"><span class="comment">#JVM运行参数</span></span><br><span class="line">JVM_OPTS=<span class="string">&quot;-Xms128m -Xmx512m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m -Dfile.encoding=UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用说明，用来提示输入参数  </span></span><br><span class="line"><span class="function"><span class="title">usage</span></span>() &#123;  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Usage: sh 执行脚本.sh [start|stop|restart|status]&quot;</span>  </span><br><span class="line">    <span class="built_in">exit</span> 1  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#检查程序是否在运行  </span></span><br><span class="line"><span class="function"><span class="title">is_exist</span></span>()&#123;  </span><br><span class="line">  pid=`ps -ef|grep <span class="variable">$APP_NAME</span>|grep -v grep|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> `  </span><br><span class="line">  <span class="comment">#如果不存在返回1，存在返回0       </span></span><br><span class="line">  <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$&#123;pid&#125;</span>&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">   <span class="built_in">return</span> 10  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">return</span> 0  </span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#启动方法  </span></span><br><span class="line"><span class="function"><span class="title">start</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is already running. pid=<span class="variable">$&#123;pid&#125;</span> .&quot;</span>  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">nohup</span> java <span class="variable">$JVM_OPTS</span> -jar <span class="variable">$APP_PATH</span> &gt; <span class="variable">$LOG_FILE</span> 2&gt;&amp;1 &amp;  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> started&quot;</span></span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#停止方法  </span></span><br><span class="line"><span class="function"><span class="title">stop</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">kill</span> -9 <span class="variable">$pid</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> stoped&quot;</span></span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is not running&quot;</span>  </span><br><span class="line">  <span class="keyword">fi</span>    </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#输出运行状态  </span></span><br><span class="line"><span class="function"><span class="title">status</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is running. Pid is <span class="variable">$&#123;pid&#125;</span>&quot;</span>  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is NOT running.&quot;</span>  </span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#重启  </span></span><br><span class="line"><span class="function"><span class="title">restart</span></span>()&#123;  </span><br><span class="line">  status</span><br><span class="line">  stop  </span><br><span class="line">  start</span><br><span class="line">  status</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#根据输入参数，选择执行对应方法，不输入则执行使用说明  </span></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span>  </span><br><span class="line">  <span class="string">&quot;start&quot;</span>)  </span><br><span class="line">    start  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;stop&quot;</span>)  </span><br><span class="line">    stop  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;status&quot;</span>)  </span><br><span class="line">    status  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;restart&quot;</span>)  </span><br><span class="line">    restart  </span><br><span class="line">    ;;  </span><br><span class="line">  *)  </span><br><span class="line">    usage  </span><br><span class="line">    ;;  </span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>新建一个<code>start.sh</code>，复制代码进去，塞到项目根目录中，修改相应变量即可使用</p><p>启动命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh start</span><br></pre></td></tr></table></figure><p>重新启动命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh restart</span><br></pre></td></tr></table></figure><p>关闭命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh stop</span><br></pre></td></tr></table></figure><p>查看运行状态命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh status</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Linux脚本 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ffmpeg合并手机B站缓存的视频</title>
      <link href="/posts/8594/"/>
      <url>/posts/8594/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>有时候在B站发布的视频下架了，虽然已经缓存了，但是B站已经把视频处理过，无法在相册查看和上传电脑，本教程利用ffmpeg将B站的缓存的视频和音频合并成mp4文件</p><p>本教程使用python编程，但使用ffmpeg合并音视频</p><h2 id="安装ffmpeg"><a href="#安装ffmpeg" class="headerlink" title="安装ffmpeg"></a>安装ffmpeg</h2><p>进入官网下载：<a href="https://ffmpeg.org/download.html#build-windows">Download FFmpeg</a></p><p>选择windows，点击第一个</p><p><img src="/../img/8594/1663041193774.png" alt="ffmpeg下载页面"></p><p>选择ffmpeg-git-full.7z</p><p><img src="/../img/8594/1663041301725.png" alt="下载ffmpeg"></p><p>解压</p><p><img src="/../img/8594/1663041675831.png" alt="解压后的文件夹目录"></p><p>设置环境变量</p><p>在系统变量的Path下新增环境变量，路径为解压后的文件夹路径加上bin目录即可</p><p><img src="/../img/8594/1663041477963.png" alt="添加环境变量"></p><p><a href="https://blog.csdn.net/weixin_39887926/article/details/118871838">win10配置计算机环境变量</a></p><p>测试</p><p><img src="/../img/8594/1663041572998.png" alt="测试ffmpeg是否安装成功"></p><h2 id="寻找缓存视频的位置"><a href="#寻找缓存视频的位置" class="headerlink" title="寻找缓存视频的位置"></a>寻找缓存视频的位置</h2><p><a href="https://www.bilibili.com/video/BV1hY411E72z/">2022了，手机app版b站的缓存视频文件在哪里找</a></p><p>简单来说就是到离线缓存-&gt;设置(小齿轮)-&gt;离线诊断，选择一个缓存过的视频，找到视频id，到文件管理器搜索，</p><p>直接去文件管理器去找B站缓存视频的位置：<code>Android\data\tv.danmaku.bili\download</code></p><p>找到位置后复制视频到电脑</p><h2 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h2><p>新建<code>demo.py</code>，将以下代码复制到<code>demo.py</code>中，执行<code>python demo.py</code>运行</p><p>input_path就是上传的B站缓存视频文件夹</p><p>out_path就是输出视频文件夹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_path=<span class="string">&quot;./系统架构师&quot;</span></span><br><span class="line">out_path=<span class="string">&quot;./out&quot;</span></span><br><span class="line"></span><br><span class="line">filename=<span class="string">&quot;&quot;</span></span><br><span class="line">video_path=<span class="string">&quot;&quot;</span></span><br><span class="line">audio_path=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_json</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> load_f:</span><br><span class="line">        <span class="keyword">return</span> json.load(load_f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(input_path):</span><br><span class="line">    <span class="keyword">if</span> root==input_path:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> files:</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;entry.json&quot;</span>:</span><br><span class="line">            json_data=read_json(root+<span class="string">&quot;/&quot;</span>+item)</span><br><span class="line">            filename=json_data[<span class="string">&#x27;page_data&#x27;</span>][<span class="string">&#x27;part&#x27;</span>].rsplit(<span class="string">&#x27;_&#x27;</span>,<span class="number">1</span>)[<span class="number">0</span>].replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;video.m4s&quot;</span>:</span><br><span class="line">            video_path=root+<span class="string">&quot;/&quot;</span>+item</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;audio.m4s&quot;</span>:</span><br><span class="line">            audio_path=root+<span class="string">&quot;/&quot;</span>+item</span><br><span class="line">    <span class="keyword">if</span> filename!=<span class="string">&quot;&quot;</span> <span class="keyword">and</span> video_path!=<span class="string">&quot;&quot;</span> <span class="keyword">and</span> audio_path!=<span class="string">&quot;&quot;</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;ffmpeg.exe -i &#x27;</span>+video_path+<span class="string">&#x27; -i &#x27;</span>+audio_path+<span class="string">&#x27; -vcodec copy -acodec copy &#x27;</span>+out_path+<span class="string">&#x27;/&#x27;</span>+filename+<span class="string">&#x27;.mp4 &#x27;</span>+<span class="string">&#x27; -y&#x27;</span>)</span><br><span class="line">        filename=<span class="string">&quot;&quot;</span></span><br><span class="line">        video_path=<span class="string">&quot;&quot;</span></span><br><span class="line">        audio_path=<span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ffmpeg </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>轻量级定制化框架Flask常用功能介绍</title>
      <link href="/posts/31000000/"/>
      <url>/posts/31000000/</url>
      
        <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install Flask==<span class="number">2.0</span><span class="number">.3</span></span><br><span class="line">pip install Jinja2==<span class="number">3.1</span><span class="number">.1</span>.</span><br></pre></td></tr></table></figure><p>下面介绍如何快速使用Flask搭建接口功能</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>最小的一个Flask应用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h3 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">GET(默认)</button></li><li class="tab"><button type="button" data-href="#tab-1-2">POST</button></li><li class="tab"><button type="button" data-href="#tab-1-3">PUT</button></li><li class="tab"><button type="button" data-href="#tab-1-4">DELETE</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><div class="note info flat"><p>methods：指定请求方法，可以多个，<code>methods=[&quot;POST&quot;,&quot;GET&quot;]</code>表示既可以接收<code>GET</code>请求，也可以接收<code>POST</code>请求</p><p>一般对应<code>CURD</code>操作的请求方法：<code>GET</code>、<code>POST</code>、<code>PUT</code>、<code>DELETE</code></p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;PUT&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;DELETE&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="返回数据方式"><a href="#返回数据方式" class="headerlink" title="返回数据方式"></a>返回数据方式</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">字符串</button></li><li class="tab"><button type="button" data-href="#tab-1-2">json</button></li><li class="tab"><button type="button" data-href="#tab-1-3">文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,Response</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    json_data=&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>:<span class="string">&quot;test&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Response(json.dumps(json_data),mimetype=<span class="string">&#x27;application/json&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>其中第一个参数是json数据转化后的字符串，第二个参数是媒体类型，json的媒体类型为<code>application/json</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,send_from_directory</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> send_from_directory(<span class="string">&#x27;./&#x27;</span>,<span class="string">&#x27;favicon.ico&#x27;</span>,mimetype=<span class="string">&#x27;image/vnd.microsoft.icon&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>其中第一个参数是文件路径，第二个参数是文件名，第三个是媒体类型，</p><p>常用媒体类型：</p><p>html：<code>text/html</code></p><p>css：&#96;text&#x2F;css&#96;&#96;</p><p>js：<code>application/x-javascript</code></p><p>图片：<code>image/jpeg</code></p><p>视频：<code>video/mp4</code></p><p>更多媒体类型参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME 类型 - HTTP | MDN</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="获取请求路径"><a href="#获取请求路径" class="headerlink" title="获取请求路径"></a>获取请求路径</h3><p>有时候请求路径不是固定的，我们可以在<code>@app.route()</code>中使用<code>&lt;&gt;</code>指定变化的部分路径</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">获取请求路径</button></li><li class="tab"><button type="button" data-href="#tab-1-2">获取指定类型的请求路径</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;num&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World! %s&#x27;</span> %num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>注意：定义的方法要传参</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>Flask还可以定义路径的类型<code>&lt;int:num&gt;</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;int:num&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World! %s&#x27;</span> %num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>如果&#x2F;后面不是int类型，它不会走进<code>hello_world</code>函数，如果没有符合的条件，Flask将会返回<code>404</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h3><p>在Flask中，有全局对象 <code>request</code> 处理请求，需要使用 <code>from flask import request</code> 导入模块</p><table><thead><tr><th align="center">属性名</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">args</td><td align="center">获取 get 请求的参数</td></tr><tr><td align="center">form</td><td align="center">获取 post 请求的参数</td></tr><tr><td align="center">method</td><td align="center">获取请求的方式 GET or POST</td></tr><tr><td align="center">files</td><td align="center">获取上传的文件</td></tr><tr><td align="center">cookies</td><td align="center">获取 cookie 信息</td></tr><tr><td align="center">headers</td><td align="center">获取请求头</td></tr><tr><td align="center">path</td><td align="center">获取 &#x2F;</td></tr><tr><td align="center">host</td><td align="center">获取 ip:host</td></tr><tr><td align="center">host_url</td><td align="center">获取 <a href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a></td></tr><tr><td align="center">referrer</td><td align="center">请求的来源</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,make_response,jsonify</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/to&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">today1</span>():</span><br><span class="line">    data=&#123;&#125;</span><br><span class="line">    data[<span class="string">&#x27;args&#x27;</span>]=request.args</span><br><span class="line">    data[<span class="string">&#x27;form&#x27;</span>]=request.form</span><br><span class="line">    data[<span class="string">&#x27;mothod&#x27;</span>]=request.method</span><br><span class="line">    data[<span class="string">&#x27;files&#x27;</span>]=request.files</span><br><span class="line">    data[<span class="string">&#x27;cookies&#x27;</span>]=request.cookies</span><br><span class="line">    data[<span class="string">&#x27;headers&#x27;</span>]=<span class="built_in">dict</span>(request.headers)</span><br><span class="line">    data[<span class="string">&#x27;path&#x27;</span>]=request.path</span><br><span class="line">    data[<span class="string">&#x27;host&#x27;</span>]=request.host</span><br><span class="line">    data[<span class="string">&#x27;host_url&#x27;</span>]=request.host_url</span><br><span class="line">    data[<span class="string">&#x27;referrer&#x27;</span>]=request.referrer</span><br><span class="line">    <span class="keyword">return</span> make_response(jsonify(data), <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h3 id="重定向页面"><a href="#重定向页面" class="headerlink" title="重定向页面"></a>重定向页面</h3><p>获取今日必应壁纸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,redirect</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/bing/today&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">today</span>():</span><br><span class="line">    req_url=<span class="string">&quot;https://cn.bing.com/HPImageArchive.aspx?n=1&amp;format=js&amp;idx=0&quot;</span></span><br><span class="line">    bing_url=<span class="string">&#x27;https://cn.bing.com&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(bing_url+json.loads(requests.get(req_url).text)[<span class="string">&quot;images&quot;</span>][<span class="number">0</span>][<span class="string">&#x27;url&#x27;</span>]) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p><code>redirect</code>函数接受一个参数，即转向地址栏的地址</p><h3 id="自定义请求错误页面"><a href="#自定义请求错误页面" class="headerlink" title="自定义请求错误页面"></a>自定义请求错误页面</h3><p>Flask自带的错误请求：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,abort</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/error&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error</span>():</span><br><span class="line">    abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>利用<code>abort</code>函数抛出错误码和对应的错误页面，常见的错误码含义：</p><p><code>400</code>：错误的请求</p><p><code>401</code>：未授权</p><p><code>403</code>：禁止访问</p><p><code>404</code>：未找到页面</p><p><code>405</code>：不被允许的请求方法</p><p><code>406</code>：不被接受的请求</p><p>自定义错误请求页面：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,abort,render_template_string</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/error&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error</span>():</span><br><span class="line">    abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">403</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page_403</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&#x27;&lt;h1&gt; Unauthorized &lt;/h1&gt;&lt;h2&gt;&#123;&#123; error_info &#125;&#125;&lt;/h2&gt;&#x27;</span>, error_info=error), <span class="number">403</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>如果<code>return jsonify(&#123;&quot;msg&quot;:&quot;请求错误&quot;,&quot;code&quot;:403&#125;), 200</code>，可返回json格式的错误提示（状态码200）</p><h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>可使用开发模式实现热部署：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>部署在服务器时，除了安装必要的环境之外，代码也有所变化。</p><p>因为<code>app.run()</code>默认属于同一网段才能访问且默认端口为<code>5000</code>，允许外网访问，指定运行端口，需要设置：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>因为<code>app.run()</code>是Flask自带的一个服务器供我们进行开发，我们可以使用python自带的<code>wsgiref</code>进行部署：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> wsgiref.simple_server <span class="keyword">import</span> make_server</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    server = make_server(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">5000</span>, app)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p>也可以使用Flask+Gunicorn+Nginx的Flask部署方案：<a href="https://www.cnblogs.com/hellohorld/p/10033720.html">Flask 应用如何部署</a></p><h2 id="建议阅读"><a href="#建议阅读" class="headerlink" title="建议阅读"></a>建议阅读</h2><p><a href="https://flask.net.cn/">Flask 中文网</a></p>]]></content>
      
      
      <categories>
          
          <category> Flask </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx原理详细讲解分析</title>
      <link href="/posts/d86b/"/>
      <url>/posts/d86b/</url>
      
        <content type="html"><![CDATA[<h2 id="模块结构"><a href="#模块结构" class="headerlink" title="模块结构"></a>模块结构</h2><p>Nginx是一个高性能的HTTP和反向代理服务器，它由内核和模块组成</p><p>内核包含着一些基础的数据结构，例如：链表、内存池、hashmap、String等，内核的工作十分简单，只是负责查找配置文件映射到location block上，location上匹配的指令将会启动不同的模块进行工作</p><p>Nginx 的模块从结构上分为<strong>核心模块、基础模块和第三方模块</strong>：</p><ul><li><strong>核心模块</strong>：HTTP 模块、EVENT 模块和 MAIL 模块</li><li><strong>基础模块</strong>：HTTP Access 模块、HTTP FastCGI 模块、HTTP</li><li><strong>第三方模块</strong>：HTTP Upstream Request Hash 模块、Notice 模块和 HTTPAccess Key 模块</li></ul><p>用户根据自己的需要开发的模块都属于第三方模块。正是有了这么多模块的支撑，Nginx 的功能才会如此强大。</p><p>Nginx 的模块从功能上分为如下三类：</p><ul><li><strong>Handlers</strong>：即处理器模块。此类模块直接处理请求，并进行输出内容和修改 headers 信息等操作。Handlers 处理器模块一般只能有一个。</li><li><strong>Filters</strong>：即过滤器模块。此类模块主要对其他处理器模块输出的内容进行修改操作，最后由 Nginx 输出。</li><li><strong>Proxies</strong>：即代理类模块。此类模块是 Nginx 的 HTTP Upstream 之类的模块，这些模块主要与后端一些服务比如 FastCGI 等进行交互，实现服务代理和负载均衡等功能。</li></ul><h2 id="进程模型"><a href="#进程模型" class="headerlink" title="进程模型"></a>进程模型</h2><p><img src="/../img/d86b/1662609700517.png" alt="nginx进程模型"></p><p>nginx启动后会创建一个master进程（建立需要listen的socket），Master进程再fork出若干个worker进程，当用户请求到nginx时，worker会接受并处理用户请求</p><h3 id="master进程"><a href="#master进程" class="headerlink" title="master进程"></a>master进程</h3><p>master进程只负责管理worker进程，当master进程启动后，它会读取配置文件，fork出worker进程；当重新启动master进程时，它会重新加载配置文件，并启动新的worker进程，向旧的worke进程发送信号，结束旧进程，而旧的worker在收到来自master的信号后，就不再接收新的请求，并且在当前进程中的所有未处理完的请求处理完成后，再退出。</p><h3 id="worker进程"><a href="#worker进程" class="headerlink" title="worker进程"></a>worker进程</h3><p>worker进程之间是平等的，每个进程，处理请求的机会也是一样的。当我们提供80端口的http服务时，一个连接请求过来，每个进程都有可能处理这个连接。首先，每个worker进程都是从master进程fork过来，在master进程里面，先建立好需要listen的socket（listenfd）之后，然后再fork出多个worker进程。所有worker进程的listenfd会在新连接到来时变得可读，为保证只有一个进程处理该连接，所有worker进程在注册listenfd读事件前抢accept_mutex，抢到互斥锁的那个进程注册listenfd读事件，在读事件里调用accept接受该连接。当一个worker进程在accept这个连接之后，就开始读取请求，解析请求，处理请求，产生数据后，再返回给客户端，最后才断开连接，这样一个完整的请求就是这样的了。我们可以看到，一个请求，完全由worker进程来处理，而且只在一个worker进程中处理。</p><h2 id="多进程IO模型"><a href="#多进程IO模型" class="headerlink" title="多进程IO模型"></a>多进程IO模型</h2><p>Nginx 采用了异步非阻塞的方式来处理请求。也就是说，Nginx 是可以同时处理成千上万个请求的。非阻塞就是，事件没有准备好，马上返回EAGAIN，告诉你，事件还没准备好呢，你慌什么，过会再来吧。好吧，你过一会，再来检查一下事件，直到事件准备好了为止，在这期间，你就可以先去做其它事情，然后再来看看事件好了没，也就是epoll多路复用技术</p>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx原理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python日期格式化输出的方法（time，datetime）</title>
      <link href="/posts/a9f4/"/>
      <url>/posts/a9f4/</url>
      
        <content type="html"><![CDATA[<h2 id="time模块"><a href="#time模块" class="headerlink" title="time模块"></a>time模块</h2><p>time模块是python的一个内置模块，使用时需要导入</p><ul><li>输出时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ticks = time.time()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ticks)</span><br><span class="line"><span class="number">1662470588.7917633</span></span><br></pre></td></tr></table></figure><ul><li>获取当前时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>now=time.asctime()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(now)</span><br><span class="line">Tue Sep  <span class="number">6</span> <span class="number">21</span>:<span class="number">26</span>:04 <span class="number">2022</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化时间（%Y-%m-%d %H:%M:%S）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,time.localtime())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">28</span>:<span class="number">42</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化日期（%Y-%m-%d）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>,time.localtime())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06</span><br></pre></td></tr></table></figure><ul><li>获取指定格式化时间（<code>2022/09/06 20:40:00</code> -&gt;<code>2022-09-06 20:40:00</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.strptime(<span class="string">&#x27;2022/09/06 20:40:00&#x27;</span>,<span class="string">&#x27;%Y/%m/%d %H:%M:%S&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,timearray)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">20</span>:<span class="number">40</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure><ul><li>格式化时间转换为时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.strptime(<span class="string">&#x27;2022/09/06 20:40:00&#x27;</span>,<span class="string">&#x27;%Y/%m/%d %H:%M:%S&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=<span class="built_in">int</span>(time.mktime(timearray))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(timestamp)</span><br><span class="line"><span class="number">1662468000</span></span><br></pre></td></tr></table></figure><ul><li>时间戳转换为格式化时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=<span class="number">1662468000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.localtime(timestamp)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,timearray)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">20</span>:<span class="number">40</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure><h2 id="datetime模块"><a href="#datetime模块" class="headerlink" title="datetime模块"></a>datetime模块</h2><p>datetime模块是python的一个内置模块，使用时需要导入</p><ul><li>输出时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=datetime.datetime.now().timestamp()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(timestamp)</span><br><span class="line"><span class="number">1662472380.087664</span></span><br></pre></td></tr></table></figure><ul><li>获取当前时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>now=datetime.datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(now)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">35</span>:<span class="number">12.361862</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化时间（%Y-%m-%d %H:%M:%S）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">36</span>:<span class="number">32</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化日期（%Y-%m-%d）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.now().strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06</span><br></pre></td></tr></table></figure><ul><li>获取指定格式化时间（<code>2022/09/06 20:40:00</code> -&gt;<code>2022-09-06 20:40:00</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime(<span class="number">2022</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">2</span>,<span class="number">32</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">22</span>:02:<span class="number">32</span></span><br></pre></td></tr></table></figure><ul><li>格式化时间转换为时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>stamptime=datetime.datetime(<span class="number">2022</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">2</span>,<span class="number">32</span>).timestamp()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(stamptime)</span><br><span class="line"><span class="number">1662472952.0</span></span><br></pre></td></tr></table></figure><ul><li>时间戳转换为格式化时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.fromtimestamp(<span class="number">1662472952.0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">22</span>:02:<span class="number">32</span></span><br></pre></td></tr></table></figure><h2 id="日期格式化符号"><a href="#日期格式化符号" class="headerlink" title="日期格式化符号"></a>日期格式化符号</h2><p>python中时间日期格式化符号：</p><ul><li>%y：两位数的年份表示（00-99）</li><li>%Y：四位数的年份表示（000-9999）</li><li>%m：月份（01-12）</li><li>%d：月内中的一天（0-31）</li><li>%H：24小时制小时数（0-23）</li><li>%I：12小时制小时数（01-12）</li><li>%M：分钟数（00-59）</li><li>%S：秒（00-59）</li><li>%a：本地简化星期名称</li><li>%A：本地完整星期名称</li><li>%b：本地简化的月份名称</li><li>%B：本地完整的月份名称</li><li>%c：本地相应的日期表示和时间表示</li><li>%j：年内的一天（001-366）</li><li>%p：本地A.M.或P.M.的等价符</li><li>%U：一年中的星期数（00-53）星期天为星期的开始</li><li>%w：星期（0-6），星期天为星期的开始</li><li>%W：一年中的星期数（00-53）星期一为星期的开始</li><li>%x：本地相应的日期表示</li><li>%X：本地相应的时间表示</li><li>%Z：当前时区的名称</li><li>%%：%号本身</li></ul><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://www.runoob.com/python/python-date-time.html">Python 日期和时间 | 菜鸟教程</a></p><p><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017648783851616">datetime - 廖雪峰的官方网站</a></p><p><a href="https://www.cnblogs.com/Army-Knife/p/10689599.html">python中日期和时间格式化输出的方法</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 日期格式化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我用include命令让Nginx配置文件内容缩短到四分之一</title>
      <link href="/posts/b261/"/>
      <url>/posts/b261/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做网站一段时间了，最近登录服务器发现Nginx的配置文件达到了惊人的四百多行，这个配置文件臃肿得让我看不下去了，该给配置文件”瘦瘦身”了。现在此记录一下”瘦身过程”。</p><h2 id="瘦身过程"><a href="#瘦身过程" class="headerlink" title="瘦身过程"></a>瘦身过程</h2><p>众所周知，Nginx可以引入其他<code>.conf</code>配置文件，我们可以将各个域名单独给它命名一个<code>.conf</code>配置文件，然后在<code>nginx.conf</code>引入它即可。</p><p>首先在Nginx的conf目录下新建文件夹，用来保存网站的配置文件：</p><p><img src="/../img/b261/1662290172444.png" alt="nginx配置文件路径"></p><p>然后为Nginx下的站点单独命名一个<code>.conf</code>文件：</p><p><img src="/../img/b261/1662290241192.png" alt="站点配置"></p><p>将关于该站点的<code>server</code>块剪切到对应的<code>.conf</code>文件后，在<code>nginx.conf</code>添加<code>include</code>引入网站配置文件：</p><p><img src="/../img/b261/1662290404095.png" alt="nginx配置"></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">瘦身前</button></li><li class="tab"><button type="button" data-href="#tab-1-2">瘦身后</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/b261/1662289899056.png" alt="瘦身前配置行数"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/b261/1662290051371.png" alt="瘦身后配置行数"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx优化配置文件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用命令学习：cat命令</title>
      <link href="/posts/7cc8/"/>
      <url>/posts/7cc8/</url>
      
        <content type="html"><![CDATA[<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>cat（英文全拼：concatenate）命令用于连接文件并打印到标准输出设备上</p><h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat [-option] fileName</span><br></pre></td></tr></table></figure><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>显示文件内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat textfile1</span><br></pre></td></tr></table></figure><p>将文件追加（&gt;&gt;）覆盖（&gt;）到另一个文件中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat textfile1 &gt;&gt; textfile2</span><br><span class="line"></span><br><span class="line">cat textfile1 &gt; textfile2</span><br></pre></td></tr></table></figure><p>将字符串追加（&gt;&gt;）覆盖（&gt;）到文件中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt; file &lt;&lt; EOF</span><br><span class="line">aaaaaa</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; file &lt;&lt; EOF</span><br><span class="line">aaaaaa</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>清空文档内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /dev/null &gt; /etc/test.txt</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&quot; &gt; /etc/test.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux命令学习 </tag>
            
            <tag> cat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定时任务Cron表达式详细讲解</title>
      <link href="/posts/19b8/"/>
      <url>/posts/19b8/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>定时任务，就是能够在规定时间内<code>重复执行</code>的任务。而定义定时任务的表达式就是<code>Cron</code>表达式。</p><p>Corn表达式就是一个字符串，它以5或6个空格隔开，包含6或7个域，每一个域代表一个含义，Cron表达式有两种语法格式：</p><p>（1）秒 分 时 日 月 周 年</p><p>（2）秒 分 时 日 月 周</p><p>第二种语法格式少了一个<code>年</code>，代表每一年，尽量使用第一种，第二年钟可能会出现奇怪的<code>bug</code></p><p>各字段的符号范围以及允许字符：</p><table><thead><tr><th align="center"><strong>字段</strong></th><th align="center"><strong>允许值</strong></th><th align="center"><strong>允许字符</strong></th></tr></thead><tbody><tr><td align="center">秒</td><td align="center">0-59</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">分</td><td align="center">0-59</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">时</td><td align="center">0-23</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">日</td><td align="center">1-31</td><td align="center">, - * ? &#x2F; L W C</td></tr><tr><td align="center">月</td><td align="center">1-12 或 JAN-DEC</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">周</td><td align="center">1-7 或 SUN-SAT</td><td align="center">, - * ? &#x2F; L C #</td></tr><tr><td align="center">年</td><td align="center">留空 或 1970-2099</td><td align="center">, - * &#x2F;</td></tr></tbody></table><h2 id="详解"><a href="#详解" class="headerlink" title="详解"></a>详解</h2><p>Cron在线表达式生成器：<a href="http://cron.ciding.cc/">http://cron.ciding.cc/</a></p><h3 id="秒"><a href="#秒" class="headerlink" title="秒"></a>秒</h3><p>允许值范围: 0~59，不允许为空值</p><p><code>*</code>：每隔1秒钟触发。例子：<code>* * * * * *</code>代表每秒钟执行<code>1</code>次</p><p><code>,</code>：指定的秒数触发。例子：<code>0,30,45 * * * * *</code> 代表每分钟的第<code>0,30,45</code>秒执行</p><p><code>-</code>：指定的范围内触发。例子：<code>10-30 * * * * *</code>代表每分钟从<code>第10秒开始到第30秒</code>结束，<code>每隔1秒执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>5/10 * * * * ?</code>代表从第<code>5</code>秒开始，每隔<code>10</code>秒执行1次</li><li><code>/20 * * * * ?</code>代表从第<code>0</code>秒开始，每隔<code>20</code>秒执行1次</li><li><code>10-40/10 * * * * *</code>代表从第<code>10</code>秒开始，第<code>40</code>秒结束，每隔<code>10</code>秒执行<code>1</code>次</li></ul><h3 id="分"><a href="#分" class="headerlink" title="分"></a>分</h3><p>允许值范围: 0~59，不允许为空值</p><p><code>*</code>：每隔1分钟触发。例子：<code>0 * * * * *</code>代表每分钟执行<code>1</code>次</p><p><code>,</code>：指定的分钟触发。例子：<code>0 0,30,45 * * * *</code> 代表第<code>0,30,45</code>分钟执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 10-30 * * * *</code>代表从<code>第10分钟开始到第30分钟</code>结束，<code>每隔1分钟执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 5/10 * * * *</code>代表从第<code>5</code>分钟开始，每隔<code>10</code>分钟执行1次</li><li><code>0 /20 * * * ?</code>代表从第<code>0</code>分钟开始，每隔<code>20</code>分钟执行1次</li><li><code>0 10-40/10 * * * *</code>代表从第<code>10</code>分钟开始，第<code>40</code>分钟结束，每隔<code>10</code>分钟执行<code>1</code>次</li></ul><h3 id="时"><a href="#时" class="headerlink" title="时"></a>时</h3><p>允许值范围: 0~23，不允许为空值</p><p><code>*</code>：每隔1小时触发。例子：<code>0 0 * * * *</code>代表每小时执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0,2,9 * * *</code> 代表第<code>0,2,9</code>小时执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 10-20 * * *</code>代表从<code>第10点开始到第20点</code>结束，<code>每隔1小时执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 5/10 * * *</code>代表从第<code>5</code>点开始，每隔<code>10</code>小时执行1次</li><li><code>0 0 /20 * * ?</code>代表从第<code>0</code>点开始，每隔<code>20</code>小时执行1次</li><li><code>0 0 10-20/10 * * *</code>代表从第<code>10</code>点开始，第<code>20</code>点结束，每隔<code>10</code>小时执行<code>1</code>次</li></ul><h3 id="日"><a href="#日" class="headerlink" title="日"></a>日</h3><p>允许值范围: 1-31 ,不允许为空值</p><p><code>W</code>字符代表着平日(Mon-Fri)，并且仅能用于日域中。它用来指定离指定日的最近的一个平日。大部分的商业处理都是基于工作周的，所以 W 字符可能是非常重要的。例子：</p><ul><li><code>15W</code>：离该月15号的最近一个平日。假如15号是星期六，那么<code>15W</code>会在14号(星期五)触发，因为星期四比星期一离15号更近。</li></ul><p><code>C</code>：计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例子：</p><ul><li><code>5C</code>在日期字段中就相当于日历5日以后的第一天。<code>1C</code>在星期字段中相当于星期日后的第一天。</li></ul><h3 id="月"><a href="#月" class="headerlink" title="月"></a>月</h3><p>允许值范围: 1~12 (JAN-DEC),不允许为空值</p><p><code>*</code>：每月触发。例子：<code>0 0 0 1 * ? *</code>代表每月<code>1日</code>执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0 1 2,5 ? *</code> 代表<code>2月1日、5月1日</code>执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 0 1 8-12 ? *</code>代表从<code>8月1日开始，12月1日</code>结束，<code>每隔1月执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 0 1 1/2 ? *</code>代表从<code>1月1日</code>开始，每隔<code>2</code>月执行1次</li><li><code>0 0 0 1 /2 ? *</code>代表从<code>1月1日</code>开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 2-10/2 ? *</code>代表从<code>2月1日</code>开始，<code>10月1日</code>结束，每隔<code>2</code>月执行<code>1</code>次</li></ul><h3 id="周"><a href="#周" class="headerlink" title="周"></a>周</h3><p>允许值范围: 1~7 (SUN-SAT),1代表星期天(一星期的第一天)，以此类推，7代表星期六(一星期的最后一天)，不允许为空值</p><p><code>*</code> ：每星期都触发；</p><p><code>?</code>：与{日期}互斥，即意味着若明确指定{日期}触发，则表示{星期}无意义，以免引起冲突和混乱</p><p><code>,</code> ：在指定的星期约定触发。例子：</p><ul><li><code>0 0 0 * * 1,3,5</code>代表星期天、星期二和星期四触发</li></ul><p><code>-</code>：在指定的星期范围内触发，比如<code>2-4</code>代表从星期一开始触发到星期三结束触发，每隔1天触发</p><p><code>/</code> ：触发步进(step)，<code>/</code>前面的值代表初始值(等同1)，后面的值代表偏移量，例子：</p><ul><li><p><code>1/3</code>或者<code>/3</code>：从星期天开始触发，每隔3天触发1次</p></li><li><p><code>1-5/2</code>：在[1,5]范围内，每隔2天触发，即星期天、星期二、星期四触发</p></li></ul><p><code>L</code> 如果{星期}占位符如果是<code>L</code>，即意味着星期的的最后一天触发，即星期六触发，L&#x3D; 7或者 L &#x3D; SAT，例子：</p><ul><li><code>5L</code>：一个月的最后一个星期四触发</li></ul><p><code>#</code> 用来指定具体的周数，<code>#</code>前面代表星期，<code>#</code>后面代表本月第几周，例子：</p><ul><li><code>2#2</code>：本月第二周的星期一，<code>5#3</code>表示本月第三周的星期四，因此，<code>5L</code>这种形式只不过是<code>#</code>的特殊形式而已</li></ul><h3 id="年"><a href="#年" class="headerlink" title="年"></a>年</h3><p>允许值范围: 1970~2099 ,允许为空</p><p><code>*</code>：每年触发。例子：<code>0 0 0 1 1 ? *</code>代表每年<code>1月1日</code>执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0 1 1 ? 2022,2023</code> 代表<code>2022年1月1日、2023年1月1日</code>执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 0 1 1 ? 2022-2032</code>代表从<code>2022年1月1日开始到2032年1月1日</code>结束，<code>每隔1年执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 0 1 1 ? 2022/2</code>代表从<code>2022</code>年开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 1 ? /2</code>代表从<code>当前年1月1日</code>开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 1 ? 2022-2032/2</code>代表从<code>2022年1月1日</code>开始，<code>2032年1月1日</code>结束，每隔<code>2</code>年执行<code>1</code>次</li></ul>]]></content>
      
      
      <categories>
          
          <category> Cron </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用工具安装：python3.8.5</title>
      <link href="/posts/d5f4/"/>
      <url>/posts/d5f4/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>通常服务器上自带了python2.7环境，但由于版本太低，部署一些需要python3环境的应用就会被限制，但是yum命令又依赖python2.7环境，所以升级python时需要注意。本次安装版本为<code>3.8.5</code></p><h2 id="安装python3-8-5"><a href="#安装python3-8-5" class="headerlink" title="安装python3.8.5"></a>安装<code>python3.8.5</code></h2><p>官网下载地址：<a href="https://www.python.org/downloads/source/">https://www.python.org/downloads/source/</a></p><p>选择gzip压缩的源码包，上传到服务器中</p><p><img src="/../img/d5f4/1662039490513.png" alt="python下载界面"></p><p>新建python安装路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/python3</span><br></pre></td></tr></table></figure><p>安装依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel libffi-devel zlib*</span><br></pre></td></tr></table></figure><p>解压<code>Python-3.8.5.tgz</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf Python-3.8.5.tgz</span><br></pre></td></tr></table></figure><p>进入<code>Python-3.8.5</code>目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd Python-3.8.5</span><br></pre></td></tr></table></figure><p>编译</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/python3</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="创建新的软连接"><a href="#创建新的软连接" class="headerlink" title="创建新的软连接"></a>创建新的软连接</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/python3/bin/python3 /usr/bin/python</span><br><span class="line">ln -s /usr/local/python3/bin/pip3 /usr/bin/pip</span><br></pre></td></tr></table></figure><p>若出现<code>‘/usr/bin/python’: File exists</code>，可先执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /usr/bin/python</span><br><span class="line">rm -rf /usr/bin/pip</span><br></pre></td></tr></table></figure><h2 id="修改yum配置"><a href="#修改yum配置" class="headerlink" title="修改yum配置"></a>修改yum配置</h2><p>升级<code>python3.8.5</code>以后，运行yum命令就会报错，需要修改yum的配置文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/bin/yum</span><br></pre></td></tr></table></figure><p><img src="/../img/d5f4/1662040659422.png" alt="yum配置"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/libexec/urlgrabber-ext-down</span><br></pre></td></tr></table></figure><p><img src="/../img/d5f4/1662040693608.png" alt="yum配置"></p><h2 id="pip换源"><a href="#pip换源" class="headerlink" title="pip换源"></a>pip换源</h2><p>pip更换国内源，可以提升python包的下载速度，建议更换</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.pip/pip.conf</span><br></pre></td></tr></table></figure><p>写下以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = http://pypi.douban.com/simple/</span><br><span class="line">trusted-host = pypi.douban.com</span><br></pre></td></tr></table></figure><h2 id="升级pip"><a href="#升级pip" class="headerlink" title="升级pip"></a>升级pip</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip -V</span><br><span class="line">python -V</span><br><span class="line">yum --version</span><br></pre></td></tr></table></figure><p><img src="/../img/d5f4/1662041052405.png" alt="测试结果"></p><p>升级完成</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/Eternal_Blue/article/details/103762999">Linux下升级安装python3.8</a></p><p><a href="https://blog.csdn.net/qq_39852676/article/details/101591865">linux更换pip源</a></p><p><a href="https://www.cnblogs.com/qinlangsky/p/12653880.html">Linux系统中如何升级pip</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八月份小结：我的博客收获小结</title>
      <link href="/posts/5f5d/"/>
      <url>/posts/5f5d/</url>
      
        <content type="html"><![CDATA[<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这个月上旬一直在迷茫，下旬想了想搭建了博客玩玩，加了官方群学到了基础的博客用法，同时也认识了许多博客大佬，在和大佬们的交流中学到了很多有趣的想法。一句话总结：一入优化深似海</p><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul><li>记录了<a href="https://blog.panghai.top/posts/447d/">博客搭建过程</a></li><li>想要图片背景，搭建了一个<a href="https://blog.panghai.top/posts/af9f/">必应壁纸api</a>免去找图烦恼</li><li>记录自己在<a href="https://blog.panghai.top/posts/830e/">Nginx的应用</a></li><li>想要博客评论系统，找文档私有部署了<a href="https://blog.panghai.top/posts/3f0b/">Twikoo</a></li><li>想要有效地收到消息，找文档私有部署了<a href="https://blog.panghai.top/posts/7b50/">Qmsg</a></li><li>逛其他博客时觉得效果很好，搬到自己博客里，并修改了部分代码适配自己地博客</li><li>添加了许多大佬的友链，更方便地向他们学习</li><li>使用CDN加速自己的博客</li><li>查找资料让搜索引擎收录自己的博客</li><li>查找api监控博客状态</li><li>月底整理了文章标签和分类</li></ul><h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><ol><li><del>博客优化中按照官方搭建说说的api用不了</del>，看看大佬是怎么搭建的</li><li><del>每天一篇博文太多了</del>，克服克服</li><li><del>优化真的是永无止境</del>，该适可而止了</li></ol><h2 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h2><ol><li>保持每日一篇文章的产出</li><li>是时候搭建另一个站点了</li><li>继续完善页面，逐渐停止优化，专注文章产出</li></ol>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：美化魔改教程</title>
      <link href="/posts/b20a/"/>
      <url>/posts/b20a/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>看到群里大佬优化的页面后终于还是忍不住了，在借鉴大佬的代码上我加了些许改进以更适合我的博客。</p><p>总体来说这篇文章是在Butterfly的基础对页面的一些优化，因为涉及到修改源码，所以记录一下修改过程，以免升级主题时产生冲突。</p><h2 id="添加访问统计"><a href="#添加访问统计" class="headerlink" title="添加访问统计"></a>添加访问统计</h2><p>原文：<a href="https://blog.leonus.cn/2022/51la.html">51la统计美化 | Leonus</a></p><h3 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h3><p>在<code>md</code>文件中添加以下代码：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">### 访客统计</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;pvisitor&quot;</span>&gt;</span></span></span><br><span class="line"><span class="code">    &lt;div class=&quot;content&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">&lt;/div&gt;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section">### 访客信息</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;ivisitor&quot;</span>&gt;</span></span></span><br><span class="line"><span class="code">&lt;div class=&quot;content&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">&lt;/div&gt;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">fetch(&#x27;https://v6-widget.51.la/v6/JnHw7yNkc1XsvRUB/quote.js&#x27;).then(res =&gt; res.text()).then((data) =&gt; &#123;</span><br><span class="line"><span class="code">    let title = [&#x27;最近活跃访客&#x27;, &#x27;今日访问人数&#x27;, &#x27;今日访问量&#x27;, &#x27;昨日人数&#x27;, &#x27;昨日访问量&#x27;, &#x27;本月访问量&#x27;, &#x27;总访问量&#x27;]</span></span><br><span class="line"><span class="code">    let num = data.match(/(?&lt;=&lt;\/span&gt;&lt;span&gt;).*?(?=&lt;\/span&gt;&lt;\/p&gt;)/g)</span></span><br><span class="line"><span class="code">    let s = document.querySelectorAll(&#x27;#pvisitor .content&#x27;)[0]</span></span><br><span class="line"><span class="code">    for (let i = 0; i &lt; num.length; i++) &#123;</span></span><br><span class="line"><span class="code">        if (i == 3 || i == 4) continue;</span></span><br><span class="line"><span class="code">        s.innerHTML += &#x27;&lt;div&gt;&lt;span&gt;&#x27; + title[i] + &#x27;&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;&#x27; + num[i] + &#x27;&lt;/span&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;);</span></span><br><span class="line"><span class="code">fetch(&#x27;https://api.vvhan.com/api/visitor.info&#x27;).then(res =&gt; res.json()).then((data) =&gt; &#123; //获取访客操作系统</span></span><br><span class="line"><span class="code">    fetch(&#x27;https://ip.useragentinfo.com/json&#x27;).then(res=&gt;res.json()).then((n)=&gt;&#123; //获取访客ip地址</span></span><br><span class="line"><span class="code">        if(!n.area)&#123;</span></span><br><span class="line"><span class="code">            n.area = n.city</span></span><br><span class="line"><span class="code">        &#125;else&#123;</span></span><br><span class="line"><span class="code">            fetch(&#x27;https://restapi.amap.com/v3/weather/weatherInfo?key=ede94e146b9ee45e2db6fe7de1650a31&amp;city=&#x27;+n.area).then(res=&gt; res.json()).then((wea)=&gt;&#123; //获取访客所在地的天气</span></span><br><span class="line"><span class="code">                wea = wea.lives[0]</span></span><br><span class="line"><span class="code">                let c = document.querySelectorAll(&#x27;#ivisitor .content&#x27;)[0]</span></span><br><span class="line"><span class="code">                var system = data[&#x27;system&#x27;].split(&#x27; &#x27;)[0]</span></span><br><span class="line"><span class="code">                var addr = n.area</span></span><br><span class="line"><span class="code">                var ipaddr = data[&#x27;ip&#x27;]</span></span><br><span class="line"><span class="code">                var weather = wea.weather+&quot; &quot;+wea.temperature+&quot;\u2103&quot;</span></span><br><span class="line"><span class="code">                var tip = data[&#x27;tip&#x27;]</span></span><br><span class="line"><span class="code">                system = system===&quot;未知操作系统&quot;?&quot;移动端&quot;:system</span></span><br><span class="line"><span class="code">                addr = addr===null?&quot;未知&quot;:addr</span></span><br><span class="line"><span class="code">                ipaddr = ipaddr===null?&quot;未知&quot;:ipaddr</span></span><br><span class="line"><span class="code">                weather = weather===null?&quot;未知&quot;:weather</span></span><br><span class="line"><span class="code">tip = tip===null?&quot;未知&quot;:tip</span></span><br><span class="line"><span class="code">if(system==&quot;移动端&quot;)&#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">          </span></span><br><span class="line"><span class="code">                c.innerHTML = `&lt;div&gt;&lt;span&gt;系统&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;system&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                &lt;div&gt;&lt;span&gt;地址&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;addr&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                &lt;div&gt;&lt;span&gt;IP地址&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;ipaddr&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                &lt;div&gt;&lt;span&gt;天气&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;weather&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                &lt;div&gt;&lt;span&gt;温馨提示&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;</span></span><br><span class="line"><span class="code">                    &lt;div style=&quot;width:100% !important&quot;&gt;&lt;span style=&quot;font-size:1.5rem;font-weight:bold;display:block;&quot;&gt;$&#123;tip&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                &lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">                `</span></span><br><span class="line"><span class="code">            &#125;)</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    &#125;)</span></span><br><span class="line"><span class="code">&#125;);</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>这里我修改了部分代码以适配我的博客</p><h3 id="添加侧边栏统计"><a href="#添加侧边栏统计" class="headerlink" title="添加侧边栏统计"></a>添加侧边栏统计</h3><p>除此之外，根据<a href="https://blog.leonus.cn/">大佬</a>记录的代码，我增加了侧边栏统计的样式</p><p><img src="/../img/b20a/1661956151336.png" alt="侧边栏统计"></p><div class="note info modern"><p>自定义侧边栏可参考官方文档：<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p></div><p>步骤如下：</p><p>1、新建<code>博客根目录/source/_data/widget.yml</code>，添加代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&#x27;&lt;div id=&quot;visitor&quot;&gt;&lt;div class=&quot;content&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p>2、新建<code>博客根目录/source/js/panghai.top.js</code>，js名称根据自己网站名称修改，js添加代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://v6-widget.51.la/v6/JnHw7yNkc1XsvRUB/quote.js&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> title = [<span class="string">&#x27;最近活跃访客&#x27;</span>, <span class="string">&#x27;今日访问人数&#x27;</span>, <span class="string">&#x27;今日访问量&#x27;</span>, <span class="string">&#x27;昨日人数&#x27;</span>, <span class="string">&#x27;昨日访问量&#x27;</span>, <span class="string">&#x27;本月访问量&#x27;</span>, <span class="string">&#x27;总访问量&#x27;</span>]</span><br><span class="line">    <span class="keyword">let</span> num = data.<span class="title function_">match</span>(<span class="regexp">/(?&lt;=&lt;\/span&gt;&lt;span&gt;).*?(?=&lt;\/span&gt;&lt;\/p&gt;)/g</span>)</span><br><span class="line">    <span class="keyword">let</span> s = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;#visitor .content&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; num.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span> || i == <span class="number">4</span>) <span class="keyword">continue</span>;</span><br><span class="line">        s.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;div&gt;&lt;p&gt;&lt;span id=name&gt;&#x27;</span> + title[i] + <span class="string">&#x27;&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;&#x27;</span> + num[i] + <span class="string">&#x27;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>JnHw7yNkc1XsvRUB</code>改为自己的，获取方式可参照：<a href="/posts/c90c/#%E4%BE%A7%E8%BE%B9%E6%A0%8F%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1">Butterfly 博客搭建（进阶教程）</a></p><p>3、编辑<code>_config.butterfly.yml</code>添加自己的js文件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/blog.panghai.top.js&quot;&gt;&lt;/script&gt;</span>                                            <span class="comment"># 博客扩展脚本</span></span><br></pre></td></tr></table></figure><h2 id="添加文章统计图"><a href="#添加文章统计图" class="headerlink" title="添加文章统计图"></a>添加文章统计图</h2><p>原文：<a href="https://blog.eurkon.com/post/1213ef82.html">Hexo 博客文章统计图 | Eurkon</a></p><h3 id="重点-1"><a href="#重点-1" class="headerlink" title="重点"></a>重点</h3><p>在 <code>[Blogroot]\themes\butterfly\scripts\helpers\</code> 目录下新建 <code>charts.js</code> 文件，然后添加以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> moment = <span class="built_in">require</span>(<span class="string">&#x27;moment&#x27;</span>)</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="keyword">function</span> (<span class="params">locals</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> $ = cheerio.<span class="title function_">load</span>(locals)</span><br><span class="line">  <span class="keyword">const</span> post = $(<span class="string">&#x27;#posts-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> tag = $(<span class="string">&#x27;#tags-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> category = $(<span class="string">&#x27;#categories-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> htmlEncode = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (post.<span class="property">length</span> &gt; <span class="number">0</span> || tag.<span class="property">length</span> &gt; <span class="number">0</span> || category.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (post.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#postsChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (post.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      post.<span class="title function_">after</span>(<span class="title function_">postsChart</span>(post.<span class="title function_">attr</span>(<span class="string">&#x27;data-start&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#tagsChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (tag.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      tag.<span class="title function_">after</span>(<span class="title function_">tagsChart</span>(tag.<span class="title function_">attr</span>(<span class="string">&#x27;data-length&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (category.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#categoriesChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (category.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      category.<span class="title function_">after</span>(<span class="title function_">categoriesChart</span>(category.<span class="title function_">attr</span>(<span class="string">&#x27;data-parent&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (htmlEncode) &#123;</span><br><span class="line">      <span class="keyword">return</span> $.<span class="title function_">root</span>().<span class="title function_">html</span>().<span class="title function_">replace</span>(<span class="regexp">/&amp;amp;#/g</span>, <span class="string">&#x27;&amp;#&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> $.<span class="title function_">root</span>().<span class="title function_">html</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> locals</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">postsChart</span> (startMonth) &#123;</span><br><span class="line">  <span class="keyword">const</span> startDate = <span class="title function_">moment</span>(startMonth || <span class="string">&#x27;2022-07&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> endDate = <span class="title function_">moment</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> monthMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  <span class="keyword">const</span> dayTime = <span class="number">3600</span> * <span class="number">24</span> * <span class="number">1000</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> time = startDate; time &lt;= endDate; time += dayTime) &#123;</span><br><span class="line">    <span class="keyword">const</span> month = <span class="title function_">moment</span>(time).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!monthMap.<span class="title function_">has</span>(month)) &#123;</span><br><span class="line">      monthMap.<span class="title function_">set</span>(month, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;posts&#x27;</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">post</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> month = post.<span class="property">date</span>.<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (monthMap.<span class="title function_">has</span>(month)) &#123;</span><br><span class="line">      monthMap.<span class="title function_">set</span>(month, monthMap.<span class="title function_">get</span>(month) + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">const</span> monthArr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([...monthMap.<span class="title function_">keys</span>()])</span><br><span class="line">  <span class="keyword">const</span> monthValueArr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([...monthMap.<span class="title function_">values</span>()])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;postsChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var postsChart = echarts.init(document.getElementById(&#x27;posts-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var postsOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;文章发布统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;</span></span><br><span class="line"><span class="string">        trigger: &#x27;axis&#x27;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      xAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;日期&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;category&#x27;,</span></span><br><span class="line"><span class="string">        boundaryGap: false,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;monthArr&#125;</span></span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      yAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;value&#x27;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        splitLine: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: [&#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;line&#x27;,</span></span><br><span class="line"><span class="string">        smooth: true,</span></span><br><span class="line"><span class="string">        lineStyle: &#123;</span></span><br><span class="line"><span class="string">            width: 0</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        showSymbol: false,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          opacity: 1,</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">          &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        areaStyle: &#123;</span></span><br><span class="line"><span class="string">          opacity: 1,</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;, &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;monthValueArr&#125;</span>,</span></span><br><span class="line"><span class="string">        markLine: &#123;</span></span><br><span class="line"><span class="string">          data: [&#123;</span></span><br><span class="line"><span class="string">            name: &#x27;平均值&#x27;,</span></span><br><span class="line"><span class="string">            type: &#x27;average&#x27;,</span></span><br><span class="line"><span class="string">            label: &#123;</span></span><br><span class="line"><span class="string">              color: color</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;]</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    postsChart.setOption(postsOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      postsChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    postsChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if (event.componentType === &#x27;series&#x27;) window.location.href = &#x27;/archives/&#x27; + event.name.replace(&#x27;-&#x27;, &#x27;/&#x27;);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tagsChart</span> (len) &#123;</span><br><span class="line">  <span class="keyword">const</span> tagArr = []</span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;tags&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">tag</span>) &#123;</span><br><span class="line">    tagArr.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: tag.<span class="property">name</span>, <span class="attr">value</span>: tag.<span class="property">length</span>, <span class="attr">path</span>: tag.<span class="property">path</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  tagArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dataLength = <span class="title class_">Math</span>.<span class="title function_">min</span>(tagArr.<span class="property">length</span>, len) || tagArr.<span class="property">length</span></span><br><span class="line">  <span class="keyword">const</span> tagNameArr = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; dataLength; i++) &#123;</span><br><span class="line">    tagNameArr.<span class="title function_">push</span>(tagArr[i].<span class="property">name</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> tagNameArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(tagNameArr)</span><br><span class="line">  <span class="keyword">const</span> tagArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(tagArr)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;tagsChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var tagsChart = echarts.init(document.getElementById(&#x27;tags-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var tagsOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;Top <span class="subst">$&#123;dataLength&#125;</span> 标签统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;&#125;,</span></span><br><span class="line"><span class="string">      xAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;标签&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;category&#x27;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        grid: &#123;</span></span><br><span class="line"><span class="string">          lineHeight: 32</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color,</span></span><br><span class="line"><span class="string">          interval: 0,</span></span><br><span class="line"><span class="string">          formatter: function(value)&#123;</span></span><br><span class="line"><span class="string">            var res = &quot;&quot;;</span></span><br><span class="line"><span class="string">            var max_strlen = 5;</span></span><br><span class="line"><span class="string">            var strlen = 0;</span></span><br><span class="line"><span class="string">            for (var i = 0; i &lt; value.length; i++) &#123;</span></span><br><span class="line"><span class="string">                if (value.charCodeAt(i) &gt; 255)</span></span><br><span class="line"><span class="string">                    strlen++;</span></span><br><span class="line"><span class="string">                else</span></span><br><span class="line"><span class="string">                    strlen+=0.8;</span></span><br><span class="line"><span class="string">                if (strlen&gt;max_strlen)&#123;</span></span><br><span class="line"><span class="string">                  res+=&quot;\\n&quot;</span></span><br><span class="line"><span class="string">                  strlen=0;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                res+=value.charAt(i);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            return res;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">      // rotate: 40,</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;tagNameArrJson&#125;</span></span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      yAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;value&#x27;,</span></span><br><span class="line"><span class="string">        splitLine: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: [&#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;bar&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;tagArrJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          borderRadius: [5, 5, 0, 0],</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">          &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        emphasis: &#123;</span></span><br><span class="line"><span class="string">          itemStyle: &#123;</span></span><br><span class="line"><span class="string">            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">              offset: 0,</span></span><br><span class="line"><span class="string">              color: &#x27;rgba(128, 255, 195)&#x27;</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              offset: 1,</span></span><br><span class="line"><span class="string">              color: &#x27;rgba(1, 211, 255)&#x27;</span></span><br><span class="line"><span class="string">            &#125;])</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        markLine: &#123;</span></span><br><span class="line"><span class="string">          data: [&#123;</span></span><br><span class="line"><span class="string">            name: &#x27;平均值&#x27;,</span></span><br><span class="line"><span class="string">            type: &#x27;average&#x27;,</span></span><br><span class="line"><span class="string">            label: &#123;</span></span><br><span class="line"><span class="string">              color: color</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;]</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    tagsChart.setOption(tagsOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      tagsChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    tagsChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if(event.data.path) window.location.href = &#x27;/&#x27; + event.data.path;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">categoriesChart</span> (dataParent) &#123;</span><br><span class="line">  <span class="keyword">const</span> categoryArr = []</span><br><span class="line">  <span class="keyword">let</span> categoryParentFlag = <span class="literal">false</span></span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;categories&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">category</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (category.<span class="property">parent</span>) categoryParentFlag = <span class="literal">true</span></span><br><span class="line">    categoryArr.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: category.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">value</span>: category.<span class="property">length</span>,</span><br><span class="line">      <span class="attr">path</span>: category.<span class="property">path</span>,</span><br><span class="line">      <span class="attr">id</span>: category.<span class="property">_id</span>,</span><br><span class="line">      <span class="attr">parentId</span>: category.<span class="property">parent</span> || <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  categoryParentFlag = categoryParentFlag &amp;&amp; dataParent === <span class="string">&#x27;true&#x27;</span></span><br><span class="line">  categoryArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">translateListToTree</span> (data, parent) &#123;</span><br><span class="line">    <span class="keyword">let</span> tree = []</span><br><span class="line">    <span class="keyword">let</span> temp</span><br><span class="line">    data.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (data[index].<span class="property">parentId</span> == parent) &#123;</span><br><span class="line">        <span class="keyword">let</span> obj = data[index];</span><br><span class="line">        temp = <span class="title function_">translateListToTree</span>(data, data[index].<span class="property">id</span>);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          obj.<span class="property">children</span> = temp</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tree.<span class="title function_">indexOf</span>())</span><br><span class="line">          tree.<span class="title function_">push</span>(obj)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> tree</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> categoryNameJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(categoryArr.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">category</span>) &#123; <span class="keyword">return</span> category.<span class="property">name</span> &#125;))</span><br><span class="line">  <span class="keyword">const</span> categoryArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(categoryArr)</span><br><span class="line">  <span class="keyword">const</span> categoryArrParentJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">translateListToTree</span>(categoryArr, <span class="string">&#x27;0&#x27;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;categoriesChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var categoriesChart = echarts.init(document.getElementById(&#x27;categories-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var categoryParentFlag = <span class="subst">$&#123;categoryParentFlag&#125;</span></span></span><br><span class="line"><span class="string">    var categoriesOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;文章分类统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      legend: &#123;</span></span><br><span class="line"><span class="string">        top: &#x27;bottom&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryNameJson&#125;</span>,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;</span></span><br><span class="line"><span class="string">        trigger: &#x27;item&#x27;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: []</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    categoriesOption.series.push(</span></span><br><span class="line"><span class="string">      categoryParentFlag ? </span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        nodeClick :false,</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;sunburst&#x27;,</span></span><br><span class="line"><span class="string">        radius: [&#x27;15%&#x27;, &#x27;90%&#x27;],</span></span><br><span class="line"><span class="string">        center: [&#x27;50%&#x27;, &#x27;55%&#x27;],</span></span><br><span class="line"><span class="string">        sort: &#x27;desc&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryArrParentJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          borderColor: &#x27;#fff&#x27;,</span></span><br><span class="line"><span class="string">          borderWidth: 2,</span></span><br><span class="line"><span class="string">          emphasis: &#123;</span></span><br><span class="line"><span class="string">            focus: &#x27;ancestor&#x27;,</span></span><br><span class="line"><span class="string">            shadowBlur: 10,</span></span><br><span class="line"><span class="string">            shadowOffsetX: 0,</span></span><br><span class="line"><span class="string">            shadowColor: &#x27;rgba(255, 255, 255, 0.5)&#x27;</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">      :</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;pie&#x27;,</span></span><br><span class="line"><span class="string">        radius: [30, 80],</span></span><br><span class="line"><span class="string">        roseType: &#x27;area&#x27;,</span></span><br><span class="line"><span class="string">        label: &#123;</span></span><br><span class="line"><span class="string">          color: color,</span></span><br><span class="line"><span class="string">          formatter: &#x27;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&#x27;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryArrJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          emphasis: &#123;</span></span><br><span class="line"><span class="string">            shadowBlur: 10,</span></span><br><span class="line"><span class="string">            shadowOffsetX: 0,</span></span><br><span class="line"><span class="string">            shadowColor: &#x27;rgba(255, 255, 255, 0.5)&#x27;</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    categoriesChart.setOption(categoriesOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      categoriesChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    categoriesChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if(event.data.path) window.location.href = &#x27;/&#x27; + event.data.path;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>.md文件</code>使用：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章发布时间统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;posts-chart&quot;</span> <span class="attr">data-start</span>=<span class="string">&quot;2022-07&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;margin-top:30px&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章标签统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;tags-chart&quot;</span> <span class="attr">data-length</span>=<span class="string">&quot;10&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章分类统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;categories-chart&quot;</span> <span class="attr">data-parent</span>=<span class="string">&quot;true&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;margin-top:30px&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>为了适配我的长标签，我在在<code>标签统计图</code>中添加了以下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">formatter</span>: <span class="keyword">function</span>(<span class="params">value</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">var</span> max_strlen = <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">var</span> strlen = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; value.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (value.<span class="title function_">charCodeAt</span>(i) &gt; <span class="number">255</span>)</span><br><span class="line">                    strlen++;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    strlen+=<span class="number">0.8</span>;</span><br><span class="line">                <span class="keyword">if</span> (strlen&gt;max_strlen)&#123;</span><br><span class="line">                  res+=<span class="string">&quot;\\n&quot;</span></span><br><span class="line">                  strlen=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                res+=value.<span class="title function_">charAt</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure><p>效果如图：</p><p><img src="/../img/b20a/1661863365054.png" alt="文章统计图"></p><h2 id="美化Twikoo"><a href="#美化Twikoo" class="headerlink" title="美化Twikoo"></a>美化Twikoo</h2><p>点击评论系统的输入框会出现提示：</p><p><img src="/../img/b20a/1663208091131.png" alt="友好提示"></p><p>css代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Twikoo评论系统样式 */</span></span><br><span class="line"><span class="comment">/* 设置文字内容 :nth-child(1)的作用是选择第几个 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;输入QQ号会自动获取昵称和头像🐧&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;收到回复将会发送到您的邮箱📧&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;可以通过昵称访问您的网站🔗&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当用户点击输入框时显示 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:focus</span>-within<span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:focus</span>-within<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 主内容区 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="comment">/* 先隐藏起来 */</span></span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="comment">/* 绝对定位 */</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="comment">/* 向上移动60像素 */</span></span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">60px</span>;</span><br><span class="line">    <span class="comment">/* 文字强制不换行，防止left:50%导致的文字换行 */</span></span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="comment">/* 圆角 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="comment">/* 距离左边50% */</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="comment">/* 然后再向左边挪动自身的一半，即可实现居中 */</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>);</span><br><span class="line">    <span class="comment">/* 填充 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">14px</span> <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#444</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 小角标 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="comment">/* 内容大小（宽高）为0且边框大小不为0的情况下，每一条边（4个边）都是一个三角形，组成一个正方形。</span></span><br><span class="line"><span class="comment">    我们先将所有边框透明，再给其中的一条边添加颜色就可以实现小三角图标 */</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">12px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-top-color</span>: <span class="number">#444</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">48px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>世界上最先进的开源关系型数据库——PostgreSql常用命令</title>
      <link href="/posts/394e/"/>
      <url>/posts/394e/</url>
      
        <content type="html"><![CDATA[<h3 id="用户操作命令"><a href="#用户操作命令" class="headerlink" title="用户操作命令"></a>用户操作命令</h3><h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p>1、指定参数登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql -U username -d database_name -h host -W</span><br></pre></td></tr></table></figure><blockquote><p>参数含义: <code>-U</code>指定用户 <code>-d</code>要连接的数据库 <code>-h</code>要连接的主机 <code>-W</code>提示输入密码。</p></blockquote><p>2、使用<code>postgres</code>同名用户后登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su username</span><br><span class="line">psql</span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>当不指定参数时<code>psql</code>使用操作系统当前用户的用户名作为postgres的登录用户名和要连接的数据库名。所以在PostgreSQL安装完成后可以通过以上方式登录。</p></blockquote><h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - postgres </span><br><span class="line">psql</span><br><span class="line">\password postgres</span><br></pre></td></tr></table></figure><h4 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h4><p>1、系统命令行创建</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createuser username </span><br></pre></td></tr></table></figure><p>2、PostgresSQL命令行创建（使用CREATE ROLE）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE rolename;</span><br></pre></td></tr></table></figure><p>3、PostgresSQL命令行创建（使用CREATE USER）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER testuser WITH PASSWORD &#x27;testuser&#x27;;</span><br></pre></td></tr></table></figure><blockquote><p><code>CREATE USER</code>和<code>CREATE ROLE</code>的区别在于，<code>CREATE USER</code>指令创建的用户默认是有登录权限的，而<code>CREATE ROLE</code>没有。</p></blockquote><h3 id="允许远程访问"><a href="#允许远程访问" class="headerlink" title="允许远程访问"></a>允许远程访问</h3><p>在<code>pg_hba.conf</code>添加以下命令，配置用户的访问权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># TYPE  DATABASE    USER    ADDRESS       METHOD</span><br><span class="line">local      all       all                    trust</span><br><span class="line">host      all       all    0.0.0.0/0        trust</span><br></pre></td></tr></table></figure><p>在<code>postgresql.conf</code>添加以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">listen_addresses = &#x27;*&#x27;</span><br><span class="line">port=5432</span><br><span class="line">logging_collector = on</span><br><span class="line">log_directory = &#x27;pg_log&#x27;</span><br><span class="line">log_filename = &#x27;postgresql-%a.log&#x27;</span><br></pre></td></tr></table></figure><h3 id="数据库操作命令"><a href="#数据库操作命令" class="headerlink" title="数据库操作命令"></a>数据库操作命令</h3><h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE testuser_1 OWNER testuser;</span><br></pre></td></tr></table></figure><h4 id="切换数据库"><a href="#切换数据库" class="headerlink" title="切换数据库"></a>切换数据库</h4><p>相当于mysql的use dbname</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\c dbname</span><br></pre></td></tr></table></figure><h4 id="列举数据库"><a href="#列举数据库" class="headerlink" title="列举数据库"></a>列举数据库</h4><p>相当于mysql的show databases</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\l</span><br></pre></td></tr></table></figure><h4 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database [数据库名];</span><br></pre></td></tr></table></figure><h4 id="列举表"><a href="#列举表" class="headerlink" title="列举表"></a>列举表</h4><p>相当于mysql的show tables</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\dt</span><br></pre></td></tr></table></figure><h4 id="查看表结构"><a href="#查看表结构" class="headerlink" title="查看表结构"></a>查看表结构</h4><p>相当于desc tblname,show columns from tbname</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\d tblname</span><br></pre></td></tr></table></figure><h4 id="查看索引"><a href="#查看索引" class="headerlink" title="查看索引"></a>查看索引</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\di</span><br></pre></td></tr></table></figure><h3 id="表操作命令"><a href="#表操作命令" class="headerlink" title="表操作命令"></a>表操作命令</h3><h4 id="重命名一个表"><a href="#重命名一个表" class="headerlink" title="重命名一个表"></a>重命名一个表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名A] rename to [表名B]; </span><br></pre></td></tr></table></figure><h4 id="删除一个表"><a href="#删除一个表" class="headerlink" title="删除一个表"></a>删除一个表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table [表名]; </span><br></pre></td></tr></table></figure><h4 id="在已有的表里添加字段"><a href="#在已有的表里添加字段" class="headerlink" title="在已有的表里添加字段"></a>在已有的表里添加字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] add column [字段名] [类型]; </span><br></pre></td></tr></table></figure><h4 id="删除表中的字段"><a href="#删除表中的字段" class="headerlink" title="删除表中的字段"></a>删除表中的字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] drop column [字段名]; </span><br></pre></td></tr></table></figure><h4 id="重命名一个字段"><a href="#重命名一个字段" class="headerlink" title="重命名一个字段"></a>重命名一个字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] rename column [字段名A] to [字段名B]; </span><br></pre></td></tr></table></figure><h4 id="给一个字段设置缺省值"><a href="#给一个字段设置缺省值" class="headerlink" title="给一个字段设置缺省值"></a>给一个字段设置缺省值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] alter column [字段名] set default [新的默认值];</span><br></pre></td></tr></table></figure><h4 id="去除缺省值"><a href="#去除缺省值" class="headerlink" title="去除缺省值"></a>去除缺省值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] alter column [字段名] drop default; </span><br></pre></td></tr></table></figure><h4 id="在表中插入数据"><a href="#在表中插入数据" class="headerlink" title="在表中插入数据"></a>在表中插入数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名 ([字段名m],[字段名n],......) values ([列m的值],[列n的值],......); </span><br></pre></td></tr></table></figure><h4 id="修改表中的某行某列的数据"><a href="#修改表中的某行某列的数据" class="headerlink" title="修改表中的某行某列的数据"></a>修改表中的某行某列的数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update [表名] set [目标字段名]=[目标值] where [该行特征]; </span><br></pre></td></tr></table></figure><h4 id="删除表中某行数据"><a href="#删除表中某行数据" class="headerlink" title="删除表中某行数据"></a>删除表中某行数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from [表名] where [该行特征]; </span><br><span class="line">delete from [表名];--删空整个表 </span><br></pre></td></tr></table></figure><h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table ([字段名1] [类型1] ;,[字段名2] [类型2],......&lt;,primary key (字段名m,字段名n,...)&gt;;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PostgreSql使用命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>世界上最先进的开源关系型数据库——PostgreSql安装教程</title>
      <link href="/posts/71b1/"/>
      <url>/posts/71b1/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>PostgreSQL </code>是一个免费的对象-关系数据库服务器(ORDBMS)，在灵活的BSD许可证下发行。</p><p><code>PostgreSQL</code> 的 Slogan 是 “世界上最先进的开源关系型数据库”。</p><p>本次安装选择二进制源码包编译安装</p><p>服务器操作系统为<code>Centos7.6</code>，PostgreSql安装版本为<code>14.0</code></p><h2 id="安装包下载"><a href="#安装包下载" class="headerlink" title="安装包下载"></a>安装包下载</h2><p>在官网源码包选择<code>14.0</code>版本下载，下载地址：<a href="https://www.postgresql.org/ftp/source/">PostgreSQL: File Browser</a></p><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="下载环境依赖"><a href="#下载环境依赖" class="headerlink" title="下载环境依赖"></a>下载环境依赖</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y cmake make gcc zlib zlib-devel gcc-c++ perl readline readline-devel  python36 tcl openssl ncurses-devel openldap pam flex</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>如果出现<code>File “/usr/bin/yum“, line 30 except KeyboardInterrupt, e:</code>这类错误，多半yum命令的python环境发生改变了，需要改回来：</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/bin</span><br><span class="line">rm -rf python</span><br><span class="line">ln -s python2.7 python</span><br></pre></td></tr></table></figure><h3 id="创建postgre用户"><a href="#创建postgre用户" class="headerlink" title="创建postgre用户"></a>创建postgre用户</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd postgres</span><br><span class="line">adduser -g postgres postgres </span><br></pre></td></tr></table></figure><h3 id="修改用户密码"><a href="#修改用户密码" class="headerlink" title="修改用户密码"></a>修改用户密码</h3><p>此处修改密码即修改登录用户密码（如果你使用postgres作为登录用户的话）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd postgres</span><br></pre></td></tr></table></figure><p>如果使用弱密码方便登录时，可执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;123&quot; | passwd --stdin postgres</span><br></pre></td></tr></table></figure><h3 id="创建用户目录并授权"><a href="#创建用户目录并授权" class="headerlink" title="创建用户目录并授权"></a>创建用户目录并授权</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/postgres;</span><br><span class="line">chmod -R 775 /home/postgres;</span><br><span class="line">chown -R postgres:postgres /home/postgres;</span><br></pre></td></tr></table></figure><h3 id="开放防火墙端口"><a href="#开放防火墙端口" class="headerlink" title="开放防火墙端口"></a>开放防火墙端口</h3><p>默认<code>5432</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=5432/tcp --permanent;</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="修改操作系统打开最大文件句柄数"><a href="#修改操作系统打开最大文件句柄数" class="headerlink" title="修改操作系统打开最大文件句柄数"></a>修改操作系统打开最大文件句柄数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;postgres soft   nofile         65535&quot; &gt;&gt; /etc/security/limits.conf</span><br><span class="line">echo &quot;postgres hard   nofile        65535&quot; &gt;&gt; /etc/security/limits.conf</span><br></pre></td></tr></table></figure><p>重新登陆后，执行以下命令会出现65535 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su postgres</span><br><span class="line">ulimit -n</span><br></pre></td></tr></table></figure><h3 id="创建数据库目录"><a href="#创建数据库目录" class="headerlink" title="创建数据库目录"></a>创建数据库目录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/postgres/&#123;postgre14,pgdata&#125;</span><br></pre></td></tr></table></figure><h2 id="编译并安装"><a href="#编译并安装" class="headerlink" title="编译并安装"></a>编译并安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su - postgres</span><br><span class="line">tar -xzvf ./postgresql-14.0.tar.gz -C /home/postgres</span><br><span class="line">cd  /home/postgres/postgresql-14.0</span><br><span class="line">./configure --prefix=/home/postgres/postgre14</span><br><span class="line">make  &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt;  ~/.bash_profile &lt;&lt;&quot;EOF&quot;</span><br><span class="line">export PGPORT=5432</span><br><span class="line">export PGDATA=/home/postgres/pgdata</span><br><span class="line">export PGHOME=/home/postgres/postgre14</span><br><span class="line">export LD_LIBRARY_PATH=$PGHOME/lib:$LD_LIBRARY_PATH</span><br><span class="line">export PATH=$PGHOME/bin:$PATH:.</span><br><span class="line">EOF</span><br><span class="line">source  ~/.bash_profile</span><br></pre></td></tr></table></figure><h2 id="数据库及参数初始化"><a href="#数据库及参数初始化" class="headerlink" title="数据库及参数初始化"></a>数据库及参数初始化</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/postgres/postgre14/bin/initdb -D $PGDATA  -E UTF8 --locale=en_US.utf8 -U postgres</span><br></pre></td></tr></table></figure><blockquote><p>指定<code>-D</code>数据目录，<code>-E</code>字符编码， <code>--locale</code>本及语言环境，<code>-U</code>初始化用户信息。</p></blockquote><h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt; /home/postgres/pgdata/postgresql.conf &lt;&lt;&quot;EOF&quot;</span><br><span class="line">listen_addresses = &#x27;*&#x27;</span><br><span class="line">port=5432</span><br><span class="line">logging_collector = on</span><br><span class="line">log_directory = &#x27;pg_log&#x27;</span><br><span class="line">log_filename = &#x27;postgresql-%a.log&#x27;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><ul><li><code>listen_addresses</code> 表示postgre进程监听的网卡地址，配置<code>*</code>表示监听所有。</li><li><code>port</code>服务监听端口配置</li><li><code>logging_collector=on</code>，启动日志收集器</li><li><code>log_directory</code> 表示日志文件在PGDATA目录下的文件夹位置。</li><li><code>log_filename</code>表示日志文件的名称</li></ul><h3 id="配置访问权限"><a href="#配置访问权限" class="headerlink" title="配置访问权限"></a>配置访问权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat   &gt; /home/postgres/pgdata/pg_hba.conf &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TYPE  DATABASE    USER    ADDRESS       METHOD</span></span><br><span class="line">local      all       all                    trust</span><br><span class="line">host      all       all    0.0.0.0/0        md5</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h2 id="启动数据库新建用户"><a href="#启动数据库新建用户" class="headerlink" title="启动数据库新建用户"></a>启动数据库新建用户</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动命令</span></span><br><span class="line">pg_ctl start</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启命令</span></span><br><span class="line">pg_ctl restart</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看数据库运行状态</span></span><br><span class="line">pg_ctl status</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">停止数据库</span></span><br><span class="line">pg_ctl stop</span><br></pre></td></tr></table></figure><h3 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h3><p>进入postgresql命令行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql</span><br></pre></td></tr></table></figure><p>新建用户postgres</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter user postgres with password &#x27;password&#x27;;</span><br></pre></td></tr></table></figure><p>一般来说，我们的程序在运行过程中，不会直接使用postgres用户，而是新建一个用户。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建一个用户 acai</span></span><br><span class="line">CREATE USER acai WITH password &#x27;密码&#x27;;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建一个数据库acaidb，属主是acai</span></span><br><span class="line">CREATE DATABASE acaidb OWNER acai;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">为用户acai赋权，all表示所有权限，acaidb的管理用户</span></span><br><span class="line">GRANT all ON  DATABASE acaidb TO acai; </span><br></pre></td></tr></table></figure><p>实际上在生产环境中，我们需要创建两个用户，一个数据库管理用户用于管理表、视图等操作；另一个是程序用户，用于操作数据库表里面的数据，完成增删改查。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER acaiuser WITH password &#x27;*******&#x27;;</span><br><span class="line">GRANT  update,delete,insert,select  ON  ALL TABLES IN SCHEMA public TO acaiuser;</span><br></pre></td></tr></table></figure><h2 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/systemd/system/postgre14.service &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[Unit]</span><br><span class="line">Description=PostgreSQL database server 14.4</span><br><span class="line">Documentation=man:postgres(1)</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">User=postgres</span><br><span class="line">Group=postgres</span><br><span class="line"></span><br><span class="line">Environment=PGPORT=5432</span><br><span class="line">Environment=PGDATA=/home/postgres/pgdata</span><br><span class="line"></span><br><span class="line">ExecStart=/home/postgres/postgre14/bin/pg_ctl start -D $&#123;PGDATA&#125; -s -o &quot;-p $&#123;PGPORT&#125;&quot; -w -t 300</span><br><span class="line">ExecStop=/home/postgres/postgre14/bin/pg_ctl stop -D $&#123;PGDATA&#125; -s -m fast</span><br><span class="line">ExecReload=/home/postgres/postgre14/bin/pg_ctl reload -D $&#123;PGDATA&#125; -s</span><br><span class="line"></span><br><span class="line">KillMode=mixed</span><br><span class="line">KillSignal=SIGINT</span><br><span class="line">TimeoutSec=120</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>执行下列命令，使得PostgreSQL数据库开机自启动脚本生效。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl enable postgre14</span><br></pre></td></tr></table></figure><p>后续再启停数据库，查看数据库状态，就可以使用下面的这些命令了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start postgre14</span><br><span class="line">systemctl stop postgre14</span><br><span class="line">systemctl status postgre14</span><br></pre></td></tr></table></figure><h2 id="原文连接"><a href="#原文连接" class="headerlink" title="原文连接"></a>原文连接</h2><p><a href="https://zimug.blog.csdn.net/article/details/126530028">PostgreSql生产级别数据库安装要考虑哪些问题？</a></p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PostgreSql安装教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx功能之自动化封禁ip</title>
      <link href="/posts/7e+25/"/>
      <url>/posts/7e+25/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在日常业务场景中可能存在恶意用户频繁访问系统，占用系统资源，影响正常用户访问，我们有许多方案杜绝此类问题发生，例如增加验证码，应用内限制访问次数，网关ip封禁等等。本次介绍如何利用Nginx和shell脚本自动化封禁访问ip。</p><h2 id="Nginx封禁ip或ip段"><a href="#Nginx封禁ip或ip段" class="headerlink" title="Nginx封禁ip或ip段"></a>Nginx封禁ip或ip段</h2><p>封禁ip&#x2F;ip段语法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deny <span class="number">1.2</span>.<span class="number">3.4</span>;</span><br><span class="line">deny <span class="number">91.212</span>.<span class="number">45.0</span>/<span class="number">24</span>;</span><br></pre></td></tr></table></figure><p>允许ip&#x2F;ip段语法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow <span class="number">1.2</span>.<span class="number">3.4</span>;</span><br><span class="line">allow <span class="number">91.212</span>.<span class="number">45.0</span>/<span class="number">24</span>;</span><br></pre></td></tr></table></figure><p>新建<code>/usr/local/nginx/conf/vhosts/blockip.conf</code>，将封禁ip&#x2F;ip段的语句放入到<code>blockip.conf</code></p><p>根据放入的语句块实现封禁ip的范围：</p><ul><li><code>include vhosts/blockip.conf</code>放在<code>server</code>语句块，则单独封禁某个网站</li><li><code>include vhosts/blockip.conf</code>放在<code>http</code>语句块，则封禁所有网站</li></ul><p>记得在<code>nginx.conf</code>导入<code>blockip.conf</code>：</p><p><img src="/../img/7e25/1661746398969.png" alt="禁用ip配置"></p><h2 id="shell脚本自动化封禁ip"><a href="#shell脚本自动化封禁ip" class="headerlink" title="shell脚本自动化封禁ip"></a>shell脚本自动化封禁ip</h2><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>AWK 是一种处理文本文件的语言，是一个强大的文本分析工具。后面会详细介绍。</p><p>自动化封禁ip的思路：</p><p>1、统计访问日志的ip并去重排序</p><p>2、计算超过特定访问速率（每分钟60次）的ip</p><p>3、将ip记录在<code>vhosts/blockip.conf</code>并灰度发布</p><p>4、<code>crontab</code>定时运行脚本</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">统计access.log</button></li><li class="tab"><button type="button" data-href="#tab-1-2">去重和排序</button></li><li class="tab"><button type="button" data-href="#tab-1-3">计算超过特定访问速率（每分钟60次）的ip</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log</span><br></pre></td></tr></table></figure><p><img src="/../img/7e25/1661744930619.png" alt="统计access.log"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd</span><br></pre></td></tr></table></figure><p><img src="/../img/7e25/1661745475818.png" alt="去重和排序"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd | awk &#x27;&#123;if($1&gt;)print $0&#125;&#x27;</span><br></pre></td></tr></table></figure><p><img src="/../img/7e25/1661745645628.png" alt="计算超过特定访问速率（每分钟60次）的ip"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="编写shell脚本"><a href="#编写shell脚本" class="headerlink" title="编写shell脚本"></a>编写shell脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">不能把别人IP一直封着吧，这里就清除掉了</span></span><br><span class="line">echo &quot;&quot; &gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">前面最开始编写的统计数据功能</span></span><br><span class="line">ip_list=$(awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd | awk &#x27;&#123;if($1&gt;60)print $0&#125;&#x27;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">获取当前时间</span></span><br><span class="line">starttime=$(date +%Y-%m-%d\ %H:%M:%S)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">判断这个变量是否为空</span></span><br><span class="line">if test -z &quot;$ip_list&quot;</span><br><span class="line">then</span><br><span class="line">        #为空写入 blockip.log中，并重新启动ngnix</span><br><span class="line">        echo &quot;$starttime 暂无封禁ip&quot;  &gt;&gt; /usr/local/nginx/logs/blockip.log</span><br><span class="line"></span><br><span class="line">        /usr/bin/nginx -s reload</span><br><span class="line">else</span><br><span class="line">        #如果不为空 前面加上 deny格式和ip写入blockip.conf中</span><br><span class="line">        echo &quot;deny&quot; $ip_list &gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"></span><br><span class="line">        #因为前面携带了行数，所有我们需要去除掉前面的行数，写入后在读取一次</span><br><span class="line">        ip_list2=$(awk &#x27;&#123;print $3&#125;&#x27; /usr/local/nginx/conf/vhosts/blockip.conf)</span><br><span class="line"></span><br><span class="line">        #最后再把读取出来的值，在次写入到blockip.conf中</span><br><span class="line">        echo &quot;deny&quot; $ip_list2&quot;;&quot;&gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"></span><br><span class="line">        #重启ngnix</span><br><span class="line">        /usr/bin/nginx -s reload</span><br><span class="line">        #清空之前的日志，从最新的开始截取</span><br><span class="line">        echo &quot;&quot; &gt; /usr/local/nginx/logs/access.log</span><br><span class="line"></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">记录封禁ip</span></span><br><span class="line">echo &quot;$starttime 封禁ip $ip_list2&quot;  &gt;&gt; /usr/local/nginx/logs/blockip.log</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="crontab定时运行脚本"><a href="#crontab定时运行脚本" class="headerlink" title="crontab定时运行脚本"></a>crontab定时运行脚本</h3><p>编辑<code>/etc/crontab</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * root /usr/bin/sh /usr/local/nginx/shell/blockip.sh</span><br></pre></td></tr></table></figure><p><code>* * * * *</code>表示每分钟运行一次</p><p><code>root</code>表示运行用户</p><p><code>/usr/bin/sh</code>表示运行程序</p><p><code>/usr/local/nginx/shell/blockip.sh</code>表示运行脚本</p><p><img src="/../img/7e25/1661746148387.png" alt="crontab定时运行脚本"></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>为了更快达到效果，博主将访问次数改为20次</p><p><img src="/../img/7e25/20220829222224.gif" alt="封禁ip效果"></p><div class="note info flat"><p>如果想调整每分钟的访问次数，请修改shell脚本</p><p>如果想调整定时任务的间隔时间，请参考cron表达式，修改<code>/etc/crontab</code></p></div>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx自动化封禁ip </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQ消息推送机器人Qmsg私有化部署</title>
      <link href="/posts/7b50/"/>
      <url>/posts/7b50/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>引用官网的介绍</p><p>Qmsg酱是一个QQ消息推送机器人，用来通知自己消息的免费服务。通过调用API接口，实现机器人给你的QQ发送消息的功能。通俗易懂点就是有什么重要通知需要及时知道，可以让Qmsg酱第一时间给你发QQ消息。</p><p>公共版有许多限制，只能发送30条消息&#x2F;天，私有部署就没有限制</p><p>前提：得有服务器挂着机器人，服务器已安装jdk1.8</p><p>部署步骤：</p><h2 id="配置机器人"><a href="#配置机器人" class="headerlink" title="配置机器人"></a>配置机器人</h2><p>添加管理台QQ列表：</p><p><img src="/../img/7b50/1661657344765.png" alt="管理台QQ列表"></p><p>这里添加的是机器人发送消息的对象，如果没有添加，则机器人会发送不了消息：</p><p><img src="/../img/7b50/1661658096176.png" alt="管理台没有添加QQ群"></p><p>到<a href="https://qmsg.zendee.cn/user">管理台</a>添加机器人QQ、选择新添加的机器人QQ，点击进入设置，如下图所示步骤：</p><p><img src="/../img/7b50/1661653470790.png" alt="添加机器人QQ"></p><p>如果需要发送图片或者json数据可在机器人设置开启：</p><p><img src="/../img/7b50/1661654262017.png" alt="开启发送图片"></p><p>拉机器人进群，在设置中配置群授权：</p><p><img src="/../img/7b50/1661654338823.png" alt="配置群授权"></p><div class="note info modern"><p>记得保存配置</p></div><h2 id="触发关键词回调URL"><a href="#触发关键词回调URL" class="headerlink" title="触发关键词回调URL"></a>触发关键词回调URL</h2><p><img src="/../img/7b50/1661656275005.png" alt="触发关键词回调URL"></p><p>什么意思呢，就是你在群里（或私发）发送的消息包含关键词时，机器人向设置的url会发送一个post请求。</p><div class="note warning modern"><p>回调URL不能是Qmsg酱的推送接口</p><p><img src="/../img/7b50/1661657952953.png" alt="回调URL不能是Qmsg酱的推送接口"></p></div><p>Key可在<a href="https://qmsg.zendee.cn/user">管理台</a>查询，可根据需要添加QQ号或者QQ群：</p><p><img src="/../img/7b50/1661654109524.png" alt="添加QQ号或者QQ群"></p><h2 id="下载机器人程序"><a href="#下载机器人程序" class="headerlink" title="下载机器人程序"></a>下载机器人程序</h2><p>登录<a href="https://qmsg.zendee.cn/">官网</a>，到<a href="https://qmsg.zendee.cn/pvt">捐赠版页面</a>下载机器人程序</p><h2 id="运行机器人程序"><a href="#运行机器人程序" class="headerlink" title="运行机器人程序"></a>运行机器人程序</h2><p>使用Xftp上传jar到服务器</p><p><img src="/../img/7b50/1661652668986.png" alt="上传jar到服务器"></p><p>运行jar包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar QmsgClient2.1.jar &quot;-noUIQQ账号|QQ密码|0&quot;</span><br></pre></td></tr></table></figure><p>登录验证说明：</p><p>如果登录遇到滑块验证，请下载<a href="https://www.yuque.com/icecreamqaq/api/use-ten-cap">滑块助手</a>。Linux平台需要复制控制台输出的PID粘贴到滑块助手中然后提交验证。</p><p>绑定手机号的QQ需要输入验证码</p><p>完成后出现以下画面：</p><p><img src="/../img/7b50/1661653369002.png" alt="输入验证码"></p><p>部署成功</p><h2 id="测试机器人程序"><a href="#测试机器人程序" class="headerlink" title="测试机器人程序"></a>测试机器人程序</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">测试群发</button></li><li class="tab"><button type="button" data-href="#tab-1-2">测试私发</button></li><li class="tab"><button type="button" data-href="#tab-1-3">测试发送图片消息</button></li><li class="tab"><button type="button" data-href="#tab-1-4">测试发送表情</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?msg=测试<span class="number">1</span>&amp;<span class="built_in">group</span>=qq群号</span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/../img/7b50/1661656861317.png" alt="测试群发消息"></p><p><img src="/../img/7b50/1661656929576.png" alt="测试群发消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/send/key?msg=测试</span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/../img/7b50/1661657125323.png" alt="测试私发消息"></p><p><img src="/../img/7b50/1661657139011.png" alt="测试私发消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?<span class="built_in">group</span>=<span class="number">798267095</span>&amp;msg=今日壁纸：@image=https://bing.panghai.top/php/today.php<span class="selector-tag">@</span></span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/../img/7b50/1661657258810.png" alt="测试发送图片消息"></p><p><img src="/../img/7b50/1661657284483.png" alt="测试发送图片消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?msg=发送表情@face=<span class="number">0</span><span class="selector-tag">@</span>&amp;<span class="built_in">group</span>=<span class="number">798267095</span></span><br></pre></td></tr></table></figure><p>更多表情：<a href="https://hub.fastgit.org/kyubotics/coolq-http-api/wiki/%E8%A1%A8%E6%83%85-CQ-%E7%A0%81-ID-%E8%A1%A8">点击这里</a></p><p>测试结果：</p><p><img src="/../img/7b50/1661659416963.png" alt="测试发送表情"></p><p><img src="/../img/7b50/1661659453952.png" alt="测试发送表情"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="机器人后台运行"><a href="#机器人后台运行" class="headerlink" title="机器人后台运行"></a>机器人后台运行</h2><p>由于Linux系统控制台窗口关闭就会导致当前程序结束，所以在第一次登陆成功后，可以将窗口关闭，然后使用nohup命令后台启动机器人。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java <span class="literal">-jar</span> QmsgClient2.<span class="number">1</span>.jar &gt; Qmsg.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> Qmsg私有部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>静态网站评论系统Twikoo私有化部署</title>
      <link href="/posts/3f0b/"/>
      <url>/posts/3f0b/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Twikoo是一个简洁、安全、免费的静态网站评论系统，支持邮件、QQ提醒、微信提醒，访客在昵称栏输入 QQ 号，会自动补全 QQ 昵称和 QQ 邮箱，免费搭建，简单部署。</p><h2 id="私有部署"><a href="#私有部署" class="headerlink" title="私有部署"></a>私有部署</h2><h3 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">if ! type node &gt;/dev/null 2&gt;&amp;1; then</span><br><span class="line">  echo &#x27;node 已安装&#x27;</span><br><span class="line">else</span><br><span class="line">    echo &quot;----------------------------------start yum install node -----------------------------&quot;</span><br><span class="line">    wget https://cdn.npm.taobao.org/dist/node/latest-v16.x/node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">    tar -xvf node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">    mv node-v16.14.0-linux-x64 /usr/local/node</span><br><span class="line"></span><br><span class="line">    #删除配置文件中原有的环境变量</span><br><span class="line">    sed -ie &#x27;/NODE_HOME/d&#x27; /etc/profile</span><br><span class="line">    sed -ie &#x27;/cnpm/d&#x27; /etc/profile</span><br><span class="line"></span><br><span class="line">    #修改maven的环境变量，直接写入配置文件</span><br><span class="line">    echo &quot;export NODE_HOME=/usr/local/node&quot; &gt;&gt;/etc/profile</span><br><span class="line">    echo &quot;export PATH=\$NODE_HOME/bin:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line"></span><br><span class="line">    source /etc/profile</span><br><span class="line"></span><br><span class="line">    npm install -g cnpm -registry=https://registry.npm.taobao.org</span><br><span class="line">    echo &quot;export PATH=/usr/local/node/lib/node_moudles/cnpm/bin:$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">    source /etc/profile</span><br><span class="line">    npm config set registry https://registry.npm.taobao.org</span><br><span class="line">    npm install npm -g</span><br><span class="line">    source /etc/profile</span><br><span class="line">    node -v</span><br><span class="line">    npm -v</span><br><span class="line">    cnpm -v</span><br><span class="line">    echo &quot;----------------------------------yum install node success -----------------------------&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="安装Twikoo-server"><a href="#安装Twikoo-server" class="headerlink" title="安装Twikoo server"></a>安装Twikoo server</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g tkserver</span><br></pre></td></tr></table></figure><p>根据需要配置环境变量</p><table><thead><tr><th>名称</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td><code>TWIKOO_DATA</code></td><td>数据库存储路径</td><td><code>./data</code></td></tr><tr><td><code>TWIKOO_PORT</code></td><td>端口号</td><td><code>8080</code></td></tr><tr><td><code>TWIKOO_THROTTLE</code></td><td>IP 请求限流，当同一 IP 短时间内请求次数超过阈值将对该 IP 返回错误</td><td><code>250</code></td></tr></tbody></table><p>启动 Twikoo server: <code>tkserver</code></p><p>访问 <code>http://服务端IP:8080</code></p><p>若能正常访问，服务端地址（包含 <code>http://</code> 和端口号，例如 <code>http://12.34.56.78:8080</code>）即为您的环境 id</p><h2 id="修改Butterfly配置"><a href="#修改Butterfly配置" class="headerlink" title="修改Butterfly配置"></a>修改Butterfly配置</h2><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Twikoo</span></span><br><span class="line"><span class="comment"># https://github.com/imaegoo/twikoo</span></span><br><span class="line"><span class="attr">twikoo:</span></span><br><span class="line">  <span class="attr">envId:</span> <span class="string">https://twikoo.panghai.top/</span></span><br><span class="line">  <span class="attr">region:</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">option:</span></span><br></pre></td></tr></table></figure><p><code>envId</code>：即为上述的子域名</p><h2 id="配置Twikoo"><a href="#配置Twikoo" class="headerlink" title="配置Twikoo"></a>配置Twikoo</h2><p><code>hexo 三连</code>启动博客</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><p>进入任意评论页面，点击齿轮，twikoo默认第一个用户为管理员，注册密码后进入配置：</p><p><img src="/../img/3f0b/1661590346321.png" alt="Twikoo评论配置"></p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">通用配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">插件</button></li><li class="tab"><button type="button" data-href="#tab-1-3">隐私</button></li><li class="tab"><button type="button" data-href="#tab-1-4">反垃圾</button></li><li class="tab"><button type="button" data-href="#tab-1-5">即时通知</button></li><li class="tab"><button type="button" data-href="#tab-1-6">邮件通知</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/3f0b/1661590536869.png" alt="Twikoo通用配置"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>默认，没嫖到图床</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/../img/3f0b/1661590607097.png" alt="Twikoo隐私配置"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>默认，没人评论</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>Qmsg：<a href="https://qmsg.zendee.cn/">Qmsg酱-您的专属QQ消息推送服务小姐姐</a></p><p><img src="/../img/3f0b/1661590754939.png" alt="Twikoo即时通知"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p>因为博主使用的是域名邮箱，没有使用QQ邮箱，所以<code>SMTP_HOST</code>请不要照抄，详情参考：<a href="https://service.mail.qq.com/cgi-bin/help?subtype=1&&id=28&&no=331">如何使用IMAP服务？_QQ邮箱帮助中心</a></p><p><img src="/../img/3f0b/1661590843272.png" alt="Twikoo邮件通知"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="配置https"><a href="#配置https" class="headerlink" title="配置https"></a>配置https</h2><h3 id="添加解析"><a href="#添加解析" class="headerlink" title="添加解析"></a>添加解析</h3><p>前提要有域名，这里以<a href="https://console.cloud.tencent.com/cns">腾讯云域名解析</a>为例：</p><p><img src="/../img/3f0b/1661589489899.png" alt="添加解析"></p><h3 id="申请免费证书"><a href="#申请免费证书" class="headerlink" title="申请免费证书"></a>申请免费证书</h3><p>这里以腾讯云域名申请证书为例：</p><p><a href="https://console.cloud.tencent.com/ssl">腾讯云申请免费证书</a></p><p>这里绑定的是子域名</p><p><img src="/../img/3f0b/1661589047749.png" alt="申请免费证书"></p><p>验证域名后，等待签发，签发成功后是这样，点击下载：</p><p><img src="/../img/3f0b/1661589172142.png" alt="签发证书"></p><p>下载后解压出来有四个文件：</p><p><img src="/../img/3f0b/1661589265312.png" alt="证书文件"></p><p>只需要上传<code>twikoo.panghai.top_bundle.pem</code>和<code>twikoo.panghai.top.key</code>到服务器即可。</p><p>Nginx配置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  #监听twikoo.panghai.top</span><br><span class="line">  server &#123;</span><br><span class="line">      listen 80;</span><br><span class="line">      server_name twikoo.panghai.top;</span><br><span class="line">      return  301 https://$server_name$request_uri;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line">      listen       443 ssl;</span><br><span class="line">      ssl_certificate /etc/ssl/twikoo.panghai.top/twikoo.panghai.top.pem;</span><br><span class="line">      ssl_certificate_key /etc/ssl/twikoo.panghai.top/twikoo.panghai.top.key;</span><br><span class="line">      ssl_session_cache    shared:SSL:4m;</span><br><span class="line">      ssl_session_timeout  10m;</span><br><span class="line">      ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">      ssl_prefer_server_ciphers on;</span><br><span class="line">      server_name  twikoo.panghai.top;</span><br><span class="line">location /&#123;</span><br><span class="line">          proxy_pass http://127.0.0.1:8080/;</span><br><span class="line">          proxy_redirect off;</span><br><span class="line">          proxy_set_header Host $host;</span><br><span class="line">          proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">          proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>在本配置中，证书的位置在<code>/etc/ssl/twikoo.panghai.top</code>，请根据需要自行修改</p><p>访问<code>twikoo.panghai.top</code>：</p><p><img src="/../img/3f0b/1661589580603.png" alt="评论接口效果"></p><h2 id="添加自启动脚本"><a href="#添加自启动脚本" class="headerlink" title="添加自启动脚本"></a>添加自启动脚本</h2><h3 id="编写启动脚本"><a href="#编写启动脚本" class="headerlink" title="编写启动脚本"></a>编写启动脚本</h3><p>为防止服务器重启造成服务中断，可以添加自启动脚本，开机自启：</p><p>vim twikoo</p><p>将以下内容粘贴，:wq保存</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"># chkconfig: 2345 85 15</span><br><span class="line"># description:auto_run</span><br><span class="line"></span><br><span class="line">#评论数据存放路径</span><br><span class="line">ROOT_PATH=&quot;/www/data/twikoo/&quot;</span><br><span class="line">TWIKOO_DATA=$ROOT_PATH&quot;data&quot;</span><br><span class="line">#启动端口</span><br><span class="line">TWIKOO_PORT=8080</span><br><span class="line">#限流</span><br><span class="line">TWIKOO_THROTTLE=250</span><br><span class="line"></span><br><span class="line">#初始化方法，安装node</span><br><span class="line">init() &#123;</span><br><span class="line"></span><br><span class="line">#删除twikoo配置文件中原有的环境变量</span><br><span class="line">sed -ie &#x27;/TWIKOO_DATA/d&#x27; /etc/profile</span><br><span class="line">sed -ie &#x27;/TWIKOO_PORT/d&#x27; /etc/profile</span><br><span class="line">sed -ie &#x27;/TWIKOO_THROTTLE/d&#x27; /etc/profile</span><br><span class="line"></span><br><span class="line">#添加twikoo的环境变量，直接写入配置文件</span><br><span class="line">echo &quot;export TWIKOO_DATA=$TWIKOO_DATA&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export TWIKOO_PORT=$TWIKOO_PORT&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export TWIKOO_THROTTLE=$TWIKOO_THROTTLE&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_DATA:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_PORT:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_THROTTLE:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line"></span><br><span class="line">#判断文件夹是否存在 -d</span><br><span class="line">if [[ ! -d &quot;$TWIKOO_DATA&quot; ]]; then</span><br><span class="line">mkdir -p $TWIKOO_DATA</span><br><span class="line">else</span><br><span class="line">echo &quot;文件夹存在&quot;</span><br><span class="line">fi</span><br><span class="line">source /etc/profile</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#开始方法</span><br><span class="line">start() &#123;</span><br><span class="line">echo &#x27;运行twikoo&#x27;</span><br><span class="line">source /etc/profile</span><br><span class="line">cd ~</span><br><span class="line">    nohup tkserver &gt;&gt; $ROOT_PATH&quot;tkserver.log&quot; 2&gt;&amp;1 &amp;</span><br><span class="line">ps -ef | grep twikoo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#结束方法</span><br><span class="line">stop() &#123;</span><br><span class="line">    kill -9 `ps -ef|grep tkserver|grep -v grep|grep -v stop|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">start)</span><br><span class="line">init</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">stop)</span><br><span class="line">    stop</span><br><span class="line">    ;;</span><br><span class="line">restart)</span><br><span class="line">init</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Userage: $0 &#123;start|stop|restart&#125;&quot;</span><br><span class="line">    exit 1</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>脚本中可以按需修改<code>ROOT_PATH</code>，<code>TWIKOO_PORT</code>，<code>TWIKOO_THROTTLE</code></p><h3 id="设置脚本存放路径"><a href="#设置脚本存放路径" class="headerlink" title="设置脚本存放路径"></a>设置脚本存放路径</h3><p>复制刚刚保存的脚本到<code>/etc/init.d/</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp twikoo /etc/init.d/</span><br></pre></td></tr></table></figure><h3 id="添加执行权限"><a href="#添加执行权限" class="headerlink" title="添加执行权限"></a>添加执行权限</h3><p>给脚本可执行权限</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/init.<span class="property">d</span>/twikoo</span><br></pre></td></tr></table></figure><h3 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h3><p>添加为系统服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add twikoo</span><br></pre></td></tr></table></figure><p>开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig twikoo on</span><br></pre></td></tr></table></figure><p>查看</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list</span><br></pre></td></tr></table></figure><p>启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo start</span><br></pre></td></tr></table></figure><p>停用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo stop</span><br></pre></td></tr></table></figure><p>重启</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo restart</span><br></pre></td></tr></table></figure><div class="note info flat"><p>注意定期备份评论数据</p></div>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> Twikoo私有部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx常用功能之——限制用户请求</title>
      <link href="/posts/5e1e/"/>
      <url>/posts/5e1e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>nginx有两个限流模块：</p><p>1、ngx_http_limit_conn_module 限制速率策略，使用计数器算法</p><p>2、ngx_http_limit_req_module 并发限制策略，使用漏桶算法，引用一篇<a href="https://cloud.tencent.com/developer/article/2058553">文章</a>来解释该算法：</p><p>算法思想是：</p><ul><li>水（请求）从上方倒入水桶，从水桶下方流出（被处理）；</li><li>来不及流出的水存在水桶中（缓冲），以固定速率流出；</li><li>水桶满后水溢出（丢弃）。</li><li>这个算法的核心是：缓存请求、匀速处理、多余的请求直接丢弃。</li></ul><p><img src="/../img/5e1e/1661520427922.png" alt="限流原理"></p><h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">limit_req_zone key zone rate</span><br><span class="line">limit_conn_zone key zone</span><br></pre></td></tr></table></figure><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="限制请求数"><a href="#限制请求数" class="headerlink" title="限制请求数"></a>限制请求数</h3><p>1、<code>limit_req_zone</code>：定义限流策略为限制速率策略</p><p>2、<code>$binary_remote_addr</code>：<code>remote_addr</code>为存储客户端的ip地址变量，加上binary_为了压缩IP地址</p><p>3、<code>zone=req_limit:10m</code>：<code>znoe</code>指定内存区域，<code>req_limit</code>为该区域的名称，<code>10m</code>指这块内存区域的大小，</p><p>一般10m能存储16W IP 地址访问信息</p><p>4、<code>rate=10r/s</code>：指定最大访问速率，10r&#x2F;s表示每秒最多允许接受10个请求，即100ms内最多有一个请求，当100ms内还有请求，则nginx丢弃该请求。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name  blog.panghai.top;</span><br><span class="line">        # limit_req，使用限制速率策略</span><br><span class="line">        # burst=5，设置一个大小为 5 的缓冲区（队列），当有大量请求（爆发）过来时，超过了访问频次限制的 # 请求可以先放到这个缓冲区内。</span><br><span class="line">        # nodelay，要求立即处理请求；如果设置，超过访问频次而且缓冲区也满了的时候就会直接返回 503，如果    # 没有设置，则所有请求会等待排队。</span><br><span class="line">        # limit_req_status 指定请求时报错产生的状态码</span><br><span class="line">        limit_req zone=req_limit burst=5 nodelay;</span><br><span class="line">        limit_req_status 503;</span><br><span class="line">        </span><br><span class="line">        location /&#123;</span><br><span class="line">            root   /www/blog.panghai.top;</span><br><span class="line">try_files $uri $uri/ /index.html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        # 当发生指定错误的时候返回50x页面</span><br><span class="line">        error_page 502 503 =200 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root /usr/local/nginx/html;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="限制连接数"><a href="#限制连接数" class="headerlink" title="限制连接数"></a>限制连接数</h3><p>1、limit_req_zone：定义限流策略为并发限制策略</p><p>2、$binary_remote_addr：remote_addr为存储客户端的ip地址变量，加上binary_为了压缩IP地址</p><p>2、$server_name：server_name表示虚拟主机(server) 同时能处理并发连接的总数</p><p>3、zone&#x3D;perip:10m：znoe指定内存区域，req_limit为该区域的名称，10m指这块内存区域的大小，</p><p>一般10m能存储16W IP 地址访问信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line"> # 定义限流策略</span><br><span class="line"> limit_conn_zone $binary_remote_addr zone=perip:10m;</span><br><span class="line"> limit_conn_zone $server_name zone=perserver:10m;</span><br><span class="line"> # 搜索服务的虚拟主机</span><br><span class="line"> server &#123;</span><br><span class="line"> location / &#123;</span><br><span class="line"> # 使用并发限制策略，表示限制单个 IP 同时最多能持有 1 个连接</span><br><span class="line"> # limit_conn perip 1;</span><br><span class="line"> # 表示虚拟主机(server) 同时能处理并发连接的总数。只有当 request header 被后端 server   # 处理后，这个连接才进行计数</span><br><span class="line"> limit_conn perserver 10 ;</span><br><span class="line">         limit_conn_status 503;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">conf配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-3">配置解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line"></span><br><span class="line">limit_req_zone $binary_remote_addr zone=req_limit:10m rate=1r/s;</span><br><span class="line"></span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">          root /www/blog/aaa/;</span><br><span class="line">          try_files $uri $uri/ /index.html;</span><br><span class="line">          limit_req zone=req_limit burst=1 nodelay;</span><br><span class="line">          limit_req_status 503;</span><br><span class="line">          </span><br><span class="line"> # 当发生指定错误的时候返回50x页面</span><br><span class="line">        error_page 502 503 =200 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root /usr/local/nginx/html;</span><br><span class="line">        &#125; </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/5e1e/20220826214509.gif" alt="限流效果"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>rate&#x3D;1r&#x2F;s：速率为1次&#x2F;秒</p><p>burst&#x3D;1：缓冲1个请求</p><p>nodelay：要求立即处理</p><p>综上，当我的访问速率超过2r&#x2F;s时，Nginx会返回503，而error_page代码部分则捕获了503状态码，并返回了<code>/usr/local/nginx/html/50x.html</code>页面</p><p><code>限制连接数</code>效果展示同理，可自行测试。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx限流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx三大功能之——负载均衡</title>
      <link href="/posts/68ad/"/>
      <url>/posts/68ad/</url>
      
        <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>负载均衡就是将大量的请求按照某种方式均衡分配给集群中的服务器，防止大量请求只请求一台服务器，从而导致服务崩溃。</p><p><img src="/../img/68ad/1661434931816.png" alt="负载均衡"></p><h2 id="轮询策略"><a href="#轮询策略" class="headerlink" title="轮询策略"></a>轮询策略</h2><p>Nginx负载均衡策略（内置）主要有四种：</p><ul><li>轮询策略（默认的负载均衡策略）</li><li>最少连接数负载均衡策略</li><li>ip-hash负载均衡策略</li><li>权重负载均衡策略</li></ul><h3 id="轮询策略-1"><a href="#轮询策略-1" class="headerlink" title="轮询策略"></a>轮询策略</h3><p>轮询负载策略是指每次将请求按顺序轮流发送至相应的服务器上：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">upstream server_list &#123;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最少连接数负载均衡策略"><a href="#最少连接数负载均衡策略" class="headerlink" title="最少连接数负载均衡策略"></a>最少连接数负载均衡策略</h3><p>此策略是指每次将请求分发到当前连接数最少的服务器上，也就是 Nginx 会将请求试图转发给相对空闲的服务器以实现负载均衡，它的配置示例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   #负载均衡</span><br><span class="line">upstream server_list &#123;</span><br><span class="line">least_conn;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ip-hash-负载均衡策略"><a href="#ip-hash-负载均衡策略" class="headerlink" title="ip-hash 负载均衡策略"></a>ip-hash 负载均衡策略</h3><p>ip-hash 负载均衡策略可以根据客户端的 IP，将其固定的分配到相应的服务器上，配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   #负载均衡</span><br><span class="line">upstream server_list &#123;</span><br><span class="line">ip-hash;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="加权负载均衡"><a href="#加权负载均衡" class="headerlink" title="加权负载均衡"></a>加权负载均衡</h3><p>此配置方式是指每次按照服务器配置的去权重进行请求分发，权重高的服务器会收到更多的请求，这就相当于给 Nginx 在请求分发时加了一个参考的权重选项，并且这个权重值是可以人工配置的，我们可以将服务器配置高的调的权重相对高一些，以便承担更多请求：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">upstream server_list &#123;</span><br><span class="line">server 111.229.10.76:8080 weight=5;</span><br><span class="line">server 113.12.43.122:8080 weight=2;</span><br><span class="line">server 119.33.31.61:8080 weight=1;</span><br><span class="line">server 43.12.12.31:8080 backup;</span><br><span class="line">server 12.31.23.44:8080 down;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，8次请求中，有5次发给了权重为5的服务器，2次发给了权重为2的服务器，1次发给了权重为1的服务器，down代表临时不参与负载，backup代表其他全部的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻</p>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx负载均衡 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx三大功能之——Nginx反向代理</title>
      <link href="/posts/830e/"/>
      <url>/posts/830e/</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><h4 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h4><p>如果把局域网外的 Internet 想象成一个巨大的资源库，则局域网中的客户端要访问 Internet，则需要通过代理服务器来访问，这种代理服务就称为正向代理。</p><p><img src="/../img/830e/1661395226139.png" alt="正向代理原理"></p><h4 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h4><p>客户端对代理是无感知的，因为客户端不需要任何配置就可以访问，我们只需要将请求发送到反向代理服务器，由反向代理服务器去选择目标服务器获取数据后，在返回给客户端，此时反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器 IP 地址。 </p><p><img src="/../img/830e/1661395486077.png" alt="反向代理原理"></p><p>正向代理和反向代理的区别：</p><p>​如果我们自己调用本地接口，就是正向代理。</p><p>​如果是调用服务器接口，我们用户无感知，就是反向代理。</p><h3 id="location配置"><a href="#location配置" class="headerlink" title="location配置"></a>location配置</h3><p>Nginx的反向代理主要通过location来配置，来看一个简单的例子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>定义一个server模块，表示一个虚拟主机</p><ul><li><p>listen 80：监听80端口</p></li><li><p>location &#x2F;random：当请求的路径含有&#x2F;random*或者&#x2F;random&#x2F;*，则匹配成功，例如location&#x2F;random11 或者location&#x2F;random&#x2F;11，都是可以匹配成功的</p></li><li><p>proxy_pass <a href="http://127.0.0.1:8098/%EF%BC%9A%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82%E7%BB%99%E8%AF%A5%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%8D%B3%E6%9C%AC%E6%AC%A1%E8%AF%B7%E6%B1%82%E5%88%B0%E7%9A%84%E7%9C%9F%E5%AE%9E%E5%9C%B0%E5%9D%80">http://127.0.0.1:8098/：转发请求给该地址，即本次请求到的真实地址</a></p></li></ul><h3 id="location-匹配顺序"><a href="#location-匹配顺序" class="headerlink" title="location 匹配顺序"></a>location 匹配顺序</h3><p>1、<strong>location</strong> 匹配格式规则前缀有如下几种：</p><ul><li><strong>&#x3D;</strong> <strong>开头</strong>：表示精确匹配</li><li><strong>^~</strong> <strong>开头</strong>：注意这不是一个正则表达式，它的目的是优于正则表达式的匹配；如果该 <strong>location</strong> 是最佳匹配，则不再进行正则表达式检测。</li><li><strong>~</strong> <strong>开头</strong>：表示区分大小写的正则匹配;</li><li><strong>~*</strong> <strong>开头</strong>：表示不区分大小写的正则匹配</li><li>**!~ &amp;&amp; !~***：表示区分大小写不匹配的正则和不区分大小写的不匹配的正则</li></ul><p>2、<strong>location</strong> 如果不带前缀就是普通字符串匹配，比如：</p><ul><li><strong>&#x2F;uri&#x2F;</strong> 普通字符串匹配</li><li><strong>&#x2F;</strong> 绝对路径根目录匹配，如果没有其它匹配，任何请求都会匹配到</li></ul><p>3、匹配的搜索顺序优先级如下（从上到下优先级依次递减）：</p><ul><li>首先匹配 <strong>&#x3D;</strong></li><li>其次匹配 <strong>^~</strong></li><li>再其次按照配置文件的顺序进行正则匹配</li><li>最后是交给 <strong>&#x2F;</strong> 进行通用匹配</li></ul><blockquote><p>注意：</p><p>当有匹配成功时，立刻停止匹配，按照当前匹配规则处理请求</p><p>优先搜索并不意味着优先命中！</p><p>字符串匹配优先搜索，但是只是记录下最长的匹配 ( 如果 <strong>^~</strong> 是最长的匹配，则会直接命中，停止搜索正则 )，然后继续搜索正则匹配，如果有正则匹配，则命中正则匹配，如果没有正则匹配，则命中最长的字符串匹配。</p></blockquote><h3 id="匹配模式及顺序举例"><a href="#匹配模式及顺序举例" class="headerlink" title="匹配模式及顺序举例"></a>匹配模式及顺序举例</h3><ul><li><strong>location &#x3D; &#x2F;uri</strong> 　　　<strong>&#x3D;</strong> 开头表示精确匹配，只有完全匹配上才能生效。</li><li><strong>location ^~ &#x2F;uri</strong> 　　<strong>^~</strong> 开头对 <strong>URL</strong> 路径进行前缀匹配，并且在正则之前。</li><li><strong>location ~ pattern</strong> 　<strong>~</strong> 开头表示区分大小写的正则匹配。</li><li><strong>location ~* pattern</strong> 　<strong>~*</strong> 开头表示不区分大小写的正则匹配。</li><li><strong>location &#x2F;uri</strong>       不带任何修饰符，也表示前缀匹配，但是在正则匹配之后，如果没有正则命中，命中最长的规则。</li><li><strong>location &#x2F;</strong> 　　通用匹配，任何未匹配到其它 <strong>location</strong> 的请求都会匹配到，相当于 <strong>switch</strong> 中的 <strong>default</strong>。</li></ul><h3 id="location-x2F-匹配规则"><a href="#location-x2F-匹配规则" class="headerlink" title="location &#x2F; 匹配规则"></a>location &#x2F; 匹配规则</h3><p>1、没有“**&#x2F;<strong>”结尾时，</strong>location&#x2F;random** 可以匹配 <strong>&#x2F;random11</strong> 请求，也可以匹配 <strong>&#x2F;random&#x2F;11</strong> 等</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、而有“**&#x2F;<strong>”结尾时，</strong>location&#x2F;random&#x2F;** 不能匹配 <strong>&#x2F;random11</strong> 请求，只能匹配 <strong>&#x2F;random&#x2F;11</strong> 这样的请求</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="proxy-pass-代理规则"><a href="#proxy-pass-代理规则" class="headerlink" title="proxy_pass 代理规则"></a>proxy_pass 代理规则</h3><p>1、没有“**&#x2F;<strong>”结尾时，</strong>Nginx** 则会把匹配的路径部分加入代理 <strong>uri</strong>，例如：</p><p>访问<a href="http://ip/random/getName%EF%BC%8C%E6%9C%80%E7%BB%88%E4%BB%A3%E7%90%86%E5%88%B0**URL**%E6%98%AF">http://ip:80/random/getName，最终代理到**URL**是</a> <a href="http://127.0.0.1:8098/random/getName">http://127.0.0.1:8098/random/getName</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、而有“**&#x2F;<strong>”结尾时，相当于是</strong>绝对路径**，则 <strong>Nginx</strong>不会把 <strong>location</strong> 中匹配的路径部分加入代理 <strong>uri</strong>，例如：</p><p>访问<a href="http://ip/random/getName%EF%BC%8C%E6%9C%80%E7%BB%88%E4%BB%A3%E7%90%86%E5%88%B0**URL**%E6%98%AF">http://ip:80/random/getName，最终代理到**URL**是</a> <a href="http://127.0.0.1:8098/getName">http://127.0.0.1:8098/getName</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://www.hangge.com/blog/cache/detail_2979.html">https://www.hangge.com/blog/cache/detail_2979.html</a></p><p><a href="https://developer.aliyun.com/article/506996">https://developer.aliyun.com/article/506996</a></p>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx反向代理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx入门介绍</title>
      <link href="/posts/2c47/"/>
      <url>/posts/2c47/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p> Nginx(engine x)是一个高性能的HTTP和反向代理web服务器，具有低系统消耗、稳定、配置简单的特点，能够支持高达50000个并发连接数的响应。</p><h3 id="Nginx基础使用"><a href="#Nginx基础使用" class="headerlink" title="Nginx基础使用"></a>Nginx基础使用</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>linux安装脚本<a href="/code/nginx/install-nginx.sh" target="_blank">点击下载</a></p><p>安装的nginx位置：<code>/usr/local/nginx</code></p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>nginx的配置在<code>conf/nginx.conf</code></p><p>先给出最简单的配置，server_name改成你自己的公网ip即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 80;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><p>服务器执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><p>没有任何输出表示运行成功，默认运行端口为<code>80</code></p><div class="note info flat"><p>运行效果</p></div><p><img src="/../img/2c47/1661352774101.png" alt="nginx运行界面"></p><h3 id="Nginx常用命令"><a href="#Nginx常用命令" class="headerlink" title="Nginx常用命令"></a>Nginx常用命令</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">启动Nginx</button></li><li class="tab"><button type="button" data-href="#tab-1-2">重新载入配置文件</button></li><li class="tab"><button type="button" data-href="#tab-1-3">停止Nginx</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Nginx的常用场景配置"><a href="#Nginx的常用场景配置" class="headerlink" title="Nginx的常用场景配置"></a>Nginx的常用场景配置</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">文件映射</button></li><li class="tab"><button type="button" data-href="#tab-1-2">子页面作为主页</button></li><li class="tab"><button type="button" data-href="#tab-1-3">反向代理</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><code>nginx.conf</code>配置：</p><p>有时候需要将博客部署在服务器作为源站，这时候就需要nginx为服务器文件映射给某个端口：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>try_files $uri $uri/ /index.html</code> 表示匹配到<code>/</code>时先尝试文件&#x2F;index.html，成功时返回，失败返回403，nginx默认设置。</p><p><code>服务器文件</code>：</p><p><img src="/../img/2c47/1661354218846.png" alt="定义index文件"></p><div class="note success flat"><p>运行效果</p></div><p><img src="/../img/2c47/1661352705480.png" alt="index文件界面"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><code>nginx.conf</code>配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog/aaa/;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>服务器文件</code>：</p><p><img src="/../img/2c47/1661353566832.png" alt="服务器文件"></p><div class="note success flat"><p>运行效果</p></div><p><img src="/../img/2c47/1661354104730.png" alt="二级页面"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>反向代理</code>实际上和服务器文件映射类似，都是将本地资源允许其他人访问，通俗叫做本地接口映射</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog/aaa/;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">      location /api/&#123;</span><br><span class="line">         proxy_pass http://127.0.0.1:8098/;</span><br><span class="line">         proxy_redirect off;</span><br><span class="line">         proxy_set_header HOST $host;</span><br><span class="line">         proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">         proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note success flat"><p>运行效果</p></div><p><img src="/../img/2c47/1661356215637.png" alt="接口"></p><div class="note info flat"><p><code>location /api/</code>表示请求的路径严格匹配api字段，即请求的路径一定要有<code>/api/</code>，否则无法匹配到<code>/api/</code>，nginx无法匹配<code>/api1/getName</code>，导致返回了500服务器错误：</p></div><p><img src="/../img/2c47/1661355913211.png" alt="500错误"></p><div class="note info flat"><p><code>location /api</code>表示含有<code>/api</code>就行，故<code>/api1/getName</code>匹配成功：</p></div><p><img src="/../img/2c47/1661355852507.png" alt="请求路径错误"></p><div class="note info flat"><p><code>proxy_pass http://127.0.0.1:8098;</code>表示匹配路径成功后，将<a href="http://127.0.0.1:8098的访问结果返回">http://127.0.0.1:8098的访问结果返回</a></p></div><p><img src="/../img/2c47/1661356448757.png" alt="请求路径错误"></p><div class="note info flat"><p><code>proxy_pass http://127.0.0.1:8098/;</code>表示匹配路径成功后，将<a href="http://127.0.0.1:8098/getName%E7%9A%84%E8%AE%BF%E9%97%AE%E7%BB%93%E6%9E%9C%E8%BF%94%E5%9B%9E%EF%BC%8C%E8%BF%99%E9%87%8C%E7%9A%84getName%E5%AF%B9%E5%BA%94%E7%9D%80/api/getName%EF%BC%8C%E5%8D%B3%60proxy_pass%60%E5%90%8E%E9%9D%A2%E6%9C%89%60/%60%E8%A1%A8%E7%A4%BA%E5%B8%A6%E5%85%A5%E8%B7%AF%E5%BE%84%E5%90%8E%E9%9D%A2%E7%9A%84%E5%AD%97%E7%AC%A6">http://127.0.0.1:8098/getName的访问结果返回，这里的getName对应着/api/getName，即`proxy_pass`后面有`/`表示带入路径后面的字符</a></p></div><p><img src="/../img/2c47/1661356215637.png" alt="请求接口"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://nginx.org/">Nginx官网</a></p>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx基本使用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用php语言搭建必应壁纸api</title>
      <link href="/posts/af9f/"/>
      <url>/posts/af9f/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>​必应搜索每日都会有一张精美的图片，也有官方接口供我们使用，我们可以借助官方接口自建壁纸api用于博客使用，不用再纠结于找文章封面和文章顶部图</p><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>现目前已搭建两个api，如想直接使用请自取：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">https://bing.panghai.top/php/random.php</span> <span class="comment"># 获取随机壁纸</span></span><br><span class="line"><span class="string">https://bing.panghai.top/php/today.php</span>  <span class="comment"># 获取今日壁纸</span></span><br><span class="line"><span class="string">https://bing.panghai.top/json/474</span>       <span class="comment"># 获取json数据，474代表页数</span></span><br></pre></td></tr></table></figure><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">json接口效果</button></li><li class="tab"><button type="button" data-href="#tab-1-2">今日壁纸api</button></li><li class="tab"><button type="button" data-href="#tab-1-3">随机壁纸api</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/af9f/1661244208350.png" alt="json接口效果"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/af9f/1661244361389.png" alt="今日壁纸api"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/../img/af9f/1661244339151.png" alt="随机壁纸api"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>现给出搭建教程</p><div class="note warning no-icon flat"><p>搭建有些门槛，请谨慎搭建</p></div><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>​1、需拥有一台服务器和连接工具（可以使用<a href="https://vercel.com/">vercel</a>部署，这里加个坑，后面更新）</p><p>​2、需要安装php环境、nginx环境以及更换python环境</p><p>​    3、需要一点linux、nginx、php以及python语法知识</p><p>​4、需要七牛云的对象存储（python SDK使用介绍加个坑，后面细谈）</p><p>​5、需要邮箱授权码</p><p>​6、需要一个子域名</p><h2 id="部署教程"><a href="#部署教程" class="headerlink" title="部署教程"></a>部署教程</h2><div class="note info no-icon flat"><p>如果只需要今日壁纸api则只需查看步骤<a href="/posts/af9f/#%E5%AE%89%E8%A3%85php%E7%8E%AF%E5%A2%83">5.3</a>、<a href="/posts/af9f/#%E5%AE%89%E8%A3%85nginx">5.4</a>、<a href="/posts/af9f/#%E5%85%8B%E9%9A%86%E9%A1%B9%E7%9B%AE">5.5</a>、<a href="/posts/af9f/#%E5%88%9B%E5%BB%BAapi">5.10</a>、<a href="/posts/af9f/#%E4%BF%AE%E6%94%B9nginx%E9%85%8D%E7%BD%AE">5.11</a></p><p>如果还需要随机壁纸api则需要查看全部步骤</p></div><h3 id="更换服务器python环境"><a href="#更换服务器python环境" class="headerlink" title="更换服务器python环境"></a>更换服务器python环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/bin</span><br><span class="line">rm -rf pip</span><br><span class="line">rm -rf python</span><br><span class="line">ln -s pip3.6 pip</span><br><span class="line">ln -s python3.6 python</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>针对<code>CentOS7.6</code>版本</p></div><h3 id="安装七牛云依赖包"><a href="#安装七牛云依赖包" class="headerlink" title="安装七牛云依赖包"></a>安装七牛云依赖包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">pip install requests -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip install qiniu -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><h3 id="安装php环境"><a href="#安装php环境" class="headerlink" title="安装php环境"></a>安装php环境</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.php.cn/linux-462962.html</span><br></pre></td></tr></table></figure><h3 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h3><p>这里给出一键安装脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">echo &quot;----------------------------------start install nginx -----------------------------&quot;</span><br><span class="line">yum install -y gcc-c++  </span><br><span class="line">yum -y install openssl openssl-devel</span><br><span class="line">yum install -y zlib zlib-devel</span><br><span class="line">yum install -y pcre pcre-devel</span><br><span class="line">if [ &#x27;grep &quot;nginx&quot; /etc/passwd | wc -l&#x27; ]; then</span><br><span class="line">echo &quot;adding user nginx&quot;</span><br><span class="line">groupadd nginx</span><br><span class="line">useradd -s /sbin/nologin -M -g nginx nginx</span><br><span class="line">else</span><br><span class="line">echo &quot;user nginx exsits&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;-----------------------------------downloading nginx-------------------------------&quot;</span><br><span class="line">wget http://nginx.org/download/nginx-1.21.3.tar.gz</span><br><span class="line">tar -xvf nginx-1.21.3.tar.gz</span><br><span class="line">cd nginx-1.21.3</span><br><span class="line"></span><br><span class="line">echo &quot;------------------------------------configuring nginx,plz wait----------------------&quot;</span><br><span class="line">./configure --prefix=/usr/local/nginx --with-http_ssl_module --with-http_realip_module --with-http_stub_status_module</span><br><span class="line"></span><br><span class="line">if [ $? -ne 0 ];then</span><br><span class="line">echo &quot;configure failed ,please check it out!&quot;</span><br><span class="line">else</span><br><span class="line">echo &quot;make nginx, please wait for 20 minutes&quot;</span><br><span class="line">make</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ $? -ne 0 ];then</span><br><span class="line">echo &quot;make failed ,please check it out!&quot;</span><br><span class="line">else</span><br><span class="line">echo &quot;install nginx, please wait for 20 minutes&quot;</span><br><span class="line">make install</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">chown -R nginx.nginx /usr/local/nginx</span><br><span class="line">ln -s /lib64/libpcre.so.0.0.1 /lib64/libpcre.so.1</span><br><span class="line">cp /usr/local/nginx/sbin/nginx /usr/bin</span><br><span class="line">nginx</span><br><span class="line">iptables -I INPUT 3 -s 0.0.0.0/0 -p tcp --dport 80 -j ACCEPT</span><br><span class="line">echo &quot;----------------------------------start install nginx success-----------------------------&quot;</span><br></pre></td></tr></table></figure><p>新建<code>install.sh</code>，粘贴内容，<code>sh install.sh</code>即可</p><div class="note info no-icon flat"><p>nginx的安装路径在<code>/usr/local/nginx</code></p></div><h3 id="克隆项目"><a href="#克隆项目" class="headerlink" title="克隆项目"></a>克隆项目</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:flow2000/bing<span class="literal">-api</span>.git</span><br></pre></td></tr></table></figure><p>将.py文件放入服务器&#x2F;www&#x2F;scheduled_tasks中（没有&#x2F;www&#x2F;scheduled_tasks创建一个）：</p><p><img src="/../img/af9f/1661227733296.png" alt="上传文件"></p><p>创建以下文件夹：</p><p><img src="/../img/af9f/1661228170970.png" alt="创建文件夹"></p><h3 id="下载全部壁纸"><a href="#下载全部壁纸" class="headerlink" title="下载全部壁纸"></a>下载全部壁纸</h3><p>指定程序保存路径，服务器执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /www/scheduled_tasks</span><br><span class="line">python download_all_wallpaper.py</span><br></pre></td></tr></table></figure><p>嫌麻烦可以使用云盘：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">百度云链接：链接: https://pan.baidu.com/s/1l1DmpT4ZLeuwkQsbLFK2SA?pwd=6666</span><br><span class="line">天翼云盘链接：https://cloud.189.cn/web/share?code=jQBFbyRriEby（访问码：a8mb）</span><br></pre></td></tr></table></figure><h3 id="创建json数据"><a href="#创建json数据" class="headerlink" title="创建json数据"></a>创建json数据</h3><p>创建json数据后可以不用数据库存储壁纸信息，直接返回json即可</p><p>指定程序保存路径，补充自己的七牛云自定义加速域名（最好填写）服务器端执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /www/scheduled_tasks</span><br><span class="line">python create_json.py</span><br></pre></td></tr></table></figure><h3 id="压缩图片"><a href="#压缩图片" class="headerlink" title="压缩图片"></a>压缩图片</h3><p>下载的图片会比较大，不适合作为文章封面，所以增加了压缩图片的功能。</p><p>前提：已经在服务器安装<a href="https://blog.csdn.net/u013314786/article/details/89682800">ffmpeg</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /www/scheduled_tasks</span><br><span class="line">python compress_all_wallpaper.py</span><br></pre></td></tr></table></figure><h3 id="运行每日任务"><a href="#运行每日任务" class="headerlink" title="运行每日任务"></a>运行每日任务</h3><p>指定程序保存路径，在daily_task.py中添加七牛云key和密钥以及存储桶名称，有需求可添加邮箱提醒，修改服务器执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /www/scheduled_tasks</span><br><span class="line">python daily_task.py</span><br></pre></td></tr></table></figure><h3 id="服务器创建定时任务"><a href="#服务器创建定时任务" class="headerlink" title="服务器创建定时任务"></a>服务器创建定时任务</h3><p>编辑&#x2F;etc&#x2F;crontab，添加：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0 * * * root /usr/bin/python /www/scheduled_tasks/daily_task.py</span><br></pre></td></tr></table></figure><p><code>0 0 * * *</code>代表每天0点执行。</p><div class="note info no-icon flat"><p>Cron表达式可见本博客详解：<a href="https://blog.panghai.top/posts/19b8/">Cron 表达式详解</a></p></div><h3 id="创建api"><a href="#创建api" class="headerlink" title="创建api"></a>创建api</h3><p>将<code>today.php</code>和<code>random.php</code>放入<code>/www/data/php</code></p><h3 id="修改nginx配置"><a href="#修改nginx配置" class="headerlink" title="修改nginx配置"></a>修改nginx配置</h3><p>修改<code>/usr/local/nginx/conf/nginx.conf</code>：</p><p>http配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name yourdomain;</span><br><span class="line"></span><br><span class="line">    # include vhosts/*.conf;</span><br><span class="line">    #当请求网站下php文件的时候，反向代理到php-fpm</span><br><span class="line">    location ~ .*\.php?$ &#123;</span><br><span class="line">        root   /www/data/;</span><br><span class="line">        # try_files $uri $uri/ $uri.php?$args;</span><br><span class="line">        index  api.php;</span><br><span class="line">        try_files $uri = 404; #预先请求是否存在该文件，不存在返回404页面</span><br><span class="line">        include fastcgi.conf;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 创建json数据Api</span><br><span class="line">        location /json &#123;</span><br><span class="line">        root /www/data/;</span><br><span class="line">        try_files $uri $uri $uri.json?$args; #去掉.json后缀</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>https配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">   server &#123;</span><br><span class="line">       listen 80;</span><br><span class="line">       server_name yourdomain;</span><br><span class="line">       return  301 https://$server_name$request_uri;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">listen 443 ssl;</span><br><span class="line">server_name yourdomain;</span><br><span class="line">       ssl_certificate /etc/ssl/yourdomain/yourdomain.pem;</span><br><span class="line">       ssl_certificate_key /etc/ssl/yourdomain/yourdomain.key;</span><br><span class="line">       ssl_session_cache    shared:SSL:4m;</span><br><span class="line">       ssl_session_timeout  10m;</span><br><span class="line">       ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">       ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">       # include vhosts/*.conf;</span><br><span class="line">       #当请求网站下php文件的时候，反向代理到php-fpm</span><br><span class="line">       location ~ .*\.php?$ &#123;</span><br><span class="line">           root   /www/data/;</span><br><span class="line">           # try_files $uri $uri/ $uri.php?$args;</span><br><span class="line">           index  today.php;</span><br><span class="line">           try_files $uri = 404; #预先请求是否存在该文件，不存在返回404页面</span><br><span class="line">           include fastcgi.conf;</span><br><span class="line">           fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       # 创建json数据Api</span><br><span class="line">       location /json &#123;</span><br><span class="line">           root /www/data/;</span><br><span class="line">           try_files $uri $uri $uri.json?$args; #去掉.json后缀</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>至此搭建完毕，有疑问可以在下方评论</p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 必应api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笔记本电脑开机自动更换背景壁纸</title>
      <link href="/posts/e22f/"/>
      <url>/posts/e22f/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>​必应搜索每日都会有一张精美的图片，我们可以每次开机设置最新壁纸到电脑背景</p><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>​1、需拥有python环境</p><p>​2、需要在有网络环境下运行</p><p>​    3、最好先单独执行set_today_background.py，执行错误则需要pip安装以上导入的包</p><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><p>1、克隆项目</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">git@github.com:flow2000/set-today-background.git</span></span><br></pre></td></tr></table></figure><p>2、编辑set_today_background.py的root_path路径，编辑start.bat中path路径（python安装路径）和python文件路径</p><p>3、将set_today_background.py放入图片文件中，start.bat放入C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp，开机重启验证即可</p><p>至此已实现客户端开机自动下载壁纸并设置电脑背景的需求（有网的情况下）。</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>1、本程序有一个缺陷：当开机后没有联网运行set_today_background.py会导致下载壁纸失败。可以在start.bat中set path&#x3D;xxx前加入：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timeout <span class="number">60</span></span><br></pre></td></tr></table></figure><p>60是秒数，start.bat内已加入timeout 3，可自行设置时长，限定时间内自行连上网即可</p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 必应api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：标签外挂教程</title>
      <link href="/posts/5dd3/"/>
      <url>/posts/5dd3/</url>
      
        <content type="html"><![CDATA[<h2 id="标签外挂（Tag-Plugins）"><a href="#标签外挂（Tag-Plugins）" class="headerlink" title="标签外挂（Tag Plugins）"></a>标签外挂（Tag Plugins）</h2><div class="note info icon-padding flat"><i class="note-icon falt"></i><p>标签外挂是Hexo独有的功能，并不是标准的Markdown格式。</p><p>以下的写法，只适用于Butterfly主题，用在其它主题上不会有效果，甚至可能会报错。使用前请留意</p></div><div class="note warning icon-padding flat"><i class="note-icon falt"></i><p>标签外挂虽然能为主题带来一些额外的功能和UI方面的强化，但是，标签外挂也有明显的限制，使用时请留意。</p></div><h3 id="Note-Bootstrap-Callout"><a href="#Note-Bootstrap-Callout" class="headerlink" title="Note (Bootstrap Callout)"></a>Note (Bootstrap Callout)</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">固定icon通用设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">自定义icon通用设置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">全局设置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>语法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">名称</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">class</td><td align="center">【可选】标识，不同的标识有不同的配色<br/>（ default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger ）</td></tr><tr><td align="center">no-icon</td><td align="center">【可选】不显示 icon</td></tr><tr><td align="center">style</td><td align="center">【可选】可以覆盖配置中的 style<br/>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">simple样式</button></li><li class="tab"><button type="button" data-href="#tab-1-2">modern样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">flat样式</button></li><li class="tab"><button type="button" data-href="#tab-1-4">disabled样式</button></li><li class="tab"><button type="button" data-href="#tab-1-5">no-icon样式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;</span><br><span class="line">info 提示块标籤</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat  %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note info flat"><p>3.2.0 以上版本支持</p></div><p>note 语法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">名称</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">color</td><td align="center">【可选】顔色<br/>(default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green)</td></tr><tr><td align="center">icon</td><td align="center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td align="center">style</td><td align="center">【可选】可以覆盖配置中的 style<br/>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">simple样式</button></li><li class="tab"><button type="button" data-href="#tab-1-2">modern样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">flat样式</button></li><li class="tab"><button type="button" data-href="#tab-1-4">disabled样式</button></li><li class="tab"><button type="button" data-href="#tab-1-5">no-icon样式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了….</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue no-icon %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink no-icon %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red no-icon %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple no-icon %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green no-icon %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>移植于next主题，并进行修改。修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Note (Bootstrap Callout)</span></span><br><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note tag style values:</span></span><br><span class="line">  <span class="comment">#  - simple    bs-callout old alert style. Default.</span></span><br><span class="line">  <span class="comment">#  - modern    bs-callout new (v2-v3) alert style.</span></span><br><span class="line">  <span class="comment">#  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span></span><br><span class="line">  <span class="comment">#  - disabled  disable all CSS styles import of note tag.</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line">  <span class="comment"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line">  <span class="comment"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><code>icons</code>和<code>light_bg_offset</code>只对方法一生效</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Gallery相册图库"><a href="#Gallery相册图库" class="headerlink" title="Gallery相册图库"></a>Gallery相册图库</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>name：图库名字</li><li>description：图库描述</li><li>link：连接到对应相册的地址</li><li>img-url：图库封面的地址</li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span><br><span class="line">&#123;% galleryGroup &#x27;壁纸&#x27; &#x27;收藏的一些壁纸&#x27; &#x27;/gallery/wallpaper/&#x27; https://bing.panghai.top/php/today.php %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://bing.panghai.top/php/today.php' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">壁纸</div>  <p>收藏的一些壁纸</p>  <a href='/gallery/wallpaper/'></a>  </figcaption>  </figure>  </div><h3 id="Gallery相册"><a href="#Gallery相册" class="headerlink" title="Gallery相册"></a>Gallery相册</h3><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 图片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=1</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=2</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=3</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=4</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=5</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=6</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=7</span>)</span><br><span class="line">![](<span class="link">https://bing.panghai.top/php/random.php?random=8</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="fj-gallery"><p><img src="https://bing.panghai.top/php/random.php?random=1" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=2" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=3" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=4" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=5" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=6" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=7" alt="必应壁纸|壁纸"><br><img src="https://bing.panghai.top/php/random.php?random=8" alt="必应壁纸|壁纸"></p>          </div><h3 id="Tabs"><a href="#Tabs" class="headerlink" title="Tabs"></a>Tabs</h3><p>移植于next主题</p><p>使用方法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line"><span class="code">                Will be used in #id&#x27;s as prefix for each tab with their index numbers.</span></span><br><span class="line"><span class="code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span></span><br><span class="line"><span class="code">                Only for current url of post/page must be unique!</span></span><br><span class="line"><span class="code">[index]       : Index number of active tab.</span></span><br><span class="line"><span class="code">                If not specified, first tab (1) will be selected.</span></span><br><span class="line"><span class="code">                If index is -1, no tab will be selected. It&#x27;s will be something like spoiler.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[Tab caption] : Caption of current tab.</span></span><br><span class="line"><span class="code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span></span><br><span class="line"><span class="code">                If not caption specified, but specified icon, caption will empty.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[@icon]       : FontAwesome icon name (full-name, look like &#x27;fas fa-font&#x27;)</span></span><br><span class="line"><span class="code">                Can be specified with or without space; e.g. &#x27;Tab caption @icon&#x27; similar to &#x27;Tab caption@icon&#x27;.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子 - 自定义Tab名 + 只有icon + icon和Tab名</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="mermaid"><a href="#mermaid" class="headerlink" title="mermaid"></a>mermaid</h3><p>使用mermaid标签可以绘制Flowchart（流程图）、Sequence diagram（时序图 ）、Class Diagram（类别图）、State Diagram（状态图）、Gantt（甘特图）和Pie Chart（圆形图），具体可以查看<a href="https://mermaid-js.github.io/mermaid/#/">mermaid文档</a></p><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mermaid</span></span><br><span class="line"><span class="comment"># see https://github.com/mermaid-js/mermaid</span></span><br><span class="line"><span class="attr">mermaid:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># built-in themes: default/forest/dark/neutral</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">default</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">dark</span></span><br></pre></td></tr></table></figure><p>写法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">pie</span><br><span class="line"><span class="code">    title Key elements in Product X</span></span><br><span class="line"><span class="code">    &quot;Calcium&quot; : 42.96</span></span><br><span class="line"><span class="code">    &quot;Potassium&quot; : 50.05</span></span><br><span class="line"><span class="code">    &quot;Magnesium&quot; : 10.01</span></span><br><span class="line"><span class="code">    &quot;Iron&quot; :  5</span></span><br><span class="line"><span class="code">&#123;% endmermaid %&#125;</span></span><br></pre></td></tr></table></figure><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  pie    title Key elements in Product X    &quot;Calcium&quot; : 42.96    &quot;Potassium&quot; : 50.05    &quot;Magnesium&quot; : 10.01    &quot;Iron&quot; :  5  </pre></div><h3 id="tag-hide"><a href="#tag-hide" class="headerlink" title="tag-hide"></a>tag-hide</h3><div class="note warning modern"><p>请注意，tag-hide内的标签外挂content内都不建议有h1 - h6 等标题。因为Toc会把隐藏内容标题也显示出来，而且当滚动屏幕时，如果隐藏内容没有显示出来，会导致Toc的滚动出现异常。</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">Toggle</button></li><li class="tab"><button type="button" data-href="#tab-1-2">Inline</button></li><li class="tab"><button type="button" data-href="#tab-1-3">Block</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note info modern"><p>2.3.0以上支持</p></div><p>如果你需要展示的内容太多，可以把它隐藏在收缩框里，需要时再把它展开。</p><p>( display 不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle Butterfly安装方法 %&#125;</span><br><span class="line">在你的博客根目录里</span><br><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line">如果想要安装比较新的dev分支，可以</span><br><span class="line">git clone -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><details class="toggle" ><summary class="toggle-button" style="">Butterfly安装方法</summary><div class="toggle-content"><p>在你的博客根目录里</p><p>git clone -b master <a href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes&#x2F;Butterfly</p><p>如果想要安装比较新的dev分支，可以</p><p>git clone -b dev <a href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes&#x2F;Butterfly</p></div></details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><code>inline</code>在文本里面添加按钮隐藏内容，只限文字</p><p>( content不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideInline content,display,bg,color %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>content: 文本内容</p></li><li><p>display: 按钮显示的文字(可选)</p></li><li><p>bg: 按钮的背景颜色(可选)</p></li><li><p>color: 按钮文字的颜色(可选)</p></li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">哪个英文字母最酷？ &#123;% hideInline 因为西装裤(C装酷),查看答案,#FF7242,#fff %&#125;</span><br><span class="line"></span><br><span class="line">门里站着一个人? &#123;% hideInline 闪 %&#125;</span><br></pre></td></tr></table></figure><p>哪个英文字母最酷？ <span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案<br>  </button><span class="hide-content">因为西装裤(C装酷)</span></span></p><p>门里站着一个人? <span class="hide-inline"><button type="button" class="hide-button" style="">Click<br>  </button><span class="hide-content">闪</span></span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>block</code>独立的block隐藏内容，可以隐藏很多内容，包括图片，代码块等等</p><p>( display 不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>content: 文本内容</p></li><li><p>display: 按钮显示的文字(可选)</p></li><li><p>bg: 按钮的背景颜色(可选)</p></li><li><p>color: 按钮文字的颜色(可选)</p></li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查看答案</span><br><span class="line">&#123;% hideBlock 查看答案 %&#125;</span><br><span class="line">傻子，怎么可能有答案</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><p>查看答案</p><div class="hide-block"><button type="button" class="hide-button" style="">查看答案    </button><div class="hide-content"><p>傻子，怎么可能有答案</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn [url],[text],[icon],[color] [style] [layout] [position] [size] %&#125;</span><br><span class="line"></span><br><span class="line">[url]         : 链接</span><br><span class="line">[text]        : 按钮文字</span><br><span class="line">[icon]        : [可选] 图标</span><br><span class="line">[color]       : [可选] 按钮背景顔色(默认style时）</span><br><span class="line"><span class="code">                      按钮字体和边框顔色(outline时)</span></span><br><span class="line"><span class="code">                      default/blue/pink/red/purple/orange/green</span></span><br><span class="line"><span class="code">[style]       : [可选] 按钮样式 默认实心</span></span><br><span class="line"><span class="code">                      outline/留空</span></span><br><span class="line"><span class="code">[layout]      : [可选] 按钮佈局 默认为line</span></span><br><span class="line"><span class="code">                      block/留空</span></span><br><span class="line"><span class="code">[position]    : [可选] 按钮位置 前提是设置了layout为block 默认为左边</span></span><br><span class="line"><span class="code">                      center/right/留空</span></span><br><span class="line"><span class="code">[size]        : [可选] 按钮大小</span></span><br><span class="line"><span class="code">                      larger/留空</span></span><br></pre></td></tr></table></figure><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">demo1</button></li><li class="tab"><button type="button" data-href="#tab-1-2">demo2</button></li><li class="tab"><button type="button" data-href="#tab-1-3">demo3</button></li><li class="tab"><button type="button" data-href="#tab-1-4">demo4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流 %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,larger %&#125;</span><br></pre></td></tr></table></figure><p>This is my website, click the button <a class="btn-beautify " href="https://blog.panghai.top/"   title="心流"><span>心流</span></a><br>This is my website, click the button <a class="btn-beautify " href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://blog.panghai.top/"   title="心流"><span>心流</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><br>This is my website, click the button <a class="btn-beautify larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,block %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,block center larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,block right outline larger %&#125;</span><br></pre></td></tr></table></figure><p><a class="btn-beautify block" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><br><a class="btn-beautify block center larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><br><a class="btn-beautify block right outline larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,green larger %&#125;</span><br></pre></td></tr></table></figure><p><a class="btn-beautify larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify blue larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify pink larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify red larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify purple larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify orange larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify green larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-center&quot;</span>&gt;</span></span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.panghai.top/&#x27;,心流,far fa-hand-point-right,outline green larger %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="btn-center"><a class="btn-beautify outline larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline blue larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline pink larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline red larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline purple larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline orange larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a><a class="btn-beautify outline green larger" href="https://blog.panghai.top/"   title="心流"><i class="far fa-hand-point-right"></i><span>心流</span></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="inlineImg"><a href="#inlineImg" class="headerlink" title="inlineImg"></a>inlineImg</h3><p>主题中的图片都是默认以<code>块级元素</code>显示，如果你想以<code>内联元素</code>显示，可以使用这个标签外挂。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineImg [src] [height] %&#125;</span><br><span class="line"></span><br><span class="line">[src]      :    图片链接</span><br><span class="line">[height]   ：   图片高度限制【可选】</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><p>必应每日壁纸</p><p><img src="http://bing.panghai.top/php/today.php" alt="必应每日壁纸"></p><p>我觉得很好看 <img class="inline-img" src="https://blog.panghai.top/img/avatar.png" style="height:150px"/></p><h3 id="label"><a href="#label" class="headerlink" title="label"></a>label</h3><p>高亮所需的文字</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% label text color %&#125;</span><br></pre></td></tr></table></figure><ul><li>text：文字</li><li>color：【可选】背景颜色，默认为 default（default&#x2F;blue&#x2F;pink&#x2F;red&#x2F;purple&#x2F;orange&#x2F;green）</li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">臣亮言：&#123;% label 先帝 %&#125;创业未半，而&#123;% label 中道崩殂 blue %&#125;。今天下三分，&#123;% label 益州疲敝 pink %&#125;，此诚&#123;% label 危急存亡之秋 red %&#125;也！然侍衞之臣，不懈于内；&#123;% label 忠志之士 purple %&#125;，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。</span><br><span class="line">宫中、府中，俱为一体；陟罚臧否，不宜异同。若有&#123;% label 作奸 orange %&#125;、&#123;% label 犯科 green %&#125;，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</span><br></pre></td></tr></table></figure><p>臣亮言：<mark class="hl-label default">先帝</mark> 创业未半，而<mark class="hl-label blue">中道崩殂</mark> 。今天下三分，<mark class="hl-label pink">益州疲敝</mark> ，此诚<mark class="hl-label red">危急存亡之秋</mark> 也！然侍衞之臣，不懈于内；<mark class="hl-label purple">忠志之士</mark> ，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。<br>宫中、府中，俱为一体；陟罚臧否，不宜异同。若有<mark class="hl-label orange">作奸</mark> 、<mark class="hl-label green">犯科</mark> ，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</p><h3 id="timeline"><a href="#timeline" class="headerlink" title="timeline"></a>timeline</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline title,color %&#125;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><ul><li>text：标题&#x2F;时间线</li><li>color：timeline 颜色，default(留空) （blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green）</li></ul><div class="note info no-icon flat"><p>例子</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">留空</button></li><li class="tab"><button type="button" data-href="#tab-1-2">blue</button></li><li class="tab"><button type="button" data-href="#tab-1-3">pink</button></li><li class="tab"><button type="button" data-href="#tab-1-4">red</button></li><li class="tab"><button type="button" data-href="#tab-1-5">purple</button></li><li class="tab"><button type="button" data-href="#tab-1-6">orange</button></li><li class="tab"><button type="button" data-href="#tab-1-7">green</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022 %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline undefined"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,blue %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,pink %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline pink"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,red%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline red"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,purple%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline purple"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,orange%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline orange"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,green%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline green"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="flink"><a href="#flink" class="headerlink" title="flink"></a>flink</h3><p>可在任何界面插入类似友情链接列表效果</p><p>内容格式与友情链接界面一样，支持 yml 格式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line">xxxxxx</span><br><span class="line">&#123;% endflink %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> class<span class="emphasis">_name: 友情链接</span></span><br><span class="line"><span class="emphasis">  class_</span>desc: 博主</span><br><span class="line">  link<span class="emphasis">_list:</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">  - name: 心流</span></span><br><span class="line"><span class="emphasis">    link: https://blog.panghai.top</span></span><br><span class="line"><span class="emphasis">    avatar: https://blog.panghai.top/img/avatar.png</span></span><br><span class="line"><span class="emphasis">    descr: 保持谨慎，保持乐观</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">- class_</span>name: 特别鸣谢</span><br><span class="line">  class<span class="emphasis">_desc: 博客框架及主题</span></span><br><span class="line"><span class="emphasis">  link_</span>list:</span><br><span class="line"></span><br><span class="line"><span class="bullet">  -</span> name: Hexo</span><br><span class="line"><span class="code">    link: https://hexo.io/zh-tw/</span></span><br><span class="line"><span class="code">    avatar: https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line"><span class="code">    descr: 快速、簡單且強大的網誌框架</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="bullet">  -</span> name: Butterfly</span><br><span class="line"><span class="code">    link: https://butterfly.js.org/</span></span><br><span class="line"><span class="code">    avatar: https://butterfly.js.org/img/avatar.png</span></span><br><span class="line"><span class="code">    descr: A Simple and Card UI Design theme for Hexo</span></span><br><span class="line"><span class="code">&#123;% endflink %&#125;</span></span><br></pre></td></tr></table></figure><div class="flink"><div class="flink-name">友情链接</div><div class="flink-desc">博主</div> <div class="flink-list">          <div class="flink-list-item">            <a href="https://blog.panghai.top" title="心流" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://blog.panghai.top/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="心流" />              </div>              <div class="flink-item-name">心流</div>               <div class="flink-item-desc" title="保持谨慎，保持乐观">保持谨慎，保持乐观</div>            </a>          </div></div><div class="flink-name">特别鸣谢</div><div class="flink-desc">博客框架及主题</div> <div class="flink-list">          <div class="flink-list-item">            <a href="https://hexo.io/zh-tw/" title="Hexo" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Hexo" />              </div>              <div class="flink-item-name">Hexo</div>               <div class="flink-item-desc" title="快速、簡單且強大的網誌框架">快速、簡單且強大的網誌框架</div>            </a>          </div>          <div class="flink-list-item">            <a href="https://butterfly.js.org/" title="Butterfly" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://butterfly.js.org/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Butterfly" />              </div>              <div class="flink-item-name">Butterfly</div>               <div class="flink-item-desc" title="A Simple and Card UI Design theme for Hexo">A Simple and Card UI Design theme for Hexo</div>            </a>          </div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">標籤外掛（Tag-Plugins）</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> 博客使用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：进阶教程</title>
      <link href="/posts/c90c/"/>
      <url>/posts/c90c/</url>
      
        <content type="html"><![CDATA[<div class="note info icon-padding flat"><i class="note-icon falt"></i><p>不要把个人需要的文件&#x2F;图片放在主题<code>source</code>文件夹里，因为在升级主题的过程中，可能会把文件覆盖删除了。<br>在Hexo根目录的<code>source</code>文件夹里，创建一个文件夹来放置个人文件&#x2F;图片。引用文件直接为<code>/文件夹名称/文件名</code></p></div><h2 id="自定义图标"><a href="#自定义图标" class="headerlink" title="自定义图标"></a>自定义图标</h2><p>Butterfly主题内置了<a href="https://fontawesome.com/">Font Awesome V5</a> 图标，目前已更新到 5.13.0，总共有1,588个免费图标。由于是国外的图标网站，对于国内的一些网站Icon并不支持。如有需要，你可以引入其它的图标服务商。下面介绍<a href="https://www.iconfont.cn/">iconfont-阿里巴巴矢量图标库</a>引入自定义icon</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">注册iconfont账号</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加图标入库</button></li><li class="tab"><button type="button" data-href="#tab-1-3">生成CSS链接</button></li><li class="tab"><button type="button" data-href="#tab-1-4">添加链接进主题配置文件</button></li><li class="tab"><button type="button" data-href="#tab-1-5">添加博客样式文件</button></li><li class="tab"><button type="button" data-href="#tab-1-6">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/c90c/20220821134948.png" alt="iconfont登录页"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>搜索想要的图标，添加到购物车并添加到项目（没有新建一个）</p><p><img src="/../img/c90c/1661061219224.png" alt="iconfont添加图标入库"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>添加成功后跳转到我的项目中，点击Font class，点击生成在线链接</p><p><img src="/../img/c90c/1661061695967.png" alt="iconfont生成CSS链接"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>打开<code>_config.butterfly.yml</code>，找到inject配置，按要求把链接填入</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_3587689_u063afxcp1.css&quot;&gt;</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>在我们需要使用的地方填入icon，例如icon-Bing，图片使用格式为iconfont icon名字，我的社交图标配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">iconfont icon-github:</span> <span class="string">https://gitee.com/pgh1038/panghai.top</span> <span class="string">||</span> <span class="string">Github</span></span><br><span class="line">  <span class="attr">iconfont icon-bilibili-line:</span> <span class="string">https://space.bilibili.com/334851399</span> <span class="string">||</span> <span class="string">bilibili</span></span><br><span class="line">  <span class="attr">iconfont icon-gitee-fill-round:</span> <span class="string">https://gitee.com/pgh1038</span> <span class="string">||</span> <span class="string">Gitee</span></span><br><span class="line">  <span class="attr">iconfont icon-csdn:</span> <span class="string">https://blog.csdn.net/qq_46231952</span> <span class="string">||</span> <span class="string">CSDN</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>因为第三方图标样式可能和主题内置图标样式不一致，需要修改：</p><p>新建<code>博客根目录/source/css/blog.panghai.top.css</code>，<code>blog.panghai.top.css</code>这里修改为你自己的网站，样式文件内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 第三方图标样式 */</span></span><br><span class="line"><span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_3587689_u063afxcp1.css&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/blog.panghai.top.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p><img src="/../img/c90c/1660999518197.png" alt="社交图标"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">生成音乐页面</button></li><li class="tab"><button type="button" data-href="#tab-1-3">修改配置</button></li><li class="tab"><button type="button" data-href="#tab-1-4">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">--save</span> hexo<span class="literal">-tag-aplayer</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page music</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>插件会在每一个文件都插入 js 和 css，为了避免重复插入，修改<code>_config.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>然后在你需要使用aplayer的页面<code>Front-matter</code>添加</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplayer: true</span><br></pre></td></tr></table></figure><p>这样只会在需要aplayer的页面插入js和css。在音乐页面使用以下语句即可展示音乐播放器：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% meting &quot;8594368955&quot; &quot;tencent&quot; &quot;playlist&quot; %&#125;</span><br></pre></td></tr></table></figure><p>music&#x2F;index.md配置示例：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">音乐</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-05 23:50:30</span></span><br><span class="line"><span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">aplayer:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">&lt;font</span> <span class="string">color=#0c74d6</span> <span class="string">size=3</span> <span class="string">face=&quot;黑体&quot;&gt;**喜欢的英文歌**&lt;/font&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&lt;!--</span> <span class="string">Simple</span> <span class="string">example</span> <span class="string">(songid,</span> <span class="string">server,</span> <span class="string">type)</span>  <span class="string">--&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">meting</span> <span class="string">&quot;8594368955&quot;</span> <span class="string">&quot;tencent&quot;</span> <span class="string">&quot;playlist&quot;</span> <span class="string">%</span>&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p><img src="/../img/c90c/1661066831569.png" alt="音乐"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="全局吸底Aplayer"><a href="#全局吸底Aplayer" class="headerlink" title="全局吸底Aplayer"></a>全局吸底Aplayer</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">修改配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-3">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span> <span class="comment">#为了防止插入重复的资源，需要把asset_inject设为false</span></span><br></pre></td></tr></table></figure><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject the css and script (aplayer/meting)</span></span><br><span class="line"><span class="attr">aplayerInject:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;8594368955&quot;</span> <span class="string">data-server=&quot;tencent&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">data-lrctype=&quot;1&quot;&gt;</span> <span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>Aplayer html参数解释</p><table><thead><tr><th align="center">option</th><th align="center">default</th><th align="center">description</th></tr></thead><tbody><tr><td align="center">data-id</td><td align="center">require</td><td align="center">song id &#x2F; playlist id &#x2F; album id &#x2F; search keyword</td></tr><tr><td align="center">data-server</td><td align="center">require</td><td align="center">music platform: netease, tencent, kugou, xiami, baidu</td></tr><tr><td align="center">data-type</td><td align="center">require</td><td align="center">song, playlist, album, search, artist</td></tr><tr><td align="center">data-fixed</td><td align="center">false</td><td align="center">enable fixed mode</td></tr><tr><td align="center">data-mini</td><td align="center">false</td><td align="center">enable mini mode</td></tr><tr><td align="center">data-autoplay</td><td align="center">false</td><td align="center">audio autoplay</td></tr><tr><td align="center">data-theme</td><td align="center">#2980b9</td><td align="center">main color</td></tr><tr><td align="center">data-loop</td><td align="center">all</td><td align="center">player loop play, values: ‘all’, ‘one’, ‘none’</td></tr><tr><td align="center">data-order</td><td align="center">list</td><td align="center">player play order, values: ‘list’, ‘random’</td></tr><tr><td align="center">data-preload</td><td align="center">auto</td><td align="center">values: ‘none’, ‘metadata’, ‘auto’</td></tr><tr><td align="center">data-volume</td><td align="center">0.7</td><td align="center">default volume, notice that player will remember user setting, default volume will not work after user set volume themselves</td></tr><tr><td align="center">data-mutex</td><td align="center">true</td><td align="center">prevent to play multiple player at the same time, pause other players when this player start play</td></tr><tr><td align="center">data-lrctype</td><td align="center">0</td><td align="center">lyric type</td></tr><tr><td align="center">data-listfolded</td><td align="center">false</td><td align="center">indicate whether list should folded at first</td></tr><tr><td align="center">data-listmaxheight</td><td align="center">340px</td><td align="center">list max height</td></tr><tr><td align="center">data-storagename</td><td align="center">metingjs</td><td align="center">localStorage key that store player setting</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>运行 Hexo 就可以看到网页左下角出现了 <code>Aplayer</code></p><p><img src="/../img/c90c/1661069224995.png" alt="全局Aplayer吸底"></p><p>最后，如果你想切换页面时，音乐不会中断。请把主题配置文件的<code>pjax</code>设为 <code>true</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏电子时钟（弃用）"><a href="#侧边栏电子时钟（弃用）" class="headerlink" title="侧边栏电子时钟（弃用）"></a>侧边栏电子时钟（弃用）</h2><div class="note warning flat"><p>为简洁画面，已弃用</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-electric-clock</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">electric_clock:</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sticky_layout</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">temple_html:</span> <span class="string">&#x27;&lt;div class=&quot;card-widget card-clock&quot;&gt;&lt;div class=&quot;card-glass&quot;&gt;&lt;div class=&quot;card-background&quot;&gt;&lt;div class=&quot;card-content&quot;&gt;&lt;div id=&quot;hexo_electric_clock&quot;&gt;&lt;img id=&quot;card-clock-loading&quot; src=&quot;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif&quot; style=&quot;height: 120px; width: 100%;&quot; data-ll-status=&quot;loading&quot; class=&quot;entered loading&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示时钟，需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载electric_clock，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/../img/c90c/1661069035691.png" alt="侧边栏电子时钟"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏Git贡献"><a href="#侧边栏Git贡献" class="headerlink" title="侧边栏Git贡献"></a>侧边栏Git贡献</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-githubcalendar</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># githubcalendar</span></span><br><span class="line"><span class="comment"># github近期代码贡献度</span></span><br><span class="line"><span class="comment"># https://github.com/Zfour/hexo-github-calendar</span></span><br><span class="line"><span class="attr">githubcalendar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/about/</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">flow2000</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">github_calendar</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">githubcalendar_html:</span> <span class="string">&#x27;&lt;div class=&quot;recent-post-item&quot; style=&quot;width:100%;height:auto;padding:10px;&quot;&gt;&lt;div id=&quot;github_loading&quot; style=&quot;width:10%;height:100%;margin:0 auto;display: block&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  viewBox=&quot;0 0 50 50&quot; style=&quot;enable-background:new 0 0 50 50&quot; xml:space=&quot;preserve&quot;&gt;&lt;path fill=&quot;#d0d0d0&quot; d=&quot;M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z&quot; transform=&quot;rotate(275.098 25 25)&quot;&gt;&lt;animateTransform attributeType=&quot;xml&quot; attributeName=&quot;transform&quot; type=&quot;rotate&quot; from=&quot;0 25 25&quot; to=&quot;360 25 25&quot; dur=&quot;0.6s&quot; repeatCount=&quot;indefinite&quot;&gt;&lt;/animateTransform&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div id=&quot;github_container&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">  <span class="attr">pc_minheight:</span> <span class="string">280px</span></span><br><span class="line">  <span class="attr">mobile_minheight:</span> <span class="string">0px</span></span><br><span class="line">  <span class="comment"># 以下色调选择喜欢的一行保留即可。其余注释。—————akilar的糖果色</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#fdcdec&#x27;, &#x27;#fc9bd9&#x27;, &#x27;#fa6ac5&#x27;, &#x27;#f838b2&#x27;, &#x27;#f5089f&#x27;, &#x27;#c4067e&#x27;, &#x27;#92055e&#x27;, &#x27;#540336&#x27;, &#x27;#48022f&#x27;, &#x27;#30021f&#x27;]&quot; #浅紫色调</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#f0fff4&#x27;, &#x27;#dcffe4&#x27;, &#x27;#bef5cb&#x27;, &#x27;#85e89d&#x27;, &#x27;#34d058&#x27;, &#x27;#28a745&#x27;, &#x27;#22863a&#x27;, &#x27;#176f2c&#x27;, &#x27;#165c26&#x27;, &#x27;#144620&#x27;]&quot; #翠绿色调</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;[&#x27;#ebedf0&#x27;, &#x27;#f1f8ff&#x27;, &#x27;#dbedff&#x27;, &#x27;#c8e1ff&#x27;, &#x27;#79b8ff&#x27;, &#x27;#2188ff&#x27;, &#x27;#0366d6&#x27;, &#x27;#005cc5&#x27;, &#x27;#044289&#x27;, &#x27;#032f62&#x27;, &#x27;#05264c&#x27;]&quot;</span> <span class="comment">#天青色调</span></span><br><span class="line">  <span class="comment"># 如果想搭建自用 api，具体的部署方案可看考 python_github_calendar_api 及 python_gitee_calendar_api 的文档说明</span></span><br><span class="line">  <span class="attr">api:</span> <span class="string">https://python-github-calendar-api-eta.vercel.app/api</span></span><br><span class="line">  <span class="comment"># api: https://python-gitee-calendar-api.vercel.app/api</span></span><br><span class="line">  <span class="attr">calendar_js:</span> <span class="string">https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js</span></span><br><span class="line">  <span class="attr">plus_style:</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>user</td><td>你的 github 或者 gitee 用户名</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr><tr><td>pc_minheight</td><td>电脑端插件的最小高度，减少加载带来的视觉偏移</td></tr><tr><td>mobile_minheight</td><td>手机端插件的最小高度，减少加载带来的视觉偏移</td></tr><tr><td>color</td><td>calendar 的主题色</td></tr><tr><td>api</td><td>获取贡献数据api</td></tr><tr><td>calendar_js</td><td>jsd 加速的 js，将 github calendar 挂载入容器中</td></tr><tr><td>plus_style</td><td>提供可自定义的 style</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示git贡献，在md文件填写以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">id</span>=<span class="string">&quot;github_calendar&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载githubcalendar，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/../img/c90c/1661071250725.png" alt="侧边栏Git贡献"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏历史上的今天（弃用）"><a href="#侧边栏历史上的今天（弃用）" class="headerlink" title="侧边栏历史上的今天（弃用）"></a>侧边栏历史上的今天（弃用）</h2><div class="note warning flat"><p>为简洁画面，已弃用</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-history-calendar</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 历史上的今天</span></span><br><span class="line"><span class="attr">history_calendar:</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">4</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/share/</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">history_calendar</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">temple_html:</span> <span class="string">&#x27;&lt;div class=&quot;card-widget card-history&quot;&gt;&lt;div class=&quot;card-content&quot;&gt;&lt;div class=&quot;item-headline&quot;&gt;&lt;i class=&quot;fas fa-clock fa-spin&quot;&gt;&lt;/i&gt;&lt;span&gt;那年今日&lt;/span&gt;&lt;/div&gt;&lt;div id=&quot;history-baidu&quot; style=&quot;height: 100px;overflow: hidden&quot;&gt;&lt;div class=&quot;history_swiper-container&quot; id=&quot;history-container&quot; style=&quot;width: 100%;height: 100%&quot;&gt;&lt;div class=&quot;swiper-wrapper&quot; id=&quot;history_container_wrapper&quot; style=&quot;height:20px&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr><tr><td>temple_html</td><td>包含挂载容器</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示历史上的今天，复制以下内容到md文件即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">id</span>=<span class="string">&quot;history_calendar&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载githubcalendar，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/../img/c90c/1661071700457.png" alt="侧边栏历史上的今天"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏访问统计"><a href="#侧边栏访问统计" class="headerlink" title="侧边栏访问统计"></a>侧边栏访问统计</h2><div class="note info flat"><p>建议使用最新版本：<a href="/posts/b20a/#%E6%B7%BB%E5%8A%A0%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1">Butterfly 博客优化</a></p></div><p>思路：自定义侧边栏，使用<a href="https://v6.51.la/">51.LA网站统计V6</a>数据挂件作为访问统计的数据源</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装统计代码</button></li><li class="tab"><button type="button" data-href="#tab-1-2">编辑数据挂件样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">自定义侧边栏</button></li><li class="tab"><button type="button" data-href="#tab-1-4">博主的配置</button></li><li class="tab"><button type="button" data-href="#tab-1-5">某些情况下widget失效</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>注册<a href="https://v6.51.la/">51.LA网站统计V6</a>，添加域名后，选择普通安装：</p><p><img src="/../img/c90c/1661689097799.png" alt="51.LA网站统计V6"></p><p>编辑<code>_config.butterfly.yml</code>添加自己的统计代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">charset=&quot;UTF-8&quot;</span> <span class="string">id=&quot;LA_COLLECT&quot;</span> <span class="string">src=&quot;//sdk.51.la/js-sdk-pro.min.js&quot;&gt;&lt;/script&gt;</span>     <span class="comment"># 网站统计V6安装代码</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script&gt;LA.init(&#123;id:&quot;JnHw7yNkc1XsvRUB&quot;,ck:&quot;JnHw7yNkc1XsvRUB&quot;&#125;)&lt;/script&gt;</span>                   <span class="comment"># 网站统计V6安装代码</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>添加代码并检测成功后进入<code>配置</code>-&gt;<code>参数设置</code>-&gt;<code>数据挂件</code>，开启挂件功能，按需求编辑样式：</p><p><img src="/../img/c90c/1661689515833.png" alt="编辑数据挂件样式"></p><p>复制代码：</p><p><img src="/../img/c90c/1661689661073.png"></p><p>可使用博主的挂件样式，只需修改<code>JnHw7yNkc1XsvRUB</code>为您的网站的值即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">&quot;LA-DATA-WIDGET&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://v6-widget.51.la/v6/JnHw7yNkc1XsvRUB/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>在Hexo博客目录中的<code>source/_data</code>（如果没有 _data 文件夹，请自行创建），创建一个文件 <code>widget.yml</code></p><p>格式：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">html:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">order:</span></span><br><span class="line">    <span class="attr">html:</span></span><br></pre></td></tr></table></figure><div class="note info icon-padding flat"><i class="note-icon falt"></i><p>参数讲解</p></div><p>top: 创建的 widget 会出现在非 sticky 区域（即所有页面都会显示)</p><p>bottom: 创建的 widget 会出现在 sticky 区域（除了文章页都会显示)</p><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">class_name</td><td align="center">所创建的 widget 父类 class 名 （可选）</td></tr><tr><td align="center">id_name</td><td align="center">所创建的 widget 父类 id 名（可选）</td></tr><tr><td align="center">name</td><td align="center">所创建的 widget 标题</td></tr><tr><td align="center">icon</td><td align="center">所创建的 widget 图标</td></tr><tr><td align="center">order</td><td align="center">所创建的 widget 排序 （可选）</td></tr><tr><td align="center">html</td><td align="center">所创建的 widget 相关代码</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>博主的<code>widget.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">id_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&#x27;&lt;div desc=&quot;我是墙&quot; class=&quot;sticky_layout&quot;&gt;&lt;div desc=&quot;我是画框&quot;&gt;&lt;div desc=&quot;我是纸&quot;&gt;&lt;script id=&quot;LA-DATA-WIDGET&quot; charset=&quot;UTF-8&quot; src=&quot;https://v6-widget.51.la/v6/JnHw7yNkc1XsvRUB/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;&gt;&lt;/script&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p>注意：</p><p><code>iconfont icon-tongji</code>是博主在<a href="https://www.iconfont.cn/">iconfont-阿里巴巴矢量图标库</a>设置的图标，详情<a href="/posts/c90c/#%E8%87%AA%E5%AE%9A%E4%B9%89Iocn">点击这里</a></p><p><code>html</code>中博主添加一些代码防止某些情况无法加载：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span>统计代码<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>版本：<code>Butterfly4.4.0</code> <code>Hexo6.2.0</code></p><p><code>widget.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">id_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&#x27;&lt;script id=&quot;LA-DATA-WIDGET&quot; charset=&quot;UTF-8&quot; src=&quot;https://v6-widget.51.la/v6/JnHw7yNkc1XsvRUB/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;&gt;&lt;/script&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>_config.butterfly.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># toc (文章目录)</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span> <span class="comment"># 对文章页是否有效</span></span><br><span class="line">  <span class="attr">page:</span> <span class="literal">false</span> <span class="comment"># 对页面是否有效</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span> <span class="comment"># 是否展示章节数</span></span><br><span class="line">  <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># 是否展开</span></span><br><span class="line">  <span class="attr">style_simple:</span> <span class="literal">true</span> <span class="comment"># for post 开启简洁模式</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Pjax</span></span><br><span class="line"><span class="comment"># It may contain bugs and unstable, give feedback when you find the bugs.</span></span><br><span class="line"><span class="comment"># https://github.com/MoOx/pjax</span></span><br><span class="line"><span class="attr">pjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br></pre></td></tr></table></figure><p><code>Front-matter</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Butterfly博客搭建（进阶教程）</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="string">c90c</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-21 11:24:41</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">本教程是Butterfly的进阶教程，用于增加博客的多样性，提升美感。</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">Butterfly搭建教程</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">&#x27;https://bing.panghai.top/php/random.php?random=3&amp;cover=true&#x27;</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">sticky:</span> <span class="number">99</span></span><br><span class="line"><span class="attr">toc:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">toc_number:</span> <span class="literal">true</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>过程：点击文章页，从文章页点击导航栏的主页，访问统计侧边栏会失效：</p><p><img src="/../img/c90c/1661691422377.png" alt="访问统计侧边栏失效情况"></p><p>解决方法：</p><p><code>widget.yml</code>的<code>html</code>中修改代码为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span>统计代码<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h2><p>Butterfly主题需要使用到很多图片。如果图片太大，会严重拖慢网站的加载速度。</p><p>图片压缩能够有效的缓解这个问题。</p><p>除了通过<code>gulp-imagemin</code>来压缩图片，还可以通过在线压缩网站和软件来进行压缩。网上有很多这样的工具，挑选一款适合自己的就行。</p><ul><li><a href="https://tinypng.com/">tinypng</a></li></ul><p>一个在线压缩的网站。压缩后的图片也保留了很高的质量，在知乎上很多人推荐，不过免费版有限制。</p><p><img src="/../img/c90c/1661074081876.png" alt="tinypng"></p><ul><li><a href="https://saerasoft.com/caesium/">caesium</a></li><li><a href="https://github.com/marketplace/imgbot">imgbot</a></li></ul><p>imgbot 是一款 Github 插件。</p><p>安装后，你上传图片到 Github 去，imgbot 会自动压缩图片并推送 PR，我们只需要合併 PR 就行</p><p>你可以配置 imgbot 的侦测方法、压缩方法（有损&#x2F;无损），具体可以查看插件的文档</p><h2 id="插件推荐"><a href="#插件推荐" class="headerlink" title="插件推荐"></a>插件推荐</h2><h3 id="hexo-abbrlink"><a href="#hexo-abbrlink" class="headerlink" title="hexo-abbrlink"></a><a href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a></h3><p>可以把链接permalink转为数字的插件，配置容易，生成时自动转为数字。</p><h3 id="hexo-generator-feed"><a href="#hexo-generator-feed" class="headerlink" title="hexo-generator-feed"></a><a href="https://github.com/hexojs/hexo-generator-feed">hexo-generator-feed</a></h3><p>生成RSS文件的插件</p><h3 id="hexo-filter-nofollow"><a href="#hexo-filter-nofollow" class="headerlink" title="hexo-filter-nofollow"></a><a href="https://github.com/hexojs/hexo-filter-nofollow">hexo-filter-nofollow</a></h3><p>为网站使用到的所有外链添加rel&#x3D;”noopener external nofollow noreferrer”, 可以有效地加强网站SEO和防止权重流失</p><h3 id="hexo-generator-sitemap"><a href="#hexo-generator-sitemap" class="headerlink" title="hexo-generator-sitemap"></a><a href="https://github.com/hexojs/hexo-generator-sitemap">hexo-generator-sitemap</a></h3><p>生成sitemap的插件</p><h3 id="hexo-generator-baidu-sitemap"><a href="#hexo-generator-baidu-sitemap" class="headerlink" title="hexo-generator-baidu-sitemap"></a><a href="https://github.com/coneycode/hexo-generator-baidu-sitemap">hexo-generator-baidu-sitemap</a></h3><p>看名字就知道，是专门为百度生成sitemap的插件</p><h2 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h2><h3 id="Valine"><a href="#Valine" class="headerlink" title="Valine"></a>Valine</h3><p><a href="https://blog.csdn.net/weixin_34434736/article/details/113047474">https://blog.csdn.net/weixin_34434736/article/details/113047474</a></p><h3 id="Twikoo"><a href="#Twikoo" class="headerlink" title="Twikoo"></a>Twikoo</h3><p><a href="/posts/3f0b/">Twikoo 私有部署</a></p><p><a href="https://blog.leonus.cn/2022/inputAlert.html">给你的评论添加一个输入提醒吧 | Leonus</a></p><h2 id="在线聊天"><a href="#在线聊天" class="headerlink" title="在线聊天"></a>在线聊天</h2><p>看配置文件中的官方地址即可</p><h2 id="友链朋友圈"><a href="#友链朋友圈" class="headerlink" title="友链朋友圈"></a>友链朋友圈</h2><p><a href="https://fcircle-doc.yyyzyyyz.cn/#/deploy">项目部署</a></p><p><a href="https://fcircle-doc.yyyzyyyz.cn/#/frontenddeploy">前端部署</a></p><h2 id="收录"><a href="#收录" class="headerlink" title="收录"></a>收录</h2><p><a href="https://www.jianshu.com/p/7d3d87b52ad7">Hexo系列：（四）Hexo博客提交百度和Google收录 - 简书</a></p><p><a href="https://dora-cmon.github.io/posts/3b6da06d/">Hexo博客百度谷歌收录 | 哆啦 C 梦</a></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/posts/4073eda/#%E9%9F%B3%E6%A8%82">Butterfly 安裝文檔(六) 進階教程 | Butterfly</a></p><p><a href="https://butterfly.js.org/posts/507c070f/">Butterfly添加全局吸底Aplayer教程 | Butterfly</a></p><p><a href="https://zfe.space/post/hexo-githubcalendar.html">教程：hexo-githubcalendar 插件 1.0 | 小冰博客</a></p><p><a href="https://zfe.space/post/hexo-electric-clock.html">教程：hexo-electric-clock 电子时钟插件 | 小冰博客</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>市面上各种主流软件快捷键使用技巧</title>
      <link href="/posts/8a27/"/>
      <url>/posts/8a27/</url>
      
        <content type="html"><![CDATA[<h2 id="通用快捷键"><a href="#通用快捷键" class="headerlink" title="通用快捷键"></a>通用快捷键</h2><p>以下<code>+</code>号代表需要同时按下指定按键，例如<code>Ctrl+C</code>需要同时按下<code>Ctrl</code>和<code>C</code></p><p>复制全选粘贴剪切</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+C</span><br><span class="line">Ctrl+A</span><br><span class="line">Ctrl+V</span><br><span class="line">Ctrl+X</span><br></pre></td></tr></table></figure><p>搜索</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+F</span><br></pre></td></tr></table></figure><p>新增</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+N</span><br></pre></td></tr></table></figure><p>保存</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+S</span><br></pre></td></tr></table></figure><p>关闭</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+W</span><br></pre></td></tr></table></figure><p>撤回</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Z</span><br></pre></td></tr></table></figure><p>返回桌面</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Win+D</span><br></pre></td></tr></table></figure><p>打开文件资源管理器</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Win+E</span><br></pre></td></tr></table></figure><p>关闭当前应用程序</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Alt+F4</span><br></pre></td></tr></table></figure><p>打开任务管理器</p><p>笔记本电脑：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Shift+Esc</span><br></pre></td></tr></table></figure><p>台式电脑：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Alt+.</span><br></pre></td></tr></table></figure><h2 id="浏览器快捷键"><a href="#浏览器快捷键" class="headerlink" title="浏览器快捷键"></a>浏览器快捷键</h2><p>新增标签页</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+T</span><br></pre></td></tr></table></figure><p>打开历史记录</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+H</span><br></pre></td></tr></table></figure><p>当前网页添加书签</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+D</span><br></pre></td></tr></table></figure><p>显示&#x2F;隐藏书签</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Shift+B</span><br></pre></td></tr></table></figure><h2 id="Typora快捷键"><a href="#Typora快捷键" class="headerlink" title="Typora快捷键"></a>Typora快捷键</h2><p>快速定义标题，数字代表标题等级，例如<code>Ctrl+1</code>建立1级标题</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+1</span><br><span class="line">Ctrl+2</span><br><span class="line">Ctrl+3</span><br><span class="line">Ctrl+4</span><br><span class="line">Ctrl+5</span><br><span class="line">Ctrl+6</span><br></pre></td></tr></table></figure><p>快速插入表格</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+T</span><br></pre></td></tr></table></figure><p>快速插入链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+K</span><br></pre></td></tr></table></figure><p>IDEA快捷键</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 快捷命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：基础教程</title>
      <link href="/posts/447d/"/>
      <url>/posts/447d/</url>
      
        <content type="html"><![CDATA[<p><strong>Butterfly</strong>是一个界面生动，图文交互性强的Hexo主题，借鉴官方文档和其他博主搭建过程我创作了该教程，希望更多的人使用Butterfly来记录自己的生活。</p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>本教程更新于 2022 年 08 月 20 日，教程的内容针对hexo6.2.0 butterfly4.4.0，并且只介绍基础教程</p></div><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><ol><li>你已经安装了<a href="http://nodejs.cn/">Node.js</a>、<a href="https://www.runoob.com/git/git-tutorial.html">Git</a>、<a href="https://typoraio.cn/">Typora</a>等工具</li><li>你已经拥有github账号并且可以本地推送代码到远程仓库</li><li>你已经了解<a href="https://hexo.io/">Hexo</a>博客框架的使用方法了（使用Typora写博客、hexo部署博客）</li><li>你已经决定好想要优化博客的准备了</li></ol><h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><div class="tabs" id="tab1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab1-1">安装butterfly</button></li><li class="tab"><button type="button" data-href="#tab1-2">应用主题</button></li><li class="tab"><button type="button" data-href="#tab1-3">安装插件</button></li><li class="tab"><button type="button" data-href="#tab1-4">运行博客</button></li><li class="tab"><button type="button" data-href="#tab1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab1-1"><p>到hexo根目录打开cmd命令提示符</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="literal">-b</span> master https://github.com/jerryc127/hexo<span class="literal">-theme-butterfly</span>.git themes/butterfly</span><br></pre></td></tr></table></figure><p>如果超时执行另一个命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="literal">-b</span> master git@github.com:jerryc127/hexo<span class="literal">-theme-butterfly</span>.git themes/butterfly</span><br></pre></td></tr></table></figure><div class="note info modern"><p>这两个命令的区别是，一个是使用https协议，另一个使用ssh协议，目前国内访问github会被<a href="https://baike.baidu.com/item/DNS%E6%B1%A1%E6%9F%93/8620359">DNS污染</a>导致访问错误，因此拉取代码会超时，可以使用ssh协议代替https协议克隆代码</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-2"><p>在博客根目录打开网站配置文件 _config.yml，修改默认主题：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure><p>在博客根目录下复制主题配置文件<code>blog/themes/butterfly/_config.yml</code>并命名为<code>_config.butterfly.yml</code>，hexo会将<code>_config.butterfly.yml</code>覆盖默认主题配置文件，方便我们进行升级操作</p><div class="note info modern"><p>本教程没有修改主题源码的操作，请放心食用</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-3"><p>在博客根目录下执行：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-renderer-pug</span> hexo<span class="literal">-renderer-stylus</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-4"><p>hexo三连：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-5"><p><img src="/../img/447d/1660988777075.png" alt="运行效果"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info modern"><p>我们将博客根目录的配置文件称为<code>_config.yml</code>，将主题配置文件称为<code>_config.butterfly.yml</code></p></div><h2 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">基础信息设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">网站资料效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-3">网站页脚效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-4">参数解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在_config.yml设置网站资料：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">心流</span> </span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;个人技术分享博客&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;保持谨慎，保持乐观&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">&#x27;博客 Linux 算法 服务器&#x27;</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">心流</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span></span><br></pre></td></tr></table></figure><p>在_config.butterfly.yml设置网站页脚：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Footer Settings</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">since:</span> <span class="number">2022</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">href=&quot;https://wap.miit.gov.cn/&quot;</span> <span class="string">&gt;桂ICP备2021004373号-4&lt;/a&gt;</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="literal">true</span> <span class="comment"># Copyright of theme and framework</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/447d/1660999518197.png" alt="网站资料"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/../img/447d/1660999583130.png" alt="网站页脚"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>网站资料参数解释</p><table><thead><tr><th align="center">参数</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"><code>title</code></td><td align="center">网站标题</td></tr><tr><td align="center"><code>subtitle</code></td><td align="center">网站副标题</td></tr><tr><td align="center"><code>description</code></td><td align="center">网站描述</td></tr><tr><td align="center"><code>keywords</code></td><td align="center">网站的关键词。支持多个关键词。</td></tr><tr><td align="center"><code>author</code></td><td align="center">您的名字</td></tr><tr><td align="center"><code>language</code></td><td align="center">网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 <code>zh-Hans</code>和 <code>zh-CN</code>。</td></tr><tr><td align="center"><code>timezone</code></td><td align="center">网站时区。Hexo 默认使用您电脑的时区。请参考 <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">时区列表</a> 进行设置，如 <code>America/New_York</code>, <code>Japan</code>, 和 <code>UTC</code> 。一般的，对于中国大陆地区可以使用 <code>Asia/Shanghai</code>。</td></tr></tbody></table><p>其中，<code>description</code>主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。<code>author</code>参数用于主题显示文章的作者。</p><p>网站页脚参数解释</p><table><thead><tr><th align="center">参数</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"><code>since</code></td><td align="center">建立网站的年份。用于展示站点起始时间，位于页面最底部</td></tr><tr><td align="center"><code>custom_text</code></td><td align="center">位于页脚的自定义文本，支持HTML</td></tr><tr><td align="center"><code>copyright</code></td><td align="center">true展示hexo和butterfly的版权信息，false不展示</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="网站副标题"><a href="#网站副标题" class="headerlink" title="网站副标题"></a>网站副标题</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># the subtitle on homepage (主頁subtitle)</span></span><br><span class="line"><span class="attr">subtitle:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Typewriter Effect (打字效果)</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># loop (循環打字)</span></span><br><span class="line">  <span class="attr">loop:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># source 調用第三方服務</span></span><br><span class="line">  <span class="comment"># source: false 關閉調用</span></span><br><span class="line">  <span class="comment"># source: 1  調用一言網的一句話（簡體） https://hitokoto.cn/</span></span><br><span class="line">  <span class="comment"># source: 2  調用一句網（簡體） http://yijuzhan.com/</span></span><br><span class="line">  <span class="comment"># source: 3  調用今日詩詞（簡體） https://www.jinrishici.com/</span></span><br><span class="line">  <span class="comment"># subtitle 會先顯示 source , 再顯示 sub 的內容</span></span><br><span class="line">  <span class="attr">source:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># 如果關閉打字效果，subtitle 只會顯示 sub 的第一行文字</span></span><br><span class="line">  <span class="attr">sub:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">可控的事，保持谨慎；不可控的事，保持乐观</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">烟花许诺夜空，洒落繁星一片</span></span><br></pre></td></tr></table></figure><h2 id="导航菜单"><a href="#导航菜单" class="headerlink" title="导航菜单"></a>导航菜单</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">导航菜单设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">参数解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在_config.butterfly.yml设置网站导航菜单：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">站点</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-sitemap</span> <span class="string">||hide:</span></span><br><span class="line">    <span class="string">我的导航:</span> <span class="string">https://panghai.top</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-paper-plane</span></span><br><span class="line">    <span class="string">必应壁纸:</span> <span class="string">https://bing.panghai.top</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-Bing</span></span><br><span class="line">    <span class="string">站点状态:</span> <span class="string">https://status.panghai.top</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-heartbeat</span></span><br><span class="line">    <span class="string">旧博客:</span> <span class="string">https://next.panghai.top</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-folder</span></span><br><span class="line">  <span class="string">博文</span> <span class="string">||</span> <span class="attr">fa fa-bookmark:</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">生活</span> <span class="string">||</span> <span class="attr">fas fa-list:</span></span><br><span class="line">    <span class="string">分享:</span> <span class="string">/share/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-share-alt-square</span></span><br><span class="line">    <span class="string">音乐:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-music</span></span><br><span class="line">    <span class="string">图库:</span> <span class="string">/gallery/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-images</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/links/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="string">开往:</span> <span class="string">https://travellings.cn</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-train</span></span><br><span class="line">  <span class="string">虫洞:</span> <span class="string">http://foreverblog.cn/go.html</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-circle</span></span><br><span class="line">  <span class="string">留言板:</span> <span class="string">/comment/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-paper-plane</span></span><br><span class="line">  <span class="string">关于我:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-user</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>必须是 &#x2F;xxx&#x2F;，后面||分开，然后写图标名。因为已经内置了<a href="http://www.fontawesome.com.cn/">fontawesome</a>，可以去图标库选择合适图标，然后复制图标名称即可</p><p>如果不希望显示图标，图标名可不写。</p><p>效果展示</p><p><img src="/../img/447d/1661000468097.png" alt="导航菜单"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="导航页面"><a href="#导航页面" class="headerlink" title="导航页面"></a>导航页面</h2><p>有了导航，后面就是建立页面，首先建立下面三个基本页面</p><p>其他页面以此类推，不用加type:”xxx”</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">标签页</button></li><li class="tab"><button type="button" data-href="#tab-1-2">分类页</button></li><li class="tab"><button type="button" data-href="#tab-1-3">友链页</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在根目录cmd，使用以下命令建立标签页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>修改source&#x2F;tags&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 标签</span><br><span class="line">date: 2022-08-20 21:13:35</span><br><span class="line">type: &quot;tags&quot;</span><br></pre></td></tr></table></figure><div class="note info modern"><p>添加type:”xxx”是为了设置内置的标签页，分类页，友情链接，这些页面butterfly自带有，不需要我们单独设置</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在根目录cmd，使用以下命令建立分类页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>修改source&#x2F;categories&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 分类</span><br><span class="line">date: 2022-08-20 21:15:09</span><br><span class="line">type: &quot;categories&quot;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>在根目录cmd，使用以下命令建立友链页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page links</span><br></pre></td></tr></table></figure><p>修改source&#x2F;links&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 友链</span><br><span class="line">date: 2022-08-20 21:15:09</span><br><span class="line">type: &quot;links&quot;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="本地搜索"><a href="#本地搜索" class="headerlink" title="本地搜索"></a>本地搜索</h2><p>1、安装插件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-generator-search</span> <span class="string">--save</span></span><br></pre></td></tr></table></figure><p>修改_config.butterfly.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#是否启用</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">true</span> <span class="comment"># 是否预加载</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br></pre></td></tr></table></figure><h2 id="友情链接"><a href="#友情链接" class="headerlink" title="友情链接"></a>友情链接</h2><p>在Hexo博客目录中的source&#x2F;_data（如果没有 _data 文件夹，请自行创建），创建一个文件link.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">友情鏈接</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">博主</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">心流</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://blog.panghai.top</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://blog.panghai.top/img/avatar.png</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">保持谨慎，保持乐观</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">特别鸣谢</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">博客框架及主题</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hexo</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://hexo.io/zh-tw/</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">快速、簡單且強大的網誌框架</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Butterfly</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://butterfly.js.org/</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://butterfly.js.org/img/avatar.png</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">A</span> <span class="string">Simple</span> <span class="string">and</span> <span class="string">Card</span> <span class="string">UI</span> <span class="string">Design</span> <span class="string">theme</span> <span class="string">for</span> <span class="string">Hexo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - class_name: 友链</span></span><br><span class="line"><span class="comment">#   class_desc: 同道中人</span></span><br><span class="line"><span class="comment">#   link_list:</span></span><br><span class="line">    <span class="comment"># - name: </span></span><br><span class="line">    <span class="comment">#   link: </span></span><br><span class="line">    <span class="comment">#   avatar:</span></span><br><span class="line">    <span class="comment">#   descr:</span></span><br></pre></td></tr></table></figure><h2 id="404页面"><a href="#404页面" class="headerlink" title="404页面"></a>404页面</h2><p>主题内置了一个简单的404页面，可在设置中开启</p><div class="note info modern"><p>本地预览时，访问出错的网站是不会跳到404页面的。</p><p>如需本地预览，请访问<a href="http://localhost:4000/404.html">http://localhost:4000/404.html</a></p></div><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A simple 404 page</span></span><br><span class="line"><span class="attr">error_404:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">subtitle:</span> <span class="string">&quot;页面没有找到&quot;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">/img/404.png</span></span><br></pre></td></tr></table></figure><h2 id="社交图标"><a href="#社交图标" class="headerlink" title="社交图标"></a>社交图标</h2><p>Butterfly支持 <a href="https://fontawesome.com/icons?from=io">font-awesome v6</a>图标</p><p>书写格式 <code>图标名：url || 描述性文字</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fab fa-github:</span> <span class="string">https://github.com/xxxxx</span> <span class="string">||</span> <span class="string">Github</span></span><br><span class="line">  <span class="attr">fas fa-envelope:</span> <span class="string">mailto:xxxxxx@gmail.com</span> <span class="string">||</span> <span class="string">Email</span></span><br></pre></td></tr></table></figure><h2 id="图片设置"><a href="#图片设置" class="headerlink" title="图片设置"></a>图片设置</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">网站图标</button></li><li class="tab"><button type="button" data-href="#tab-1-2">网站头像</button></li><li class="tab"><button type="button" data-href="#tab-1-3">主页背景图</button></li><li class="tab"><button type="button" data-href="#tab-1-4">顶部默认图</button></li><li class="tab"><button type="button" data-href="#tab-1-5">文章封面图</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Favicon（网站图标）</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Avatar (头像)</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/avatar.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span> <span class="comment">#一直旋转头像</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The banner image of home page</span></span><br><span class="line"><span class="attr">index_img:</span> <span class="string">https://bing.panghai.top/php/today.php</span></span><br></pre></td></tr></table></figure><p>可使用我的api接口来生成背景图</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">https://bing.panghai.top/php/today.php</span> <span class="comment">#当天必应壁纸</span></span><br><span class="line"><span class="string">https://bing.panghai.top/php/random.php</span> <span class="comment">#随机必应壁纸</span></span><br></pre></td></tr></table></figure><p><img src="/../img/447d/1661002974057.png" alt="主页背景图"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># If the banner of page not setting, it will show the top_img</span></span><br><span class="line"><span class="attr">default_top_img:</span> <span class="string">https://bing.panghai.top/php/random.php</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cover:</span></span><br><span class="line">  <span class="comment"># 是否显示文章封面</span></span><br><span class="line">  <span class="attr">index_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">aside_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 封面显示的位置</span></span><br><span class="line">  <span class="comment"># 三个值可配置 left , right , both</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">both</span></span><br><span class="line">  <span class="comment"># 当文章Front-matter没有设置封面时，默认的封面显示</span></span><br><span class="line">  <span class="attr">default_cover:</span></span><br><span class="line">    <span class="string">https://bing.panghai.top/php/random.php</span></span><br><span class="line">    <span class="comment"># - https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg</span></span><br></pre></td></tr></table></figure><p><img src="/../img/447d/1661003560681.png" alt="文章封面图"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="大图查看"><a href="#大图查看" class="headerlink" title="大图查看"></a>大图查看</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Lightbox (圖片大圖查看模式)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="comment"># You can only choose one, or neither (只能選擇一個 或者 兩個都不選)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># medium-zoom</span></span><br><span class="line"><span class="comment"># https://github.com/francoischalifour/medium-zoom</span></span><br><span class="line"><span class="attr">medium_zoom:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fancybox</span></span><br><span class="line"><span class="comment"># http://fancyapps.com/fancybox/3/</span></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h2><p>安装<code>hexo-lazyload-image</code>模块</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-lazyload-image</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">loadingImg:</span> <span class="string">/img/loading.gif</span></span><br></pre></td></tr></table></figure><p><code>_config.butterfly.yml</code>配置也有图片懒加载：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Lazyload (圖片懶加載)</span></span><br><span class="line"><span class="comment"># https://github.com/verlok/vanilla-lazyload</span></span><br><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># site/post</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">/img/loading.gif</span></span><br><span class="line">  <span class="attr">blur:</span> <span class="literal">true</span> <span class="comment">#开启高斯模糊</span></span><br></pre></td></tr></table></figure><p>而且支持懒加载范围自定义和高斯模糊</p><h2 id="网站背景"><a href="#网站背景" class="headerlink" title="网站背景"></a>网站背景</h2><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Background effects (背景特效)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># canvas_ribbon (靜止彩帶背景)</span></span><br><span class="line"><span class="comment"># See: https://github.com/hustcc/ribbon.js</span></span><br><span class="line"><span class="attr">canvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">150</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span></span><br><span class="line">  <span class="attr">click_to_change:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Fluttering Ribbon (動態彩帶)</span></span><br><span class="line"><span class="attr">canvas_fluttering_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="右下角按钮"><a href="#右下角按钮" class="headerlink" title="右下角按钮"></a>右下角按钮</h2><h3 id="繁简转换"><a href="#繁简转换" class="headerlink" title="繁简转换"></a>繁简转换</h3><p>简体繁体互换，右下角会有简繁转换按钮。修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Bottom right button (右下角按鈕)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Conversion between Traditional and Simplified Chinese (簡繁轉換)</span></span><br><span class="line"><span class="attr">translate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># The text of a button</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">繁</span></span><br><span class="line">  <span class="comment"># the language of website (1 - Traditional Chinese/ 2 - Simplified Chinese）</span></span><br><span class="line">  <span class="attr">defaultEncoding:</span> <span class="number">2</span></span><br><span class="line">  <span class="comment"># Time delay</span></span><br><span class="line">  <span class="attr">translateDelay:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># The text of the button when the language is Simplified Chinese</span></span><br><span class="line">  <span class="attr">msgToTraditionalChinese:</span> <span class="string">&#x27;繁&#x27;</span></span><br><span class="line">  <span class="comment"># The text of the button when the language is Traditional Chinese</span></span><br><span class="line">  <span class="attr">msgToSimplifiedChinese:</span> <span class="string">&#x27;簡&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="夜间模式"><a href="#夜间模式" class="headerlink" title="夜间模式"></a>夜间模式</h3><p>右下角会有夜间模式按钮：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dark mode</span></span><br><span class="line"><span class="attr">darkmode:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Toggle Button to switch dark/light mode</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Switch dark/light mode automatically (自動切換 dark mode和 light mode)</span></span><br><span class="line">  <span class="comment"># autoChangeMode: 1  Following System Settings, if the system doesn&#x27;t support dark mode, it will switch dark mode between 6 pm to 6 am</span></span><br><span class="line">  <span class="comment"># autoChangeMode: 2  Switch dark mode between 6 pm to 6 am</span></span><br><span class="line">  <span class="comment"># autoChangeMode: false</span></span><br><span class="line">  <span class="attr">autoChangeMode:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p><code>autoChangeMode</code>: 1 跟随系统而变化，不支持的浏览器&#x2F;系统将按照时间晚上6点到早上6点之间切换为 dark mode</p><p><code>autoChangeMode</code>: 2 只按照时间 晚上6点到早上6点之间切换为 dark mode,其余时间为light mode</p><p><code>autoChangeMode</code>: false 取消自动切换</p><h3 id="阅读模式"><a href="#阅读模式" class="headerlink" title="阅读模式"></a>阅读模式</h3><p>阅读模式下会去掉除文章外的内容，避免干扰阅读。只会出现在文章页面，右下角会有閲读模式按钮。</p><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">readmode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="按钮排序"><a href="#按钮排序" class="headerlink" title="按钮排序"></a>按钮排序</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Don&#x27;t modify the following settings unless you know how they work (非必要请不要修改 )</span></span><br><span class="line"><span class="comment"># Choose: readmode,translate,darkmode,hideAside,toc,chat,comment</span></span><br><span class="line"><span class="comment"># Don&#x27;t repeat 不要重复</span></span><br><span class="line"><span class="attr">rightside_item_order:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="comment"># readmode,translate,darkmode,hideAside</span></span><br><span class="line">  <span class="attr">show:</span> <span class="comment"># toc,chat,comment</span></span><br></pre></td></tr></table></figure><h2 id="侧边栏设置"><a href="#侧边栏设置" class="headerlink" title="侧边栏设置"></a>侧边栏设置</h2><h3 id="主页侧边排版"><a href="#主页侧边排版" class="headerlink" title="主页侧边排版"></a>主页侧边排版</h3><p>只修改公告以及Github账号即可，其他不用修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># aside (側邊欄)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span> <span class="comment"># display on mobile</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span> <span class="comment"># left or right</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">archive:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">tag:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">category:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">card_author:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">description:</span> <span class="comment">#网站简介，可以覆盖站点配置文件的description</span></span><br><span class="line">    <span class="attr">button:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">      <span class="attr">text:</span> <span class="string">Follow</span> <span class="string">Me</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://github.com/flow2000</span></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">更换了博客主题为butterfly</span></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">5</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort:</span> <span class="string">date</span> <span class="comment"># date or updated</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_categories:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># none/true/false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">40</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">color:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">monthly</span> <span class="comment"># yearly or monthly</span></span><br><span class="line">    <span class="attr">format:</span> <span class="string">MMMM</span> <span class="string">YYYY</span> <span class="comment"># eg: YYYY年MM月</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">-1</span> <span class="comment"># Sort of order. 1, asc for ascending; -1, desc for descending</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">post_count:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">last_push_date:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br></pre></td></tr></table></figure><h3 id="访问人数-busuanzi"><a href="#访问人数-busuanzi" class="headerlink" title="访问人数 busuanzi"></a>访问人数 busuanzi</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># busuanzi count for PV / UV in site</span></span><br><span class="line"><span class="comment"># 訪問人數</span></span><br><span class="line"><span class="attr">busuanzi:</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span> <span class="comment"># 是否开启本站访客数</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开始本站总访问量</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开启文章页阅读量</span></span><br></pre></td></tr></table></figure><h3 id="网站运行时间"><a href="#网站运行时间" class="headerlink" title="网站运行时间"></a>网站运行时间</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Time difference between publish date and now (網頁運行時間)</span></span><br><span class="line"><span class="comment"># Formal: Month/Day/Year Time or Year/Month/Day Time</span></span><br><span class="line"><span class="attr">runtimeshow:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">publish_date:</span> <span class="number">2022</span><span class="string">/7/28</span> <span class="number">09</span><span class="string">:00:00</span>  </span><br></pre></td></tr></table></figure><h3 id="自定义栏目"><a href="#自定义栏目" class="headerlink" title="自定义栏目"></a>自定义栏目</h3><p>参考：<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p><h2 id="文章设置"><a href="#文章设置" class="headerlink" title="文章设置"></a>文章设置</h2><h3 id="文章链接优化"><a href="#文章链接优化" class="headerlink" title="文章链接优化"></a>文章链接优化</h3><p>安装 <code>hexo-abbrlink</code> 插件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-abbrlink</span></span><br></pre></td></tr></table></figure><p>编辑 站点的 <code>_config.yml</code>文件，找到 <code>permalink</code> , 改成 <strong>permalink: posts&#x2F;:abbrlink&#x2F;</strong></p><p>重新运行后插件会为每一篇文章生成唯一id并添加到Front-matter。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://blog.panghai.top</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br><span class="line"><span class="attr">abbrlink:</span> </span><br><span class="line">     <span class="attr">alg:</span> <span class="string">crc16</span> <span class="comment">#算法： crc16(default) and crc32 </span></span><br><span class="line">     <span class="attr">rep:</span> <span class="string">hex</span></span><br></pre></td></tr></table></figure><h3 id="Front-matter"><a href="#Front-matter" class="headerlink" title="Front-matter"></a>Front-matter</h3><p>Front-matter 是 markdown 文件最上方以 <code>---</code>分隔的区域，用于指定个别档案的变数。</p><p><code>Page Front-matter</code> 用于<code>页面</code>配置<br><code>Post Front-matter</code> 用于<code>文章页</code>配置</p><div class="note info modern"><p>如果标注<code>可选</code>的参数，可根据自己需要添加，不用全部都写在markdown里</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">Page Front-matter</button></li><li class="tab"><button type="button" data-href="#tab-1-2">Post Front-matter</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><table><thead><tr><th align="center">写法</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">title</td><td align="left">【必需】页面标题</td></tr><tr><td align="center">date</td><td align="left">【必需】页面创建日期</td></tr><tr><td align="center">type</td><td align="left">【必需】标签、分类和友情链接三个页面需要配置</td></tr><tr><td align="center">updated</td><td align="left">【可选】页面更新日期</td></tr><tr><td align="center">description</td><td align="left">【可选】页面描述</td></tr><tr><td align="center">keywords</td><td align="left">【可选】页面关键字</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示页面评论模块(默认 true)</td></tr><tr><td align="center">top_img</td><td align="left">【可选】页面顶部图片</td></tr><tr><td align="center">mathjax</td><td align="left">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">katex</td><td align="left">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aside</td><td align="left">【可选】显示侧边栏 (默认 true)</td></tr><tr><td align="center">aplayer</td><td align="left">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="left">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><table><thead><tr><th align="center">写法</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">title</td><td align="left">【必需】文章标题</td></tr><tr><td align="center">date</td><td align="left">【必需】文章创建日期</td></tr><tr><td align="center">updated</td><td align="left">【可选】文章更新日期</td></tr><tr><td align="center">tags</td><td align="left">【可选】文章标签</td></tr><tr><td align="center">categories</td><td align="left">【可选】文章分类</td></tr><tr><td align="center">description</td><td align="left">【可选】文章描述</td></tr><tr><td align="center">keywords</td><td align="left">【可选】文章关键字</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示文章评论模块(默认 true)</td></tr><tr><td align="center">top_img</td><td align="left">【可选】文章顶部图片</td></tr><tr><td align="center">cover</td><td align="left">【可选】文章缩略图(如果没有设置top_img,文章页顶部将显示缩略图，可设为false&#x2F;图片地址&#x2F;留空)</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示文章评论模块(默认 true)</td></tr><tr><td align="center">toc</td><td align="left">【可选】显示文章TOC(默认为设置中toc的enable配置)</td></tr><tr><td align="center">toc_number</td><td align="left">【可选】显示toc_number(默认为设置中toc的number配置)</td></tr><tr><td align="center">toc_style_simple</td><td align="left">【可选】显示 toc 简洁模式</td></tr><tr><td align="center">copyright</td><td align="left">【可选】显示文章版权模块(默认为设置中post_copyright的enable配置)</td></tr><tr><td align="center">copyright_author</td><td align="left">【可选】文章版权模块的文章作者</td></tr><tr><td align="center">copyright_author_href</td><td align="left">【可选】文章版权模块的文章作者链接</td></tr><tr><td align="center">copyright_url</td><td align="left">【可选】文章版权模块的文章连结链接</td></tr><tr><td align="center">copyright_info</td><td align="left">【可选】文章版权模块的版权声明文字</td></tr><tr><td align="center">mathjax</td><td align="left">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">katex</td><td align="left">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aplayer</td><td align="left">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="left">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr><tr><td align="center">aside</td><td align="left">【可选】显示侧边栏 (默认 true)</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="文章置顶"><a href="#文章置顶" class="headerlink" title="文章置顶"></a>文章置顶</h3><p>【推荐】hexo-generator-index从 2.0.0 开始，已经支持文章置顶功能。你可以直接在文章的front-matter区域里添加sticky: 1属性来把这篇文章置顶。数值越大，置顶的优先级越大。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Butterfly博客搭建（一）</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">butterfly是一个界面生动，图文交互性强的Hexo主题，借助官方文档和其他博主搭建过程我创作了该教程</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">&#x27;https://bing.panghai.top/php/random.php?random=2&#x27;</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">&#x27;https://bing.panghai.top/php/random.php?random=2&#x27;</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="string">447d</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-20 11:07:24</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">sticky:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure><p><img src="/../img/447d/1661048033052.png" alt="文章置顶示例"></p><h3 id="主页文章节选"><a href="#主页文章节选" class="headerlink" title="主页文章节选"></a>主页文章节选</h3><p>因为主题UI的关係，主页文章节选只支持自动节选和文章页description。</p><p>在butterfly里，有四种可供选择</p><p><code>description</code>： 只显示description<br><code>both</code>： 优先选择description，如果没有配置description，则显示自动节选的内容<br><code>auto_excerpt</code>：只显示自动节选<br><code>false</code>： 不显示文章内容</p><p>修改_config.butterfly.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">index_post_content:</span></span><br><span class="line">  <span class="attr">method:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">500</span> <span class="comment"># if you set method to 2 or 3, the length need to config</span></span><br></pre></td></tr></table></figure><p><code>description</code>在<code>front-matter</code>里添加</p><h3 id="文章目录"><a href="#文章目录" class="headerlink" title="文章目录"></a>文章目录</h3><p>在文章页，会有一个目录（TOC），修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># toc (文章目录)</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span> <span class="comment"># 对文章页是否有效</span></span><br><span class="line">  <span class="attr">page:</span> <span class="literal">false</span> <span class="comment"># 对页面是否有效</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span> <span class="comment"># 是否展示章节数</span></span><br><span class="line">  <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># 是否展开</span></span><br><span class="line">  <span class="attr">style_simple:</span> <span class="literal">true</span> <span class="comment"># for post 简洁模式</span></span><br></pre></td></tr></table></figure><p>参数解释</p><table><thead><tr><th>属性</th><th>解释</th></tr></thead><tbody><tr><td>post</td><td>文章页是否显示 TOC</td></tr><tr><td>page</td><td>普通页面是否显示 TOC</td></tr><tr><td>number</td><td>是否显示章节数</td></tr><tr><td>expand</td><td>是否展开 TOC</td></tr><tr><td>style_simple</td><td>简洁模式（侧边栏只显示 TOC, 只对文章页有效 ）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">PC端效果</button></li><li class="tab"><button type="button" data-href="#tab-1-2">移动端效果</button></li><li class="tab"><button type="button" data-href="#tab-1-3">简洁模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/447d/1661050028330.png" alt="PC端文章目录"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/447d/1661050796023.png" alt="移动端文章目录"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/../img/447d/1661050702712.png" alt="简洁模式"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="代码样式"><a href="#代码样式" class="headerlink" title="代码样式"></a>代码样式</h3><p>修改<code>_config.butterfly.yml</code>：</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">代码主题</button></li><li class="tab"><button type="button" data-href="#tab-1-2">代码复制按钮</button></li><li class="tab"><button type="button" data-href="#tab-1-3">代码语言</button></li><li class="tab"><button type="button" data-href="#tab-1-4">代码块是否展开</button></li><li class="tab"><button type="button" data-href="#tab-1-5">代码块高度限制</button></li><li class="tab"><button type="button" data-href="#tab-1-6">代码换行</button></li><li class="tab"><button type="button" data-href="#tab-1-7">网站复制</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Code Blocks (代碼相關)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">highlight_theme:</span> <span class="string">mac</span> <span class="comment">#  darker / pale night / light / ocean / mac / mac light / false</span></span><br></pre></td></tr></table></figure><p>代码主题样例展示</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">darker</button></li><li class="tab"><button type="button" data-href="#tab-1-2">pale night</button></li><li class="tab"><button type="button" data-href="#tab-1-3">light</button></li><li class="tab"><button type="button" data-href="#tab-1-4">ocean</button></li><li class="tab"><button type="button" data-href="#tab-1-5">mac</button></li><li class="tab"><button type="button" data-href="#tab-1-6">mac light</button></li><li class="tab"><button type="button" data-href="#tab-1-7">false</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/../img/447d/1661007394072.png" alt="darker"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/../img/447d/1661007471386.png" alt="pale night"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/../img/447d/1661007579994.png" alt="light"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p><img src="/../img/447d/1661007654205.png" alt="ocean"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/../img/447d/1661007716919.png" alt="mac"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p><img src="/../img/447d/1661007764931.png" alt="mac light"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><p><img src="/../img/447d/1661007815606.png" alt="false"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>主题支持代码复制功能</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_copy:</span> <span class="literal">true</span> <span class="comment"># 是否开启复制按钮</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>true</code>：显示代码语言</p><p><code>false</code>：隐藏代码语言</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># show the code language</span></span><br><span class="line"><span class="attr">highlight_lang:</span> <span class="literal">true</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在默认情况下，代码框自动展开，可设置是否所有代码框都关闭状态，点击&gt;可展开代码</p><p><code>true</code> 全部代码框不展开，需点击&gt;打开<br><code>false</code> 代码框展开，有&gt;点击按钮<br><code>none</code> 不显示&gt;按钮</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># true: shrink the code blocks </span></span><br><span class="line"><span class="comment"># false: expand the code blocks     </span></span><br><span class="line"><span class="comment"># none: expand code blocks and hide the button</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">true</span> </span><br></pre></td></tr></table></figure><div class="note info modern"><p>你也可以在post&#x2F;page页对应的markdown文件front-matter添加highlight_shrink来独立配置。</p><p>当主题配置文件中的 highlight_shrink 设为true时，可在front-matter添加highlight_shrink: false来单独配置文章展开代码框。</p><p>当主题配置文件中的 highlight_shrink 设为false时，可在front-matter添加highlight_shrink: true来单独配置文章收缩代码框。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note info modern"><p>3.7.0 及以上支持</p></div><p>可配置代码高度限制，超出的部分会隐藏，并显示展开按钮。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_height_limit:</span> <span class="number">200</span> <span class="comment"># unit: px</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><p>单位是 px，直接添加数字，如 200</p></li><li><p>实际限制高度为 highlight_height_limit + 30 px ，多增加 30px 限制，目的是避免代码高度只超出highlight_height_limit 一点时，出现展开按钮，展开没内容。</p></li><li><p>不适用于隐藏后的代码块（ css 设置 display: none）</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p>在默认情况下，Hexo 在编译的时候不会实现代码自动换行。如果你不希望在代码块的区域里有横向滚动条的话，那么你可以考虑开启这个功能。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code_word_wrap:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy settings</span></span><br><span class="line"><span class="comment"># copyright: Add the copyright information after copied content (複製的內容後面加上版權信息)</span></span><br><span class="line"><span class="attr">copy:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 是否开启网站复制权限</span></span><br><span class="line">  <span class="attr">copyright:</span>  <span class="comment"># 复制的内容后面加上版权信息</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment"># 是否开启复制版权信息添加</span></span><br><span class="line">    <span class="attr">limit_count:</span> <span class="number">100</span> <span class="comment"># 字数限制，当复制文字大于这个字数限制时</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h3><p>在source下新建img&#x2F;447d，本教程的链接优化为&#x2F;posts&#x2F;447d，所以建立和教程链接一样的资源文件夹即可</p><p>将要插入的图片放入img&#x2F;447d&#x2F;中，md文件则可以写入：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](<span class="link">../img/447d/1661002974057.png</span>)</span><br></pre></td></tr></table></figure><div class="note info flat"><p>447d是<a href="/posts/447d/#%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5%E4%BC%98%E5%8C%96">hexo-abbrlink</a>生成的随机字符</p></div><p><img src="/../img/447d/1661002974057.png" alt="主页背景图"></p><p>本地即可预览该图片</p><h3 id="文章锚点"><a href="#文章锚点" class="headerlink" title="文章锚点"></a>文章锚点</h3><p>开启文章锚点后，当你在文章页进行滚动时，文章链接会根据标题ID进行替换<br>(注意: 每替换一次，会留下一个历史记录。所以如果一篇文章有很多锚点的话，网页的历史记录会很多。)</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># anchor</span></span><br><span class="line"><span class="comment"># when you scroll in post , the url will update according to header id.</span></span><br><span class="line"><span class="attr">anchor:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="文章分页"><a href="#文章分页" class="headerlink" title="文章分页"></a>文章分页</h3><p>设置分页的逻辑</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post_pagination (分頁)</span></span><br><span class="line"><span class="comment"># value: 1 || 2 || false</span></span><br><span class="line"><span class="comment"># 1: The &#x27;next post&#x27; will link to old post</span></span><br><span class="line"><span class="comment"># 2: The &#x27;next post&#x27; will link to new post</span></span><br><span class="line"><span class="comment"># false: disable pagination</span></span><br><span class="line"><span class="attr">post_pagination:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p><code>post_pagination</code>： 分页开关按钮</p><p><code>post_pagination</code>： 1代表下一篇显示的是旧文章；2代表下一篇显示的是新文章</p><h3 id="文章编辑"><a href="#文章编辑" class="headerlink" title="文章编辑"></a>文章编辑</h3><p>在文章标题旁边显示一个编辑按钮，点击会跳转到对应的链接去。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Post edit</span></span><br><span class="line"><span class="comment"># Easily browse and edit blog source code online.</span></span><br><span class="line"><span class="attr">post_edit:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># url: https://github.com/user-name/repo-name/edit/branch-name/subdirectory-name/</span></span><br><span class="line">  <span class="comment"># For example: https://github.com/jerryc127/butterfly.js.org/edit/main/source/</span></span><br><span class="line">  <span class="attr">url:</span></span><br></pre></td></tr></table></figure><h3 id="文章分享"><a href="#文章分享" class="headerlink" title="文章分享"></a>文章分享</h3><p><code>addThis</code>、<code>sharejs</code>、<code>addtoany</code>三个选一个开启</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Share System (分享功能)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AddThis</span></span><br><span class="line"><span class="comment"># https://www.addthis.com/</span></span><br><span class="line"><span class="attr">addThis:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pubid:</span>  <span class="comment">#访问 AddThis 官网, 找到你的 pub-id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Share.js</span></span><br><span class="line"><span class="comment"># https://github.com/overtrue/share.js</span></span><br><span class="line"><span class="attr">sharejs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment">#我开启的</span></span><br><span class="line">  <span class="attr">sites:</span> <span class="string">facebook,twitter,wechat,weibo,qq</span>  <span class="comment">#想要显示的内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AddToAny</span></span><br><span class="line"><span class="comment"># https://www.addtoany.com/</span></span><br><span class="line"><span class="attr">addtoany:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">item:</span> <span class="string">facebook,twitter,wechat,sina_weibo,facebook_messenger,email,copy_link</span></span><br></pre></td></tr></table></figure><h3 id="文章过期提醒"><a href="#文章过期提醒" class="headerlink" title="文章过期提醒"></a>文章过期提醒</h3><p>可设置是否显示文章过期提醒，以更新时间为基准。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Displays outdated notice for a post (文章过期提醒)</span></span><br><span class="line"><span class="attr">noticeOutdate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span> <span class="comment"># style: simple/flat</span></span><br><span class="line">  <span class="attr">limit_day:</span> <span class="number">365</span> <span class="comment"># When will it be shown</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span> <span class="comment"># position: top/bottom</span></span><br><span class="line">  <span class="attr">message_prev:</span> <span class="string">It</span> <span class="string">has</span> <span class="string">been</span></span><br><span class="line">  <span class="attr">message_next:</span> <span class="string">days</span> <span class="string">since</span> <span class="string">the</span> <span class="string">last</span> <span class="string">update,</span> <span class="string">the</span> <span class="string">content</span> <span class="string">of</span> <span class="string">the</span> <span class="string">article</span> <span class="string">may</span> <span class="string">be</span> <span class="string">outdated.</span></span><br></pre></td></tr></table></figure><p><code>limit_day</code>： 距离更新时间多少天才显示文章过期提醒</p><p><code>message_prev</code> ： 天数之前的文字</p><p><code>message_next</code>：天数之后的文字</p><h3 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h3><p>相关文章推荐的原理是根据文章tags的比重来推荐</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">related_post:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">6</span> <span class="comment"># 显示推荐文章数目</span></span><br><span class="line">  <span class="attr">date_type:</span> <span class="string">created</span> <span class="comment"># or created or updated 文章日期显示创建日或者更新日</span></span><br></pre></td></tr></table></figure><h3 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wordcount (字數統計)</span></span><br><span class="line"><span class="comment"># see https://butterfly.js.org/posts/ceeb73f/#字數統計</span></span><br><span class="line"><span class="attr">wordcount:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_wordcount:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="文章打赏"><a href="#文章打赏" class="headerlink" title="文章打赏"></a>文章打赏</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sponsor/reward</span></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">QR_code:</span></span><br><span class="line">    <span class="comment"># - img: /img/wechat.jpg</span></span><br><span class="line">    <span class="comment">#   link:</span></span><br><span class="line">    <span class="comment">#   text: wechat</span></span><br><span class="line">    <span class="comment"># - img: /img/alipay.jpg</span></span><br><span class="line">    <span class="comment">#   link:</span></span><br><span class="line">    <span class="comment">#   text: alipay</span></span><br></pre></td></tr></table></figure><h3 id="文章版权信息"><a href="#文章版权信息" class="headerlink" title="文章版权信息"></a>文章版权信息</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">decode:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line">  <span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure><h2 id="博客部署"><a href="#博客部署" class="headerlink" title="博客部署"></a>博客部署</h2><p>需要自己提前在代码托管网站建立好仓库</p><div class="note warning modern"><p>如果想要开启pages，须按规则命名仓库：</p><ul><li>Github：{username}.github.io.git</li><li>Gitee：{username}.git</li><li>其他请自行百度……</li></ul></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">--save</span> hexo<span class="literal">-deployer-git</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/">Butterfly官方文档</a></p><p><a href="https://zhu-dongya.gitee.io/posts/hexo-butterfly-02/">https://zhu-dongya.gitee.io/posts/hexo-butterfly-02/</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
